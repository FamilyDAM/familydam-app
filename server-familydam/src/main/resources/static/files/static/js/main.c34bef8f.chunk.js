(this.webpackJsonpfiles=this.webpackJsonpfiles||[]).push([[0],{327:function(e,t,a){},594:function(e,t){},595:function(e,t){},715:function(e){e.exports=JSON.parse("{}")},716:function(e,t,a){"use strict";a.r(t);var n=a(298),i=a(0),l=a.n(i),r=a(29),o=a.n(r),s=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function registerValidSW(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var c=a(296),d=a(782),p=a(293),u=a.n(p),h=a(294),g=a.n(h),m=a(295),f=a.n(m),b=(a(327),a(14)),v=a(15),y=a(25),w=a(24),k=a(100),F=a(34),C=a(784),x=a(9),S=a(771),O=(a(328),a(19)),E=a(283),j=a(763),D=a(760),T=a(764),A=a(92),M=a.n(A),N=a(292),L=a.n(N),R=a(77),P=a(39),U=a.n(P),W=a(79),I=a(787),B=a(20),K=a(105),H=a.n(K),G=new function AppSettings(){Object(b.a)(this,AppSettings),this.baseHost=new B.BehaviorSubject("http://localhost:8080"),this.basicUser=new B.BehaviorSubject(window.localStorage.getItem("u")),this.basicPwd=new B.BehaviorSubject(window.localStorage.getItem("p"))},_=function(){function GetFileDataService(e,t){Object(b.a)(this,GetFileDataService),this.sink=void 0,this.sink=t,e.subscribe(function(e){this.getFiles(e)}.bind(this))}return Object(v.a)(GetFileDataService,[{key:"getFiles",value:function getFiles(e){var t=this,a=G.baseHost.getValue();if(void 0!==e&&e.length>0){for(var n=[],i=0;i<e.length;i++){var l=e[i],r=H.a.get(a+l).withCredentials().set("Accept","application/json");n.push(r)}Promise.all(n).then((function(e){for(var a=[],n=0;n<e.length;n++){var i=e[n];a.push(i.body)}t.sink.next(a)})).catch((function(e){console.log(e)}))}}}]),GetFileDataService}();a(572)(H.a);var V=function(){function UploadFileService(e,t){var a=this;Object(b.a)(this,UploadFileService),this.sink=void 0,this.sink=t;var n=G.baseHost.getValue();e.mergeMap((function(e){if(!Array.isArray(e))return a.uploadNextFile(n,e);for(var t=0;t<e.length;t++){var i=e[t];return a.uploadNextFile(n,i)}}),3).subscribe(console.debug)}return Object(v.a)(UploadFileService,[{key:"uploadNextFile",value:function uploadNextFile(e,t){var a=this;return t?B.Observable.of(t).flatMap((function(n){return new Promise((function(n,i){return a.uploadFile(e,t).then((function(e){return n(e)})).catch((function(e){var a=1;return t.retry&&(a=t.retry+1),t.progress=0,t.retry=a,t.error="Retrying request ("+a+"/3)",i(e)}))}))})).retry(2).catch((function(e){return t.error=e.status+": "+e.message,t.progress=0,B.Observable.of(e)})):null}},{key:"uploadFile",value:function uploadFile(e,t){var a=t.uploadPath;t.webkitRelativePath?a+="/"+t.webkitRelativePath.substr(0,t.webkitRelativePath.lastIndexOf("/")):t.relativePath&&(a+=t.relativePath.substr(0,t.relativePath.lastIndexOf("/")));var n=new FormData;return n.append("name",t.name),n.append("path",a),n.append("destination",a),n.append("file",t),n.append("type",t.type),n.append("size",t.size),n.append("jcr:primaryType","nt:file"),n.append("dam:date.created",t.lastModified),n.append("dam:date.modified",t.lastModified),H.a.post(e+a).withCredentials().charset("UTF-8").send(n).parse((function(e){var t=e.text;return 0===t.length?{}:JSON.parse(t)})).on("progress",(function(e){t.progress=e.percent,X.uploadProgress.next(t)}))}}]),UploadFileService}(),Y=function(){function LogoutService(e,t){Object(b.a)(this,LogoutService),this.sink=void 0,this.sink=t,e.subscribe(this.getUser.bind(this))}return Object(v.a)(LogoutService,[{key:"getUser",value:function getUser(e){var t=this,a=G.baseHost.getValue();fetch(a+"/logout",{method:"GET"}).then((function(e){return e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e})).catch((function(e){if(401===e.status||403===e.status)window.location="/";else{var a={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(a)}}))}}]),LogoutService}(),z=new function AppActions(){Object(b.a)(this,AppActions),this.navigateTo=new B.Subject,this.logout={source:new B.Subject,sink:new B.Subject},this.logoutService=new Y(this.logout.source,this.logout.sink)},$=function(){function DeleteFileOrFolderService(e,t){Object(b.a)(this,DeleteFileOrFolderService),this.sink=void 0,this.sink=t,e.subscribe(function(e){this.deleteFileOrFolder(e)}.bind(this))}return Object(v.a)(DeleteFileOrFolderService,[{key:"deleteFileOrFolder",value:function deleteFileOrFolder(e){var t=this,a=G.baseHost.getValue();if(void 0!==e&&e.length>0){var n=a+e;H.a.delete(n).withCredentials().set("Accept","application/json").end((function(e,a){if(e)if(401===e.status)z.navigateTo.next("/");else if(403===e.status)z.alert.next("You do not have permission to access these files");else{var n={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(n)}else t.sink.next(!0)}))}}}]),DeleteFileOrFolderService}(),q=function(){function CreateFolderService(e,t){Object(b.a)(this,CreateFolderService),this.sink=void 0,this.sink=t,e.subscribe(this.createDirectory.bind(this))}return Object(v.a)(CreateFolderService,[{key:"createDirectory",value:function createDirectory(e){var t=this,a=G.baseHost.getValue(),n=e.name,i=a+e.path+"/"+n,l=new FormData;l.append("name",e.username),l.append("jcr:primaryType","nt:folder"),fetch(i,{method:"POST",body:l}).then((function(e){console.info("CreateFolder success handler"),e.redirected&&(console.debug("redirect to: "+e.url),window.location=e.url),t.sink.next(!0)})).then((function(e){return e.json()})).then((function(e){e.firstName||(e.firstName=e.username),t.sink.next(e)})).catch((function(e){if(console.warn(e),401===e.status)z.navigateTo.next("/");else if(403===e.status)z.alert.next("You do not have permission to add a new user");else{console.error(e);var a={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(a)}}))}}]),CreateFolderService}(),J=function(){function SetFilePropertyService(e,t){Object(b.a)(this,SetFilePropertyService),this.sink=void 0,this.sink=t,e.subscribe(function(e){this.execute(e)}.bind(this))}return Object(v.a)(SetFilePropertyService,[{key:"execute",value:function execute(e){var t=this,a=G.baseHost.getValue(),n=new FormData;for(var i in e)"path"!==i&&n.append(i,e[i]);fetch(a+e.path,{method:"PUT",body:n}).then((function(e){return e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e})).then((function(e){return e.json()})).then((function(e){t.sink.next(e)})).catch((function(e){if(401===e.status||403===e.status)window.location="/";else{var a={code:e.status,status:e.statusText,message:e.responseText||e.message};t.sink.error(a)}}))}}]),SetFilePropertyService}(),X=new function FileActions(){Object(b.a)(this,FileActions),this.getFileData={source:new B.Subject,sink:new B.Subject},this.setFileProperty={source:new B.Subject,sink:new B.Subject},this.uploadFile={source:new B.Subject,sink:new B.Subject},this.deleteFileOrFolder={source:new B.Subject,sink:new B.Subject},this.createFolder={source:new B.Subject,sink:new B.Subject},this.stageAction=new B.Subject,this.stageFile=new B.Subject,this.uploadProgress=new B.Subject,this.uploadCompleted=new B.Subject,this.uploadError=new B.Subject,this.getFileDataService=new _(this.getFileData.source,this.getFileData.sink),this.setFilePropertyService=new J(this.setFileProperty.source,this.setFileProperty.sink),this.uploadFileService=new V(this.uploadFile.source,this.uploadFile.sink),this.deleteFileOrFolderService=new $(this.deleteFileOrFolder.source,this.deleteFileOrFolder.sink),this.createFolderService=new q(this.createFolder.source,this.createFolder.sink)},Q=function FileScanner(){Object(b.a)(this,FileScanner),this.processFile=function(){var e=Object(W.a)(U.a.mark((function _callee(e,t,a){return U.a.wrap((function _callee$(n){for(;;)switch(n.prev=n.next){case 0:e.id||(e.id=Object(I.a)()),e.progress=0,e.status="uploadReady",e.uploadPath=t,e.uploadProgress=30,a&&(e.relativePath=a),console.debug("FILE:"+e.uploadPath),X.stageFile.next(e);case 8:case"end":return n.stop()}}),_callee)})));return function(t,a,n){return e.apply(this,arguments)}}(),this.readDir=function(){var e=Object(W.a)(U.a.mark((function _callee4(e,t,a){var n;return U.a.wrap((function _callee4$(i){for(;;)switch(i.prev=i.next){case 0:n=this,e.createReader().readEntries(function(){var e=Object(W.a)(U.a.mark((function _callee3(e){var i,l,r;return U.a.wrap((function _callee3$(o){for(;;)switch(o.prev=o.next){case 0:i=U.a.mark((function _loop(i){var l;return U.a.wrap((function _loop$(o){for(;;)switch(o.prev=o.next){case 0:if(r=e[i],l=r.fullPath,!r.isFile){o.next=6;break}r.file(function(){var e=Object(W.a)(U.a.mark((function _callee2(e){return U.a.wrap((function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.processFile(e,a,l);case 2:case"end":return t.stop()}}),_callee2)})));return function(t){return e.apply(this,arguments)}}()),o.next=10;break;case 6:if(!r.isDirectory){o.next=10;break}return console.debug("DIR:"+r.fullPath),o.next=10,n.readDir(r,t,a);case 10:case"end":return o.stop()}}),_loop)})),l=0;case 2:if(!(l<e.length)){o.next=7;break}return o.delegateYield(i(l),"t0",4);case 4:l++,o.next=2;break;case 7:case"end":return o.stop()}}),_callee3)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return i.stop()}}),_callee4,this)})));return function(t,a,n){return e.apply(this,arguments)}}(),this.scanFiles=function(){var e=Object(W.a)(U.a.mark((function _callee5(e,t,a){var n,i,l,r,o,s,c,d,p,u;return U.a.wrap((function _callee5$(h){for(;;)switch(h.prev=h.next){case 0:if(X.stageAction.next("open"),!e.dataTransfer){h.next=22;break}n=e.dataTransfer.items,i=0;case 4:if(!(i<n.length)){h.next=20;break}if(l=t,r=n[i],o=r.getAsFile(),!(s=r.webkitGetAsEntry()).isFile){h.next=14;break}return h.next=12,this.processFile(o,l);case 12:h.next=17;break;case 14:if(!s.isDirectory){h.next=17;break}return h.next=17,this.readDir(s,o,l);case 17:i++,h.next=4;break;case 20:h.next=23;break;case 22:if(a){c=t,d=Object(R.a)(a);try{for(d.s();!(p=d.n()).done;)u=p.value,this.processFile(u,c)}catch(err){d.e(err)}finally{d.f()}}case 23:case"end":return h.stop()}}),_callee5,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},Z=a(242),ee=a(718),te=a(790),ae=a(761),ne=a(719),ie=a(762),le=a(153),re=a(229),oe=a.n(re),se=function(e){Object(y.a)(Sidebar,e);var t=Object(w.a)(Sidebar);function Sidebar(){return Object(b.a)(this,Sidebar),t.apply(this,arguments)}return Object(v.a)(Sidebar,[{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.open!==this.props.open||e.user!==this.props.user||e.apps!==this.props.apps||e.secondaryApps!==this.props.secondaryApps}},{key:"handleLogout",value:function handleLogout(){window.localStorage.clear(),z.logout.source.next(!0),window.location="/index.html"}},{key:"findApp",value:function findApp(e,t){if(t){var a,n=Object(R.a)(t);try{for(n.s();!(a=n.n()).done;){var i=a.value;if(i.slug===e)return i}}catch(err){n.e(err)}finally{n.f()}}return null}},{key:"render",value:function render(){var e=this,t=this.props.classes,a=this.findApp("usermanager",this.props.secondaryApps);return l.a.createElement(ee.a,{className:this.props.open?t.sidebarOpen:t.sidebarClosed},l.a.createElement(ee.a,{className:this.props.open?t.sidebarUserInfo:t.sidebarUserInfoClosed},l.a.createElement("div",{className:t.sidebarProfileIcon},l.a.createElement(oe.a,{style:{width:60,height:60}})),l.a.createElement("div",{className:t.sidebarProfileName},l.a.createElement(le.a,{component:"div",type:"title"},this.props.user.name," ",this.props.user.lastName)),l.a.createElement("div",{className:t.sidebarButtons},l.a.createElement(D.a,{onClick:this.handleLogout},"Logout"),a&&l.a.createElement(D.a,{onClick:function onClick(){return z.navigateTo.next(a.path)}},"Profile"))),l.a.createElement("div",{className:this.props.open?t.appListsOpen:t.appListsClosed},l.a.createElement("div",{style:{gridColumn:"1",gridRow:"1"}},l.a.createElement(le.a,{type:"title",className:this.props.open?t.openLabel:t.closedLabel,style:{paddingLeft:"16px",paddingTop:"16px",gridColumn:"1",gridRow:"1"}},"Apps")),l.a.createElement(ae.a,{style:{gridColumn:"1",gridRow:"2"}},this.props.apps&&this.props.apps.map((function(a){return l.a.createElement(ne.a,{button:!0,key:a.homeUrl,onClick:function onClick(){return window.location.href=a.homeUrl}},l.a.createElement(te.a,{style:{marginRight:"8px"}},l.a.createElement(M.a,null)),l.a.createElement(ie.a,{primary:a.name,primaryTypographyProps:{type:"body2"},className:e.props.open?t.openLabel:t.closedLabel}))}))),l.a.createElement(ae.a,{style:{gridColumn:"1",gridRow:"3"},className:this.props.open?t.closedLabel:t.openLabel},l.a.createElement(ne.a,{button:!0,onClick:function onClick(){return window.location.href="://app-usermanager/index.html"}},l.a.createElement(te.a,null,l.a.createElement(oe.a,{style:{width:48,height:48}}))))))}}]),Sidebar}(i.Component),ce=Object(E.b)(Object(x.a)((function styleSheet(e){return{sidebarOpen:{width:"240px",height:"100vh",background:"#fff"},sidebarClosed:{width:"72px",height:"100vh",background:"#fff"},sidebarUserInfo:{width:"100%",padding:"8px",display:"grid",gridGap:"8px",gridTemplateRows:"auto",gridTemplateColumns:"60px auto"},sidebarUserInfoClosed:{display:"none"},sidebarProfileIcon:{gridColumn:"1",gridRow:"1"},sidebarProfileName:{gridColumn:"2",gridRow:"1",alignSelf:"center"},sidebarButtons:{gridColumn:"1/3",gridRow:"2",justifySelf:"center"},appListsOpen:{display:"grid",gridGap:"0px",gridTemplateRows:"24px auto",gridTemplateColumns:"auto",marginTop:"16px"},appListsClosed:{height:"90%",display:"grid",gridGap:"0px",gridTemplateRows:"0px auto 72px",gridTemplateColumns:"auto"},openLabel:{display:"inline"},closedLabel:{display:"none"}}}))(se)),de=a(765),pe=a(767),ue=a(297),he=a(766),ge=a(286),me=a.n(ge),fe=a(285),be=a.n(fe),ve=function(e){Object(y.a)(AppHeader,e);var t=Object(w.a)(AppHeader);function AppHeader(e,a){var n;return Object(b.a)(this,AppHeader),(n=t.call(this,e)).state={openMoreMenu:!1},n.handleToggle=n.handleToggle.bind(Object(O.a)(n)),n.handleOpenMoreMenu=n.handleOpenMoreMenu.bind(Object(O.a)(n)),n.handleLogout=n.handleLogout.bind(Object(O.a)(n)),n}return Object(v.a)(AppHeader,[{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.onToggle!==this.props.onToggle||e.apps!==this.props.apps||t.openMoreMenu!==this.state.openMoreMenu}},{key:"handleOpenMoreMenu",value:function handleOpenMoreMenu(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}},{key:"handleToggle",value:function handleToggle(){this.props.onToggle&&this.props.onToggle()}},{key:"handleNavClick",value:function handleNavClick(e){this.props.onNavClick&&this.props.onNavClick(e)}},{key:"handleMenuClose",value:function handleMenuClose(){this.setState({openMoreMenu:!1})}},{key:"handleLogout",value:function handleLogout(){window.localStorage.clear(),z.logout.source.next(!0),window.location="/"}},{key:"render",value:function render(){var e=this,t=this.props.classes;return l.a.createElement(j.a,{className:t.root,position:"static"},l.a.createElement(T.a,null,l.a.createElement(de.a,{onClick:this.handleToggle,className:t.menuButton,color:"contrast","aria-label":"Menu"},l.a.createElement(be.a,null)),l.a.createElement(le.a,{variant:"h5",color:"inherit",className:t.flex,onClick:function onClick(){return e.handleNavClick("://home/index.html")}},"Family ",l.a.createElement("i",null,"D.A.M")),l.a.createElement(de.a,{"aria-label":"More","aria-owns":this.state.open?"long-menu":null,"aria-haspopup":"true",onClick:this.handleOpenMoreMenu,className:t.moreButton},l.a.createElement(me.a,null)),l.a.createElement(ue.a,{id:"long-menu",keepMounted:!0,anchorEl:this.state.openMoreMenuAnchorEl,open:this.state.openMoreMenu},l.a.createElement(he.a,{onClick:function onClick(){e.handleLogout(),e.handleMenuClose()}},"Logout"),l.a.createElement(pe.a,null),this.props.apps&&this.props.apps.map((function(t){return l.a.createElement(he.a,{key:t.path,color:"contrast",onClick:function onClick(){e.handleNavClick(t.path),e.handleMenuClose()}},t.label)})))))}}]),AppHeader}(i.Component),ye=Object(E.b)(Object(x.a)((function styleSheet(e){return{root:{width:"100%",height:"64px"},headerContainer:{display:"grid",gridTemplateRows:"auto",gridTemplateColumns:"48px auto 48px"},hamburgerMenu:{display:"block",gridRow:"1",gridColumn:"1"},mainSection:{gridRow:"1",gridColumn:"2"},rightSection:{gridRow:"2",gridColumn:"3",textAlign:"right"},flex:{flex:1},menuButton:{marginLeft:-12,marginRight:20,color:"#ffffff"},moreButton:{color:"#ffffff"}}}))(ve)),we=new(function(){function LoadClientAppsService(){Object(b.a)(this,LoadClientAppsService),this.isLoading=new B.BehaviorSubject(!1),this.source=new B.Subject,this.sink=new B.Subject,this.source.subscribe(this.loadApps.bind(this))}return Object(v.a)(LoadClientAppsService,[{key:"loadApps",value:function(){var e=Object(W.a)(U.a.mark((function _callee(e){var t,a,n,i,l,r,o,s;return U.a.wrap((function _callee$(e){for(;;)switch(e.prev=e.next){case 0:return t=G.baseHost.getValue(),a=t+"/core/api/apps",(n=new Headers).append("Accept","application/json"),this.isLoading.next(!0),e.next=7,fetch(a,{method:"GET",cache:"no-cache",headers:n,credentials:"include"});case 7:return i=e.sent,e.next=10,i.json();case 10:l=e.sent,200==i.status&&l._embedded.applications?(r=[],o=[],l._embedded.applications.forEach((function(e){e.isPrimaryApp?r.push(e):o.push(e)})),this.sink.next({primaryApps:r,secondaryApps:o})):(console.dir(err),s={code:err.status,status:err.statusText,message:err.responseText},this.sink.error(s));case 12:case"end":return e.stop()}}),_callee,this)})));return function loadApps(t){return e.apply(this,arguments)}}()}]),LoadClientAppsService}()),ke=function(e){Object(y.a)(AppShell,e);var t=Object(w.a)(AppShell);function AppShell(e,a){var n;Object(b.a)(this,AppShell),n=t.call(this,e);var i=window.localStorage.getItem("AppShell.isOpen");return i||(i=void 0===e.open||e.open),n.state={isMounted:!0,isOpen:Boolean(i)},n.handleOpenCloseToggle=n.handleOpenCloseToggle.bind(Object(O.a)(n)),n.handleOpenMoreMenu=n.handleOpenMoreMenu.bind(Object(O.a)(n)),n}return Object(v.a)(AppShell,[{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.open!==this.props.open||e.user!==this.props.user||e.children!==this.props.children||t.isOpen!==this.state.isOpen||t.primaryApps!==this.state.primaryApps||t.secondaryApps!==this.state.secondaryApps}},{key:"componentWillMount",value:function componentWillMount(){var e=this;this.setState({isMounted:!0}),z.navigateTo.pipe(Object(Z.a)((function(){return e.state.isMounted}))).subscribe(function(e){"://"!==e&&"://"===e.substring(0,3)?window.location.href=e.substring(2):this.props.history&&this.props.history.push(e)}.bind(this)),we.sink.pipe(Object(Z.a)((function(){return e.state.isMounted}))).subscribe((function(t){t&&e.setState({primaryApps:t.primaryApps||[],secondaryApps:t.secondaryApps||[]})})),we.source.next(!0)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"handleOpenMoreMenu",value:function handleOpenMoreMenu(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}},{key:"handleOpenCloseToggle",value:function handleOpenCloseToggle(){var e=!this.state.isOpen;this.setState({isOpen:e}),window.localStorage.setItem("AppShell.isOpen",e)}},{key:"handleLogout",value:function handleLogout(){window.localStorage.clear(),z.logout.source.next(!0),z.navigateTo.next("://")}},{key:"render",value:function render(){var e=this.props.classes;return this.props.user?l.a.createElement("div",{className:this.state.isOpen?e.dashboardShellContainerOpen:e.dashboardShellContainerClosed},l.a.createElement("header",{className:e.header},l.a.createElement(ye,{apps:this.state.secondaryApps,onToggle:this.handleOpenCloseToggle,onNavClick:function onNavClick(e){return z.navigateTo.next(e)}})),l.a.createElement(ce,{user:this.props.user,apps:this.state.primaryApps,secondaryApps:this.state.secondaryApps,open:this.state.isOpen,onNavClick:function onNavClick(e){return z.navigateTo.next(e)}}),l.a.createElement("div",{className:e.main},this.props.children)):l.a.createElement("div",null)}}]),AppShell}(i.Component),Fe=Object(E.b)(Object(F.f)(Object(x.a)((function styleSheet(e){return{dashboardShellContainerOpen:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"240px auto"},dashboardShellContainerClosed:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"72px auto"},header:{gridColumn:"1/3",gridRow:"1",position:"inherit",height:"64px"},main:{fontSize:".5rem",background:"#eee"}}}))(ke))),Ce=function(e){Object(y.a)(Breadcrumb,e);var t=Object(w.a)(Breadcrumb);function Breadcrumb(e,a){var n;return Object(b.a)(this,Breadcrumb),(n=t.call(this,e)).state={paths:[]},n}return Object(v.a)(Breadcrumb,[{key:"componentDidMount",value:function componentDidMount(){this.parsePath(this.props.path)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.currentPathSubscription&&this.currentPathSubscription.dispose()}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(e){e.path&&this.parsePath(e.path)}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.path!==this.props.path}},{key:"parsePath",value:function parsePath(e){for(var t=e.split("/"),a="",n=[],i=[],l=0;l<t.length;l++){var r=t[l];r.trim().length>0&&(a=a+"/"+r,i[l]=r,n.push({label:r,level:l,path:a,style:{color:l>2?"blue":"black",cursor:l>2?"pointer":"default"}}))}this.setState({paths:n})}},{key:"render",value:function render(){var e=this.props.classes;return l.a.createElement("div",null,l.a.createElement("ol",{className:e.breadcrumb},this.state.paths.map((function(t){return t.path?l.a.createElement("li",{className:e.li,key:t.path,style:t.style,onClick:function onClick(){return z.navigateTo.next(t.path)}},t.label):l.a.createElement("li",{className:e.li,key:t.label},t.label)}))))}}]),Breadcrumb}(i.Component),xe=Object(x.a)((function styleSheet(e){return{breadcrumb:{backgroundColor:"transparent",listStyle:"none",padding:"0px"},li:{float:"left",margin:"0 0 10px 5px",color:"blue",cursor:"pointer","&:before":{content:'"/ "',color:"black"},"&:after":{content:'" "',color:"black"}}}}))(Ce),Se=a(136),Oe=a.n(Se),Ee=a(772),je=a(773),De=a(770),Te=a(769),Ae=a(287),Me=a.n(Ae),Ne=a(152),Le=a.n(Ne),Re=a(151),Pe=a.n(Re),Ue=a(788),We=a(776),Ie=a(775),Be=a(774),Ke=a(768),He=a(791),Ge=function(e){Object(y.a)(FileListTableHead,e);var t=Object(w.a)(FileListTableHead);function FileListTableHead(){var e;Object(b.a)(this,FileListTableHead);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).createSortHandler=function(t){return function(a){e.props.onRequestSort(a,t)}},e}return Object(v.a)(FileListTableHead,[{key:"render",value:function render(){var e=this.props,t=e.classes,a=e.order,n=e.orderBy;return l.a.createElement(Ke.a,{className:t.tableHead},l.a.createElement(Te.a,null,l.a.createElement(De.a,{padding:"none",style:{width:"100%",padding:"16px 8px 16px 16px"}},l.a.createElement(He.a,{active:"name"===n,direction:a,onClick:this.createSortHandler("name")},"Name")),l.a.createElement(De.a,{padding:"none",style:{minWidth:"200px",padding:"16px 8px"}},l.a.createElement(He.a,{active:"dam:date.created"===n,direction:a,onClick:this.createSortHandler("dam:date.created")},"Created")),l.a.createElement(De.a,{padding:"none",style:{textAlign:"center",minWidth:"100px",padding:"16px 8px"}},"Actions")))}}]),FileListTableHead}(i.Component),_e=Object(x.a)((function styleSheet(e){return{tableHead:{backgroundColor:"#fff",fontSize:"16px"}}}))(Ge),Ve=function(e){Object(y.a)(LoadingButton,e);var t=Object(w.a)(LoadingButton);function LoadingButton(e,a){var n;return Object(b.a)(this,LoadingButton),e.style||(e.style={}),(n=t.call(this,e)).handleClick=n.handleClick.bind(Object(O.a)(n)),n}return Object(v.a)(LoadingButton,[{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.label!==this.props.label}},{key:"handleClick",value:function handleClick(e){console.log("loading button click"),this.props.onClick?this.props.onClick(e):console.dir(this.props)}},{key:"render",value:function render(){var e=this.props.classes;return l.a.createElement(D.a,{color:"primary",variant:"contained",className:e.btn,style:this.props.style,onClick:this.handleClick},this.props.isLoading&&l.a.createElement(S.a,{className:e.progress,color:"#fff",size:25}),this.props.label)}}]),LoadingButton}(i.Component),Ye=Object(E.b)(Object(x.a)((function styleSheet(e){return{btn:{padding:"4px 12px"},progress:{marginRight:"8px"}}}))(Ve)),ze=function(e){Object(y.a)(FileList,e);var t=Object(w.a)(FileList);function FileList(e){var a;return Object(b.a)(this,FileList),(a=t.call(this,e)).isCntlPressed=!1,a.isSpacePressed=!1,a.handleClick=function(e,t){var n=a.state.selected,i=n.indexOf(t),l=[];a.isCntlPressed,-1===i?l.push(t):l=(l=[]).concat(n.slice(0,i),n.slice(i+1)),a.setState({selected:l}),a.props.onSelectionChange&&a.props.onSelectionChange(l)},a.handleRequestSort=function(e,t){var n=t,i="desc";a.state.orderBy===t&&"desc"===a.state.order&&(i="asc");var l="desc"===i?a.state.files.sort((function(e,t){return t[n]<e[n]?-1:1})):a.state.files.sort((function(e,t){return e[n]<t[n]?-1:1}));a.setState({data:l,order:i,orderBy:n})},a.state={files:[],rootPath:"/content",isMounted:!0,order:"asc",orderBy:"name",selected:[],showDeleteFileDialog:!1,showDeleteFolderDialog:!1},a.handleFileDelete=a.handleFileDelete.bind(Object(O.a)(a)),a.handleFolderDelete=a.handleFolderDelete.bind(Object(O.a)(a)),a.handleFolderDownload=a.handleFolderDownload.bind(Object(O.a)(a)),a.handleCancelDialog=a.handleCancelDialog.bind(Object(O.a)(a)),a.handleFileDeleteOk=a.handleFileDeleteOk.bind(Object(O.a)(a)),a.handleFolderDeleteOk=a.handleFolderDeleteOk.bind(Object(O.a)(a)),a}return Object(v.a)(FileList,[{key:"componentDidMount",value:function componentDidMount(){var e=this;this.setState({isMounted:!0}),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.handleClick=this.handleClick.bind(this),document.addEventListener("keydown",this.handleKeyDown,!1),document.addEventListener("keyup",this.handleKeyUp,!1),document.addEventListener("contextmenu",(function(e){e.preventDefault()}),!1),this.props.files&&this.setState({files:this.props.files}),X.getFileAndFolders.sink.takeWhile((function(){return e.state.isMounted})).subscribe((function(t){var a=e.state.orderBy,n=t.sort((function(e,t){return e["jcr:primaryType"]&&t["jcr:primaryType"]&&e["jcr:primaryType"]!==t["jcr:primaryType"]?e["jcr:primaryType"]>t["jcr:primaryType"]?-1:1:e[a]&&t[a]?e[a].toString().toLowerCase()<t[a].toString().toLowerCase()?-1:1:0}));e.setState({files:n})})),X.getFileAndFolders.source.next(this.props.path)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(e){this.props.path!==e.path&&(this.props=e,X.getFileAndFolders.source.next(this.props.path))}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.path!==this.props.path||t.files!==this.state.files||t.order!==this.state.order||t.orderBy!==this.state.orderBy||t.showDeleteFolderDialog!==this.state.showDeleteFolderDialog||t.showDeleteFileDialog!==this.state.showDeleteFileDialog}},{key:"handleKeyDown",value:function handleKeyDown(e){switch(e.keyCode){case 17:case 91:this.isCntlPressed=!0;break;case 16:this.isSpacePressed=!0}}},{key:"handleKeyUp",value:function handleKeyUp(e){switch(e.keyCode){case 17:case 91:this.isCntlPressed=!1;break;case 16:this.isSpacePressed=!1}}},{key:"handleFileDelete",value:function handleFileDelete(e){return this.setState({showDeleteFileDialog:!0,pendingFileToDelete:e}),!1}},{key:"handleFolderDelete",value:function handleFolderDelete(e){return this.setState({showDeleteFolderDialog:!0,pendingFolderToDelete:e}),!1}},{key:"handleFolderDownload",value:function handleFolderDownload(e){return!1}},{key:"handleFileDeleteOk",value:function handleFileDeleteOk(){var e=this;X.deleteFileOrFolder.source.next(this.state.pendingFileToDelete);var t=this.state.pendingFileToDelete;X.deleteFileOrFolder.sink.subscribe((function(){e.props.onDelete&&e.props.onDelete(t)})),this.setState({showDeleteFileDialog:!1,pendingFileToDelete:null})}},{key:"handleFolderDeleteOk",value:function handleFolderDeleteOk(e){var t=this;X.deleteFileOrFolder.source.next(this.state.pendingFolderToDelete),X.deleteFileOrFolder.sink.subscribe((function(){t.props.onDelete&&t.props.onDelete(t.state.pendingFolderToDelete)})),this.setState({showDeleteFolderDialog:!1,pendingFolderToDelete:null})}},{key:"handleCancelDialog",value:function handleCancelDialog(e){this.setState({showDeleteFileDialog:!1,showDeleteFolderDialog:!1,pendingFileToDelete:null})}},{key:"render",value:function render(){var e=this,t=this.props.classes,a=this.state,n=a.files,i=a.order,r=a.orderBy,o=a.selected;return l.a.createElement(ee.a,{className:t.root},l.a.createElement("div",{className:t.tableWrapper},l.a.createElement(Ee.a,null,l.a.createElement(_e,{numSelected:o.length,order:i,orderBy:r,onRequestSort:this.handleRequestSort,rowCount:n.length}),l.a.createElement(je.a,null,this.state.files.filter((function(e){return!e.toString().startsWith(".")&&!e.toString().startsWith("jcr:")})).map((function(t){var a=function checkIsSelected(t){return-1!==e.state.selected.indexOf(t)}(t.path);return"dam:folder"===t["jcr:primaryType"]||"nt:folder"===t["jcr:primaryType"]?l.a.createElement($e,{key:t.path,folder:t,isSelected:a,onDelete:e.handleFolderDelete,onDownload:e.handleFolderDownload,onNavigate:function onNavigate(e){return z.navigateTo.next(e)}}):l.a.createElement(qe,{key:t.path,file:t,isSelected:a,onDelete:function onDelete(){return e.handleFileDelete(t.path)},onDownload:e.props.handleFileDownload,onClick:function onClick(t,a){return e.handleClick(t,a)},onKeyDown:function onKeyDown(t,a){return e.handleClick(t,a)},onNavigate:function onNavigate(e){return z.navigateTo.next(e)}})}))))),l.a.createElement(Ue.a,{ignoreBackdropClick:!0,maxWidth:"sm",open:this.state.showDeleteFileDialog,style:{padding:"8px"}},l.a.createElement(Be.a,null,"Delete Confirmation"),l.a.createElement(Ie.a,null,l.a.createElement(le.a,null,"Are you sure you want to delete this file?")),l.a.createElement(We.a,null,l.a.createElement(D.a,{onClick:this.handleCancelDialog,color:"primary"},"Cancel"),l.a.createElement(Ye,{isLoading:this.state.isLoading,label:"Delete",onKeyDown:function onKeyDown(t){13===t.keyCode&&e.handleFileDeleteOk()},onClick:this.handleFileDeleteOk}))),l.a.createElement(Ue.a,{ignoreBackdropClick:!0,maxWidth:"sm",open:this.state.showDeleteFolderDialog,style:{padding:"8px"}},l.a.createElement(Be.a,null,"Delete Confirmation"),l.a.createElement(Ie.a,null,l.a.createElement(le.a,null,"Are you sure you want to delete this folder and all of the files in it?")),l.a.createElement(We.a,null,l.a.createElement(D.a,{onClick:this.handleCancelDialog,color:"primary"},"Cancel"),l.a.createElement(Ye,{isLoading:this.state.isLoading,label:"Delete",onKeyDown:function onKeyDown(t){13===t.keyCode&&e.handleFolderDeleteOk()},onClick:this.handleFolderDeleteOk}))))}}]),FileList}(i.Component),$e=function FolderRow(e,t){return l.a.createElement(Te.a,{hover:!0,role:"checkbox",tabIndex:-1,selected:e.isSelected,"aria-checked":e.isSelected},l.a.createElement(De.a,{padding:"default",style:{padding:"8px 8px 8px 16px"},onClick:function onClick(){return e.onNavigate(e.folder.path)}},l.a.createElement(M.a,null),l.a.createElement(le.a,{component:"span",style:{display:"inline",paddingLeft:"16px"}},e.folder.name)),l.a.createElement(De.a,{padding:"default"}),l.a.createElement(De.a,{padding:"default",style:{padding:"8px",textAlign:"center"}},l.a.createElement(D.a,{onClick:function onClick(){return e.onDelete(e.folder.path)},style:{minWidth:"24px",padding:"4px"}},l.a.createElement(Pe.a,null)),l.a.createElement(D.a,{onClick:function onClick(){return window.alert("Coming Soon")},style:{minWidth:"24px",padding:"4px"}},l.a.createElement(Le.a,null))))},qe=function FileRow(e,t){return l.a.createElement(Te.a,{hover:!0,role:"checkbox","aria-checked":e.isSelected,tabIndex:-1,selected:e.isSelected},l.a.createElement(De.a,{padding:"default",style:{padding:"8px 8px 8px 16px"},onClick:function onClick(t){e.onClick(t,e.file.path)}},e.file.path.toString().toLowerCase().endsWith(".jpg")||e.file.path.toString().toLowerCase().endsWith(".png")?l.a.createElement("img",{src:e.file.path+"?size=100",alt:"",style:{width:"25px"}}):l.a.createElement(Me.a,null),l.a.createElement(le.a,{style:{display:"inline",paddingLeft:"16px"}},e.file.name)),l.a.createElement(De.a,{padding:"default",style:{padding:"8px"}},Oe()(e.file["dam:date.created"]?e.file["dam:date.created"]:e.file["jcr:created"]).format("MMM Do YYYY, h:mm:ss a")),l.a.createElement(De.a,{padding:"default",style:{padding:"8px",textAlign:"center"}},l.a.createElement(D.a,{onClick:function onClick(){return e.onDelete(e.file.path)},style:{minWidth:"24px",padding:"4px"}},l.a.createElement(Pe.a,null)),e.file._links.download&&l.a.createElement(D.a,{onClick:function onClick(){return e.onDownload(e.file.name,e.file._links.download)},style:{minWidth:"24px",padding:"4px"}},l.a.createElement(Le.a,null))))},Je=Object(F.f)(Object(x.a)((function styleSheet(e){return{main:{width:"100%",height:"100%",backgroundColor:"#fff"},root:{gridRow:"1/4",gridColumn:"1/4"},tableWrapper:{overflowX:"auto"}}}))(ze)),Xe=a(12),Qe=a.n(Xe),Ze=a(145),et=a.n(Ze),tt=function(e){Object(y.a)(FileListTableToolbar,e);var t=Object(w.a)(FileListTableToolbar);function FileListTableToolbar(){return Object(b.a)(this,FileListTableToolbar),t.apply(this,arguments)}return Object(v.a)(FileListTableToolbar,[{key:"render",value:function render(){var e=this,t=this.props,a=t.files,n=t.classes,i=a.length;return l.a.createElement(T.a,{className:et()(n.root,{[n.highlight]:i>0})},l.a.createElement("div",{className:n.title},a.length>1&&l.a.createElement(le.a,{type:"subheading"},i," selected"),1===a.length&&l.a.createElement(le.a,{type:"title"},a[0].substr(a[0].lastIndexOf("/")+1))),l.a.createElement("div",{className:n.spacer}),l.a.createElement("div",{className:n.actions,style:{width:"100px",marginRight:"8px"}},l.a.createElement(de.a,{"aria-label":"Delete"},l.a.createElement(Pe.a,{onChange:function onChange(e,t){alert("todo")}})),l.a.createElement(de.a,{"aria-label":"Download"},l.a.createElement(Le.a,{onClixk:function onClixk(t,n){e.props.handleDownload(a[0].name,a[0].path)}}))))}}]),FileListTableToolbar}(i.Component),at=Object(x.a)((function styleSheet(e){return{root:{paddingRight:2},highlight:"light"===e.palette.type?{color:e.palette.secondary.A700,backgroundColor:e.palette.secondary.A100}:{color:e.palette.secondary.A100,backgroundColor:e.palette.secondary.A700},spacer:{flex:"1 1 100%"},actions:{color:e.palette.text.secondary,display:"flex"},title:{flex:"0 0 auto",overflow:"hidden",maxWidth:"250px",overflowWrap:"break-word"}}}))(tt),nt=a(789),it=a(792),lt=a(783),rt=a(785),ot=a(777),st=function(e){Object(y.a)(SingleImageView,e);var t=Object(w.a)(SingleImageView);function SingleImageView(e,a){var n;return Object(b.a)(this,SingleImageView),(n=t.call(this,e,a)).state={keyword:"",tabIndex:n.props.tabIndex?n.props.tabIndex:0},n.handleTabChange=n.handleTabChange.bind(Object(O.a)(n)),n.handleAddKeywordChange=n.handleAddKeywordChange.bind(Object(O.a)(n)),n.handleAddKeywordClick=n.handleAddKeywordClick.bind(Object(O.a)(n)),n.handleKeywordDelete=n.handleKeywordDelete.bind(Object(O.a)(n)),n}return Object(v.a)(SingleImageView,[{key:"handleAddKeywordChange",value:function handleAddKeywordChange(e){this.setState({keyword:e.target.value})}},{key:"handleAddKeywordClick",value:function handleAddKeywordClick(e,t){var a,n=this.props.node["dam:tags"],i=this.state.keyword.split(","),l=Object(R.a)(i);try{for(l.s();!(a=l.n()).done;){var r=a.value;n.push(r)}}catch(err){l.e(err)}finally{l.f()}this.props.handleTagChange(n),this.setState({keyword:""})}},{key:"handleKeywordDelete",value:function handleKeywordDelete(e){for(var t=[],a=this.props.node["dam:tags"],n=0;n<a.length;n++)a[n]!==e&&t.push(a[n]);this.props.handleTagChange(t),this.props.node["dam:tags"]=t}},{key:"handleTabChange",value:function handleTabChange(e,t){this.setState({tabIndex:t})}},{key:"render",value:function render(){var e=this,t=this.props.classes;return l.a.createElement("div",{className:t.gridListRoot},l.a.createElement("div",{className:t.itemPreview},l.a.createElement("div",{style:{height:"100%",maxWidth:"100%",textAlign:"center"}},l.a.createElement("img",{src:G.baseHost.getValue()+this.props.node.path,alt:this.props.node.path,style:{maxHeight:"100%",maxWidth:"100%",alignSelf:"center"}}))),l.a.createElement("div",{className:t.itemRating},l.a.createElement(nt.a,{name:"img-ratings",value:this.props.node["dam:rating"],onChange:this.props.handleRatingChange,style:{float:"right"}})),l.a.createElement("div",{className:t.itemKeywords},l.a.createElement(le.a,{variant:"h6"},"Keywords:"),l.a.createElement("div",null,this.props.node["dam:tags"]&&this.props.node["dam:tags"].map((function(t){return l.a.createElement(it.a,{size:"small",label:t,onDelete:function onDelete(){return e.handleKeywordDelete(t)}})}))),l.a.createElement("div",null,l.a.createElement(lt.a,{id:"addKeyword",ref:"addKeywordField",label:"Add Keyword",margin:"normal",value:this.state.keyword,style:{width:"75%"},onChange:this.handleAddKeywordChange}),l.a.createElement(D.a,{color:"primary",style:{verticalAlign:"bottom"},disabled:0==this.state.keyword.length,onClick:this.handleAddKeywordClick},"Add"))),l.a.createElement("div",{className:t.itemInfo},l.a.createElement("hr",{style:{width:"100%"}}),l.a.createElement(rt.a,{value:"Details",indicatorColor:"primary",textColor:"primary",variant:"fullWidth",onChange:this.props.handleTabChange},l.a.createElement(ot.a,{label:"Details"}),l.a.createElement(ot.a,{label:"Versions"})),0===this.state.tabIndex&&l.a.createElement("div",null,l.a.createElement(Ee.a,null,l.a.createElement(je.a,null,l.a.createElement(Te.a,{style:{padding:"8px"}},l.a.createElement(De.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Type"),l.a.createElement(De.a,{align:"left"},this.props.node["jcr:content"]["jcr:mimeType"])),l.a.createElement(Te.a,null,l.a.createElement(De.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Resolution"),l.a.createElement(De.a,{align:"left"},this.props.node.width," x ",this.props.node.height)),l.a.createElement(Te.a,null,l.a.createElement(De.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Created"),l.a.createElement(De.a,{align:"left"},Oe()(this.props.node["dam:date.created"]).format("MMM Do YYYY, h:mm:ss a"))),l.a.createElement(Te.a,null,l.a.createElement(De.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Modified"),l.a.createElement(De.a,{align:"left"},Oe()(this.props.node["jcr:lastModified"]).format("MMM Do YYYY, h:mm:ss a")))))),1===this.state.tabIndex&&l.a.createElement("div",null,"Versions Panel")))}}]),SingleImageView}(i.Component),ct=Object(x.a)((function styleSheet(e){return{gridListRoot:{margin:"24px",display:"grid",gridGap:"8px",gridTemplateRows:"175px 25px 50px 3fr",gridTemplateColumns:"16px auto 16px",background:e.palette.background.paper,justifyContent:"center"},itemPreview:{gridRow:"1",gridColumn:"2",justifyContent:"center"},itemRating:{gridRow:"2",gridColumn:"2"},itemKeywords:{gridRow:"3/5",gridColumn:"2"},itemInfo:{gridRow:"5",gridColumn:"2"}}}))(st),dt=a(778),pt=a(779),ut=function(e){Object(y.a)(MultiImageView,e);var t=Object(w.a)(MultiImageView);function MultiImageView(e,a){var n;return Object(b.a)(this,MultiImageView),(n=t.call(this,e,a)).state={},n}return Object(v.a)(MultiImageView,[{key:"render",value:function render(){var e=this.props.classes;return l.a.createElement("div",{className:e.gridListRoot},l.a.createElement("div",{className:e.itemPreview},l.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden"}},l.a.createElement(dt.a,{cellHeight:160,style:{width:"100%",height:"100%"},cols:3},this.props.nodes.map((function(e){return l.a.createElement(pt.a,{key:e.path,cols:e.cols||1},l.a.createElement("img",{src:G.baseHost.getValue()+e.path,alt:e["jcr:path"],style:{height:"100%",maxWidth:"100%",alignSelf:"center"}}))}))))))}}]),MultiImageView}(i.Component),ht=Object(x.a)((function styleSheet(e){return{gridListRoot:{margin:"24px",display:"grid",gridGap:"8px",gridTemplateRows:"175px 25px 50px 3fr",gridTemplateColumns:"16px auto 16px",background:e.palette.background.paper,justifyContent:"center"},itemPreview:{gridRow:"1",gridColumn:"2",justifyContent:"center"}}}))(ut),gt=function(e){Object(y.a)(FileInfoSidebar,e);var t=Object(w.a)(FileInfoSidebar);function FileInfoSidebar(e,a){var n;return Object(b.a)(this,FileInfoSidebar),(n=t.call(this,e)).state={fileNodes:[],isMounted:!0,tabIndex:0},n}return Object(v.a)(FileInfoSidebar,[{key:"componentWillMount",value:function componentWillMount(){var e=this;this.setState({isMounted:!0,fileActions:X}),this.handleRatingChange=this.handleRatingChange.bind(this),this.handleTagChange=this.handleTagChange.bind(this),this.props.fileNodes?this.setState({fileNodes:this.props.fileNodes}):(X.getFileData.sink.takeWhile((function(){return e.state.isMounted})).subscribe((function(t){console.log(JSON.stringify(t)),e.setState({fileNodes:t})})),X.getFileData.source.next(this.props.files))}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(e){this.props=e,X.getFileData.source.next(this.props.files)}},{key:"handleRatingChange",value:function handleRatingChange(e,t){var a=this.state.fileNodes;a[0]["dam:rating"]=t,this.setState({fileNodes:a});var n={path:this.props.files[0],"dam:rating":t};X.setFileProperty.source.next(n)}},{key:"handleTagChange",value:function handleTagChange(e){var t=e;Array.isArray(e)||(t=e.split(","));var a=this.state.fileNodes;a[0]["dam:tags"]=t,this.setState({fileNodes:a});var n={path:this.props.files[0],"dam:tags":t};this.state.fileActions.setFileProperty.source.next(n)}},{key:"render",value:function render(){this.props.classes;return l.a.createElement(ee.a,{style:this.props.style},l.a.createElement(at,{onDownload:this.props.handleDownload,files:this.props.files}),1===this.state.fileNodes.length&&this.state.fileNodes[0]["jcr:mixinTypes"].indexOf("dam:image")>-1&&l.a.createElement(ct,{node:this.state.fileNodes[0],tabIndex:this.state.tabIndex,handleTabChange:this.handleTabChange,handleRatingChange:this.handleRatingChange,handleTagChange:this.handleTagChange}),this.state.fileNodes.length>1&&l.a.createElement(ht,{nodes:this.state.fileNodes}))}}]),FileInfoSidebar}(i.Component);FileList.propTypes={files:Qe.a.array.isRequired};var mt=Object(F.f)(Object(x.a)((function styleSheet(e){return{gridSingleItemInfo:{},title:{color:e.palette.primary[200]},titleBar:{background:"linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 70%, rgba(0,0,0,0) 100%)"}}}))(gt)),ft=a(289),bt=a.n(ft),vt=a(780),yt=a(781),wt=a(290),kt=a.n(wt);function SlideTransition(e){return l.a.createElement(vt.a,Object.assign({direction:"up"},e))}var Ft=function(e){Object(y.a)(UploadDialog,e);var t=Object(w.a)(UploadDialog);function UploadDialog(e,a){var n;return Object(b.a)(this,UploadDialog),(n=t.call(this,e)).state={isMounted:!0,isReceiverOpen:!1,files:[],filter:"all"},n.handleClose=n.handleClose.bind(Object(O.a)(n)),n}return Object(v.a)(UploadDialog,[{key:"componentDidMount",value:function componentDidMount(){var e=this;this.setState({isMounted:!0}),X.uploadProgress.subscribe((function(t){for(var a=[],n=0;n<e.props.files.length;n++){var i=e.props.files[n];t.id===i.id&&100!==t.progress&&(i.progress=t.progress),a.push(i)}e.setState({files:a})})),X.uploadError.subscribe((function(t){for(var a=[],n=0;n<e.props.files.length;n++){var i=e.props.files[n];t.id===i.id&&(i.error=t.error),a.push(i)}e.setState({files:a})})),setTimeout((function(){return e.startFileUploads(e.props.files)}),500)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(e){var t=this;this.props=e,setTimeout((function(){return t.startFileUploads(t.props.files)}),1e3)}},{key:"handleClose",value:function handleClose(){this.setState({files:[],filter:"all"}),this.props.onClose&&this.props.onClose()}},{key:"startFileUploads",value:function startFileUploads(e){if(this.props.files.length>0){for(var t=0;t<Math.min(3,this.props.files.length);t++);var a,n=Object(R.a)(this.props.files);try{for(n.s();!(a=n.n()).done;){var i=a.value;"uploadReady"===i.status&&(i.status="uploading",X.uploadFile.source.next(i))}}catch(err){n.e(err)}finally{n.f()}}}},{key:"render",value:function render(){var e=this,t=this.props.classes,a=this.props.files.filter((function(e){return 100===e.progress})).length,n=a/this.props.files.length*100,i=this.props.files.filter((function(t){return"completed"===e.state.filter?100===t.progress:"uploading"===e.state.filter?t.progress>0&&t.progress<100:"waiting"!==e.state.filter||0===t.progress}));return i.sort((function(e,t){return e.progress<t.progress?1:e.progress>t.progress?-1:0})),l.a.createElement(Ue.a,{maxWidth:"lg",fullWidth:!0,open:this.props.open,transition:SlideTransition,classes:{paper:t.dialogPaper}},l.a.createElement(j.a,{className:t.appBar},l.a.createElement(T.a,null,l.a.createElement(le.a,{type:"title",color:"inherit",className:t.flex},"Adding Files"),l.a.createElement(D.a,{onClick:this.handleClose,style:{color:"white"}},"close"))),this.props.files.length>0&&l.a.createElement("div",{style:{position:"absolute",top:"80px",right:"24px",left:"24px"}},l.a.createElement(le.a,{style:{display:"inline"}},a," / ",this.props.files.length),l.a.createElement(yt.a,{variant:"determinate",value:Math.min(n,100)}),l.a.createElement(le.a,null,"Files will be added to: ",l.a.createElement("strong",null,this.props.path))),this.props.files.length>0&&i.length>0&&l.a.createElement("div",{style:{height:"100%",overflow:"scroll",position:"absolute",top:"148px",bottom:"24px",left:"16px",right:"16px"}},l.a.createElement(Ee.a,null,l.a.createElement(Ke.a,null,l.a.createElement(Te.a,null,l.a.createElement(De.a,{style:{width:"32px",padding:"0 8px 0 8px"}}),l.a.createElement(De.a,{style:{width:"100%",padding:"0 8px 0 8px"}},"Name"),l.a.createElement(De.a,{style:{width:"50px",padding:"0 8px 0 8px"},numeric:!0},"Size"),l.a.createElement(De.a,{style:{width:"50px",padding:"0 8px 0 8px"},numeric:!0},"Progress"))),l.a.createElement(je.a,null,i.map((function(e){return e.progress<100?l.a.createElement(Te.a,{key:e.id},l.a.createElement(De.a,{style:{padding:"0 8px 0 8px"}},e.progress>0?l.a.createElement(S.a,{size:24}):l.a.createElement(kt.a,{color:"primary"})),l.a.createElement(De.a,{style:{padding:"0 8px 0 8px"}},l.a.createElement(le.a,null,e.name),l.a.createElement(le.a,{variant:"caption"},e.relativePath," ",e.error),l.a.createElement(yt.a,{variant:"determinate",value:e.progress,style:{height:"4px"}})),l.a.createElement(De.a,{style:{padding:"0 8px 0 8px"},numeric:!0},bt()(e.size,{base:10})),l.a.createElement(De.a,{style:{padding:"0 8px 0 8px"},numeric:!0},Math.round(e.progress),"%")):""}))))))}}]),UploadDialog}(i.Component),Ct=Object(x.a)((function styleSheet(e){return{appBar:{position:"relative"},flex:{flex:1},dialogPaper:{minHeight:"90%"}}}))(Ft);function NewFolderDialog_SlideTransition(e){return l.a.createElement(vt.a,Object.assign({direction:"up"},e))}var xt=function(e){Object(y.a)(NewFolderDialog,e);var t=Object(w.a)(NewFolderDialog);function NewFolderDialog(e,a){var n;return Object(b.a)(this,NewFolderDialog),(n=t.call(this,e)).state={folderName:""},n.handleSave=n.handleSave.bind(Object(O.a)(n)),n}return Object(v.a)(NewFolderDialog,[{key:"componentDidMount",value:function componentDidMount(){this.setState({isMounted:!0})}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"handleSave",value:function handleSave(){var e=this;X.createFolder.source.next({name:this.state.folderName,path:this.props.path}),X.createFolder.sink.subscribe((function(){e.props.onClose&&e.props.onClose()}))}},{key:"render",value:function render(){var e=this;return l.a.createElement(Ue.a,{maxWidth:"md",fullScreen:!1,open:this.props.open,transition:NewFolderDialog_SlideTransition},l.a.createElement(Be.a,null,"Create New Folder"),l.a.createElement(Ie.a,null,l.a.createElement(lt.a,{id:"newFolderName",label:"Folder Name",value:this.state.folderName,onChange:function onChange(t){return e.setState({folderName:t.target.value})},margin:"dense"})),l.a.createElement(We.a,null,l.a.createElement(D.a,{onClick:this.props.onClose,color:"primary"},"Close"),l.a.createElement(D.a,{raised:!0,color:"primary",onClick:this.handleSave},"Save")),l.a.createElement("input",{type:"file",ref:"fileInputField",multiple:!0,style:{display:"none"},onChange:this.handleFileChange}),l.a.createElement("input",{type:"file",ref:"folderInputField",style:{display:"none"},onChange:this.handleFolderChange}))}}]),NewFolderDialog}(i.Component),St=Object(x.a)((function styleSheet(e){return{}}))(xt),Ot=a(291),Et=function(e){Object(y.a)(FileReceiver,e);var t=Object(w.a)(FileReceiver);function FileReceiver(e,a){var n;return Object(b.a)(this,FileReceiver),(n=t.call(this,e)).state={isMounted:!0},n.handleOnDragEnter=n.handleOnDragEnter.bind(Object(O.a)(n)),n.handleOnDragOver=n.handleOnDragOver.bind(Object(O.a)(n)),n.handleOnDragLeave=n.handleOnDragLeave.bind(Object(O.a)(n)),n.handleAddFile=n.handleAddFile.bind(Object(O.a)(n)),n}return Object(v.a)(FileReceiver,[{key:"componentWillMount",value:function componentWillMount(){this.setState({isMounted:!0})}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(e){this.props=e}},{key:"handleOnDragEnter",value:function handleOnDragEnter(e){this.setState({isReceiverOpen:!0})}},{key:"handleOnDragOver",value:function handleOnDragOver(e){this.state.isReceiverOpen&&this.setState({isReceiverOpen:!0})}},{key:"handleOnDragLeave",value:function handleOnDragLeave(e){this.setState({isReceiverOpen:!1})}},{key:"handleAddFile",value:function handleAddFile(e,t){(new Q).scanFiles(e,this.props.path,t)}},{key:"render",value:function render(){return l.a.createElement(Ot.Receiver,{onDragEnter:this.handleOnDragEnter,onDragOver:this.handleOnDragOver,onDragLeave:this.handleOnDragLeave,onFileDrop:this.handleAddFile})}}]),FileReceiver}(i.Component),jt=new(function(){function GetFilesAndFoldersService(){Object(b.a)(this,GetFilesAndFoldersService),this.sink=new Subject,this.source=new Subject,this.source.subscribe(function(e){this.getFilesAndFolders(e)}.bind(this))}return Object(v.a)(GetFilesAndFoldersService,[{key:"getFilesAndFolders",value:function(){var e=Object(W.a)(U.a.mark((function _callee(e){var t,a,n,i,l,r,o=this;return U.a.wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:if(G.baseHost.getValue(),!(void 0!==e&&e.length>0)){s.next=15;break}return t=G.baseHost.getValue(),a=t+"/files/api/files?path="+e,(n=new Headers).append("Accept","application/json"),this.isLoading.next(!0),s.next=9,fetch(a,{method:"GET",cache:"no-cache",headers:n,credentials:"include"});case 9:return i=s.sent,s.next=12,i.json();case 12:l=s.sent,200==i.status&&l._embedded.files?this.sink.next(l._embedded.files):(console.dir(err),r={code:err.status,status:err.statusText,message:err.responseText},this.sink.error(r)),request.get(a).withCredentials().set("Accept","application/json").end((function(e,t){if(e)if(401===e.status)z.navigateTo.next("/");else if(403===e.status)z.alert.next("You do not have permission to access these files");else{var a={code:e.status,status:e.statusText,message:e.responseText};o.sink.error(a)}else{var n=[];t.body&&(n=t.body.filter((function(e){return!e.name.toString().startsWith(".")})));var i,l=Object(R.a)(n);try{for(l.s();!(i=l.n()).done;){var r=i.value;r["dam:tags"]&&1==r["dam:tags"].length&&(r["dam:tags"]=r["dam:tags"][0].split(","))}}catch(e){l.e(e)}finally{l.f()}o.sink.next(n)}}));case 15:case"end":return s.stop()}}),_callee,this)})));return function getFilesAndFolders(t){return e.apply(this,arguments)}}()}]),GetFilesAndFoldersService}()),Dt=function(e){Object(y.a)(FilesPage,e);var t=Object(w.a)(FilesPage);function FilesPage(e,a){var n;return Object(b.a)(this,FilesPage),(n=t.call(this,e)).state={isMounted:!1,isLoading:!1,canAddFile:!0,canAddFolder:!0,showAddFolderDialog:!1,showUploadSidebar:!1,showNewFolderDialog:!1,selectedFiles:[],uploadFiles:[],root:"/",visibleRoot:"/",path:"/"},n.handleFileSelectionChange=n.handleFileSelectionChange.bind(Object(O.a)(n)),n.handleUploadClosed=n.handleUploadClosed.bind(Object(O.a)(n)),n.handleAfterOnDelete=n.handleAfterOnDelete.bind(Object(O.a)(n)),n.handleFileSelect=n.handleFileSelect.bind(Object(O.a)(n)),n.handleFileChange=n.handleFileChange.bind(Object(O.a)(n)),n}return Object(v.a)(FilesPage,[{key:"componentWillMount",value:function componentWillMount(){this.setState({isMounted:!0}),this.validatePath()}},{key:"componentDidMount",value:function componentDidMount(){var e=this;z.navigateTo.takeWhile((function(){return e.state.isMounted})).subscribe((function(t){console.log("{FilesPage} navigateTo="+t),"://"===t.substring(0,3)?window.location.href.substring(window.location.href.indexOf("#")+1)!==t.substring(2)&&(window.location.href=t.substring(2)):e.props.history.push(t)}))}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(e){this.props=e,this.validatePath()}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.path!==this.props.path||e.location!==this.props.location||e.user!==this.props.user||t.path!==this.state.path||t.root!==this.state.root||t.selectedFiles!==this.state.selectedFiles||t.showUploadDialog!==this.state.showUploadDialog||t.showNewFolderDialog!==this.state.showNewFolderDialog}},{key:"validatePath",value:function validatePath(){var e=this.props.path;this.props.location.pathname&&this.props.location.pathname.toString().startsWith(this.state.visibleRoot)&&(e=this.props.location.pathname),e||(e=this.state.visibleRoot),e.toString().startsWith(this.state.visibleRoot)?this.setState({path:e}):console.log("Invalid Path: "+e)}},{key:"handleFileSelect",value:function handleFileSelect(){this.refs.fileInputField.click()}},{key:"handleFileSelectionChange",value:function handleFileSelectionChange(e){this.setState({selectedFiles:e,showUploadSidebar:!1})}},{key:"handleUploadClosed",value:function handleUploadClosed(){this.setState({showUploadDialog:!1,uploadFiles:[]}),jt.source.next(this.state.path)}},{key:"handleAfterOnDelete",value:function handleAfterOnDelete(e){for(var t=[],a=0;a<this.state.selectedFiles.length;a++){var n=this.state.selectedFiles[a];n!==e&&t.push(n)}this.setState({selectedFiles:t}),jt.source.next(this.state.path)}},{key:"handleFileChange",value:function handleFileChange(e,t){(new Q).scanFiles(e,this.state.path,e.target.files)}},{key:"handleFileDownload",value:function handleFileDownload(e,t){var a=document.createElement("a");return document.body.appendChild(a),a.href=t,a.download=e,a.click(),!1}},{key:"render",value:function render(){var e=this,t=this.props.classes,a=this.state.showUploadSidebar||this.state.uploadFiles.length>0||this.state.selectedFiles.length>0;return this.state.isLoading?l.a.createElement(Fe,{user:this.props.user},l.a.createElement(S.a,{className:t.progress,size:50})):l.a.createElement(Fe,{user:this.props.user,open:!1},l.a.createElement("div",{className:t.fileGrid},l.a.createElement(j.a,{color:"default",position:"static",elevation:0,className:t.fileGridAppBar,style:{colorDefault:"#eeeeee"}},l.a.createElement(T.a,{className:t.toolbarContainer},l.a.createElement(de.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu"},l.a.createElement(M.a,null)),l.a.createElement(le.a,{variant:"h6",className:t.title},l.a.createElement(xe,{root:this.state.root,path:this.state.path})),l.a.createElement("div",null,l.a.createElement(D.a,{color:"primary",disabled:!this.state.canAddFile,onClick:this.handleFileSelect},l.a.createElement(M.a,null),"\xa0\xa0Add Files"),l.a.createElement(D.a,{label:"New Folder",color:"primary",disabled:!this.state.canAddFolder,onClick:function onClick(){e.setState({showNewFolderDialog:!0})}},l.a.createElement(L.a,null),"\xa0\xa0New Folder")))),l.a.createElement("div",{className:t.fileGridFileList,style:{gridColumn:a?"1/2":"1/3"}},l.a.createElement(Et,{path:this.state.path,onFileDrop:this.handleOnFileDrop}),l.a.createElement(Je,{path:this.state.path,onSelectionChange:this.handleFileSelectionChange,onDelete:this.handleAfterOnDelete,style:{gridRow:"1 / 4",gridColumn:"1 / 3"}})),l.a.createElement(mt,{files:this.state.selectedFiles,className:t.fileGridSidebar,onDelete:this.handleAfterOnDelete,onDownload:this.handleFileDownload,style:{display:this.state.selectedFiles.length>0?"block":"none"}}),l.a.createElement(Ct,{onClose:this.handleUploadClosed,open:this.state.showUploadDialog,files:this.state.uploadFiles,path:this.state.path}),l.a.createElement(St,{onClose:function onClose(){e.setState({showNewFolderDialog:!1})},open:this.state.showNewFolderDialog,path:this.state.path})),l.a.createElement("input",{type:"file",ref:"fileInputField",multiple:!0,style:{display:"none"},onChange:this.handleFileChange}))}}]),FilesPage}(i.Component),Tt=Object(E.b)(Object(F.f)(Object(x.a)((function styleSheet(e){return{progress:{margin:"0 ".concat(2*e.spacing.unit,"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},toolbarContainer:{},fileGrid:{height:"100%",display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"4fr minmax(2px, 400px)"},fileGridAppBar:{gridRow:"1",gridColumn:"1/3"},fileGridFileList:{gridRow:"2",gridColumn:"1",margin:"24px"},fileGridSidebar:{gridRow:"2",gridColumn:"2",margin:"24px"},filePondSidebar:{gridRow:"2",gridColumn:"2",margin:"24px"},mainGrid:{height:"100%",overflow:"scroll",display:"grid",gridGap:"16px",gridTemplateRows:"1fr 1fr 1fr",gridTemplateColumns:"2fr 6fr"},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}))(Dt))),At=new(function(){function GetUsersService(){Object(b.a)(this,GetUsersService),this.isLoading=new B.BehaviorSubject(!1),this.source=new B.Subject,this.sink=new B.Subject,this.source.subscribe(this.getUser.bind(this))}return Object(v.a)(GetUsersService,[{key:"getUser",value:function getUser(e){var t=this,a=G.baseHost.getValue()+"/core/api/users/"+e,n=new Headers;n.append("pragma","no-cache"),n.append("cache-control","no-cache"),n.append("accept","application/json"),this.isLoading.next(!0),fetch(a,{method:"GET",mode:"cors",headers:n,credentials:"include"}).then((function(e){return e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e})).then((function(e){return e.json()})).then((function(e){t.sink.next(e)})).catch((function(e){if(401===e.status||403===e.status)window.location="/";else{console.error(e.statusText);var a={code:e.status,status:e.statusText,message:e.responseText||e.message};t.sink.error(a)}}))}}]),GetUsersService}()),Mt=function(e){Object(y.a)(App,e);var t=Object(w.a)(App);function App(e,a){var n;return Object(b.a)(this,App),(n=t.call(this,e,a)).state={context:a,locale:"en-EN",isAuthenticated:!1,isLoading:!0,isMounted:!1},window.location.href.indexOf(":3000"),n}return Object(v.a)(App,[{key:"componentWillMount",value:function componentWillMount(){this.setState({isMounted:!0})}},{key:"componentDidMount",value:function componentDidMount(){var e=this;At.sink.takeWhile((function(){return e.state.isMounted})).subscribe((function(t){t&&e.setState({isAuthenticated:!0,isLoading:!1,user:t})})),At.source.next(null)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"render",value:function render(){var e=this,t=this.props.classes,a="en-EN";return this.state.isLoading?l.a.createElement("div",null,l.a.createElement(S.a,{className:t.progress,size:50})):l.a.createElement(C.a,{locale:a,key:a,messages:this.props.i18nMessages[a]},l.a.createElement(k.a,null,l.a.createElement(F.c,null,l.a.createElement(F.a,{path:"/",component:function component(){return l.a.createElement(Tt,{user:e.state.user})}}))))}}]),App}(i.Component),Nt=Object(x.a)((function styleSheet(e){return{progress:{margin:"0 ".concat(2*e.spacing.unit,"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}}))(Mt),Lt={"en-EN":a(715)},Rt=Object(c.a)({palette:{type:"light",primary:u.a,secondary:Object(n.a)({},g.a),error:f.a}});!function renderApp(){o.a.render(l.a.createElement(d.a,{theme:Rt},l.a.createElement(Nt,{i18nMessages:Lt})),document.getElementById("root"))}(),function register(){if("serviceWorker"in navigator){if(new URL("/files",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/files","/service-worker.js");s?function checkValidServiceWorker(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):registerValidSW(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e):registerValidSW(e)}))}}()}},[[716,1,2]]]);
//# sourceMappingURL=main.c34bef8f.chunk.js.map