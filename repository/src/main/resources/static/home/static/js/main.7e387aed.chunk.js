(this.webpackJsonphome=this.webpackJsonphome||[]).push([[0],{166:function(e,t){},184:function(e,t,s){e.exports=s(460)},198:function(e,t){},204:function(e,t){},208:function(e,t,s){},459:function(e){e.exports=JSON.parse("{}")},460:function(e,t,s){"use strict";s.r(t);var a=s(178),n=s(6),o=s.n(n),r=s(165),i=s.n(r),l=s(49);const p=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function registerValidSW(e){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const t=e.installing;t.onstatechange=()=>{"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(e=>{console.error("Error during service worker registration:",e)})}var c=s(176),d=s(503),h=s(173),u=s.n(h),g=s(174),m=s.n(g),b=s(175),v=s.n(b),w=(s(208),s(136)),f=s(23),x=s(14),C=s(502),A=s(148),k=s(172),y=s.n(k),S=s(463),E=s(177),M=s(494),T=s(505),N=s(495),O=s(465),U=s(496),j=s(169),L=s.n(j),R=s(152),_=s.n(R),W=s(39),H=s(168),B=s.n(H);var I=class LoadClientAppsService_LoginService{constructor(e,t){this.sink=void 0,this.sink=t,e.subscribe(this.loadApps.bind(this))}loadApps(e){B.a.get("/api/v1/core/clientapps").withCredentials().set("Accept","application/json").end((e,t)=>{if(e)if(401===e.status)z.navigateTo.next("/");else if(403===e.status){var s={code:e.status,message:"Invalid Login (todo: show toast)"};this.sink.error(s)}else{console.dir(e);var a={code:e.status,status:e.statusText,message:e.responseText};this.sink.error(a)}else this.sink.next({primaryApps:t.body.apps.primary,secondaryApps:t.body.apps.secondary})})}};var P=new class AppSettings_AppSettings{constructor(){this.baseHost=new W.BehaviorSubject("http://locaalhost:9000"),this.basicUser=new W.BehaviorSubject(window.localStorage.getItem("u")),this.basicPwd=new W.BehaviorSubject(window.localStorage.getItem("p"))}};var G=class LogoutService_LogoutService{constructor(e,t){this.sink=void 0,this.sink=t,e.subscribe(this.getUser.bind(this))}getUser(e){const t=P.baseHost.getValue();fetch(t+"/logout",{method:"GET"}).then(e=>(e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e)).catch(e=>{if(401===e.status||403===e.status)window.location="/";else{var t={code:e.status,status:e.statusText,message:e.responseText};this.sink.error(t)}})}};var z=new class AppActions_AppActions{constructor(){this.navigateTo=new W.Subject,this.logout={source:new W.Subject,sink:new W.Subject},this.loadClientApps={source:new W.Subject,sink:new W.Subject},this.loadClientAppsService=new I(this.loadClientApps.source,this.loadClientApps.sink),this.logoutService=new G(this.logout.source,this.logout.sink)}};class Sidebar_Sidebar extends n.Component{constructor(e,t){super(e),this.handleNavClick=this.handleNavClick.bind(this)}shouldComponentUpdate(e,t){return e.open!==this.props.open||e.user!==this.props.user||e.apps!==this.props.apps||e.secondaryApps!==this.props.secondaryApps}handleNavClick(e){this.props.onNavClick&&this.props.onNavClick(e)}handleLogout(){window.localStorage.clear(),z.logout.source.next(!0),z.navigateTo.next("://")}findApp(e,t){if(t){var s,a=Object(E.a)(t);try{for(a.s();!(s=a.n()).done;){let t=s.value;if(t.slug===e)return t}}catch(n){a.e(n)}finally{a.f()}}return null}render(){var e=this.props.classes,t=this.findApp("usermanager",this.props.secondaryApps);return o.a.createElement(S.a,{className:this.props.open?e.sidebarOpen:e.sidebarClosed},o.a.createElement(S.a,{className:this.props.open?e.sidebarUserInfo:e.sidebarUserInfoClosed},o.a.createElement("div",{className:e.sidebarProfileIcon},o.a.createElement(_.a,{style:{width:60,height:60}})),o.a.createElement("div",{className:e.sidebarProfileName},o.a.createElement(A.a,{component:"div",type:"title"},this.props.user.firstName," ",this.props.user.lastName)),o.a.createElement("div",{className:e.sidebarButtons},o.a.createElement(M.a,{onClick:this.handleLogout},"Logout"),t&&o.a.createElement(M.a,{onClick:()=>z.navigateTo.next(t.path)},"Profile"))),o.a.createElement("div",{className:this.props.open?e.appListsOpen:e.appListsClosed},o.a.createElement("div",{style:{gridColumn:"1",gridRow:"1"}},o.a.createElement(A.a,{type:"title",className:this.props.open?e.openLabel:e.closedLabel,style:{paddingLeft:"16px",paddingTop:"16px",gridColumn:"1",gridRow:"1"}},"Apps")),o.a.createElement(N.a,{style:{gridColumn:"1",gridRow:"2"}},this.props.apps&&this.props.apps.map(t=>o.a.createElement(O.a,{button:!0,key:t.path,onClick:()=>this.handleNavClick(t.path)},o.a.createElement(T.a,{style:{marginRight:"8px"}},o.a.createElement(L.a,null)),o.a.createElement(U.a,{primary:t.label,primaryTypographyProps:{type:"body2"},className:this.props.open?e.openLabel:e.closedLabel})))),o.a.createElement(N.a,{style:{gridColumn:"1",gridRow:"3"},className:this.props.open?e.closedLabel:e.openLabel},o.a.createElement(O.a,{button:!0,onClick:()=>this.handleNavClick("://app-usermanager/index.html")},o.a.createElement(T.a,null,o.a.createElement(_.a,{style:{width:48,height:48}}))))))}}var V=Object(l.c)(Object(x.a)(e=>({sidebarOpen:{width:"240px",height:"100vh",background:"#fff"},sidebarClosed:{width:"72px",height:"100vh",background:"#fff"},sidebarUserInfo:{width:"100%",padding:"8px",display:"grid",gridGap:"8px",gridTemplateRows:"auto",gridTemplateColumns:"60px auto"},sidebarUserInfoClosed:{display:"none"},sidebarProfileIcon:{gridColumn:"1",gridRow:"1"},sidebarProfileName:{gridColumn:"2",gridRow:"1",alignSelf:"center"},sidebarButtons:{gridColumn:"1/3",gridRow:"2",justifySelf:"center"},appListsOpen:{display:"grid",gridGap:"0px",gridTemplateRows:"24px auto",gridTemplateColumns:"auto",marginTop:"16px"},appListsClosed:{height:"90%",display:"grid",gridGap:"0px",gridTemplateRows:"0px auto 72px",gridTemplateColumns:"auto"},openLabel:{display:"inline"},closedLabel:{display:"none"}}))(Sidebar_Sidebar)),D=s(497),J=s(498),$=s(499),F=s(501),q=s(504),K=s(500),Q=s(171),X=s.n(Q),Y=s(170),Z=s.n(Y);class AppHeader_AppHeader extends n.Component{constructor(e,t){super(e),this.state={openMoreMenu:!1},this.handleToggle=this.handleToggle.bind(this),this.handleOpenMoreMenu=this.handleOpenMoreMenu.bind(this),this.handleLogout=this.handleLogout.bind(this)}shouldComponentUpdate(e,t){return e.onToggle!==this.props.onToggle||e.apps!==this.props.apps||t.openMoreMenu!==this.state.openMoreMenu}handleOpenMoreMenu(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}handleToggle(){this.props.onToggle&&this.props.onToggle()}handleNavClick(e){this.props.onNavClick&&this.props.onNavClick(e)}handleMenuClose(){this.setState({openMoreMenu:!1})}handleLogout(){window.localStorage.clear(),z.logout.source.next(!0),window.location="/"}render(){var e=this.props.classes;return o.a.createElement(D.a,{className:e.root,position:"static"},o.a.createElement(J.a,null,o.a.createElement($.a,{onClick:this.handleToggle,className:e.menuButton,color:"contrast","aria-label":"Menu"},o.a.createElement(Z.a,null)),o.a.createElement(A.a,{variant:"h5",color:"inherit",className:e.flex,onClick:()=>this.handleNavClick("://home/index.html")},"Family ",o.a.createElement("i",null,"D.A.M")),o.a.createElement($.a,{"aria-label":"More","aria-owns":this.state.open?"long-menu":null,"aria-haspopup":"true",onClick:this.handleOpenMoreMenu,className:e.moreButton},o.a.createElement(X.a,null)),o.a.createElement(q.a,{id:"long-menu",keepMounted:!0,anchorEl:this.state.openMoreMenuAnchorEl,open:this.state.openMoreMenu},o.a.createElement(K.a,{onClick:()=>{this.handleLogout(),this.handleMenuClose()}},"Logout"),o.a.createElement(F.a,null),this.props.apps&&this.props.apps.map(e=>o.a.createElement(K.a,{key:e.path,color:"contrast",onClick:()=>{this.handleNavClick(e.path),this.handleMenuClose()}},e.label)))))}}var ee=Object(l.c)(Object(x.a)(e=>({root:{width:"100%",height:"64px"},headerContainer:{display:"grid",gridTemplateRows:"auto",gridTemplateColumns:"48px auto 48px"},hamburgerMenu:{display:"block",gridRow:"1",gridColumn:"1"},mainSection:{gridRow:"1",gridColumn:"2"},rightSection:{gridRow:"2",gridColumn:"3",textAlign:"right"},flex:{flex:1},menuButton:{marginLeft:-12,marginRight:20,color:"#ffffff"},moreButton:{color:"#ffffff"}}))(AppHeader_AppHeader));class AppShell_AppShell extends n.Component{constructor(e,t){super(e);var s=window.localStorage.getItem("AppShell.isOpen");s||(s=void 0===e.open||e.open),this.state={isMounted:!0,isOpen:Boolean(s)},this.handleOpenCloseToggle=this.handleOpenCloseToggle.bind(this),this.handleOpenMoreMenu=this.handleOpenMoreMenu.bind(this)}shouldComponentUpdate(e,t){return e.open!==this.props.open||e.user!==this.props.user||e.children!==this.props.children||t.isOpen!==this.state.isOpen||t.primaryApps!==this.state.primaryApps||t.secondaryApps!==this.state.secondaryApps}componentWillMount(){this.setState({isMounted:!0}),z.navigateTo.takeWhile(()=>this.state.isMounted).subscribe(function(e){"://"!==e&&"://"===e.substring(0,3)?window.location.href=e.substring(2):this.props.history&&this.props.history.push(e)}.bind(this)),z.loadClientApps.sink.subscribe(e=>{e&&this.setState({primaryApps:e.primaryApps,secondaryApps:e.secondaryApps})}),z.loadClientApps.source.next(!0)}componentWillUnmount(){this.setState({isMounted:!1})}handleOpenMoreMenu(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}handleOpenCloseToggle(){var e=!this.state.isOpen;this.setState({isOpen:e}),window.localStorage.setItem("AppShell.isOpen",e)}handleLogout(){window.localStorage.clear(),z.logout.source.next(!0),z.navigateTo.next("://")}render(){var e=this.props.classes;return this.props.user?o.a.createElement("div",{className:this.state.isOpen?e.dashboardShellContainerOpen:e.dashboardShellContainerClosed},o.a.createElement("header",{className:e.header},o.a.createElement(ee,{apps:this.state.secondaryApps,onToggle:this.handleOpenCloseToggle,onNavClick:e=>z.navigateTo.next(e)})),o.a.createElement(V,{user:this.props.user,apps:this.state.primaryApps,secondaryApps:this.state.secondaryApps,open:this.state.isOpen,onNavClick:e=>z.navigateTo.next(e)}),o.a.createElement("div",{className:e.main},this.props.children)):o.a.createElement("div",null)}}var te=Object(l.c)(Object(f.f)(Object(x.a)(e=>({dashboardShellContainerOpen:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"240px auto"},dashboardShellContainerClosed:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"72px auto"},header:{gridColumn:"1/3",gridRow:"1",position:"inherit",height:"64px"},main:{fontSize:".5rem",background:"#eee"}}))(AppShell_AppShell)));class DashboardPage_DashboardPage extends n.Component{constructor(e,t){super(e),this.state={isMounted:!0}}componentWillMount(){this.setState({isMounted:!0}),z.loadClientApps.sink.takeWhile(()=>this.state.isMounted).subscribe(e=>{e&&this.setState({primaryApps:e.primaryApps,secondaryApps:e.secondaryApps})})}componentWillUnmount(){this.setState({isMounted:!1})}componentWillReceiveProps(e,t){}render(){var e=this.props.classes;return this.state.isLoading?o.a.createElement("div",null,o.a.createElement(C.a,{className:e.progress,size:50})):o.a.createElement(te,{user:this.props.user,history:this.props.history},o.a.createElement("div",{className:e.contentContainer},o.a.createElement("div",{className:e.contentHeader},o.a.createElement(A.a,{style:{fontSize:"24px",lineHeight:"24px"}},"Where would you like to start?")),this.state.primaryApps&&this.state.primaryApps.filter(e=>"home"!==e.slug).map((t,s)=>o.a.createElement(S.a,{key:t.path,"data-indx":s,className:e["contentAppCard"+s],onClick:()=>z.navigateTo.next(t.path)},o.a.createElement(y.a,{style:{width:"48px",height:"48px"}}),o.a.createElement(A.a,{style:{fontSize:"24px"}},t.label)))))}}var se=Object(l.c)(Object(f.f)(Object(x.a)(e=>({progress:{margin:"0 ".concat(e.spacing(2),"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},contentContainer:{height:"100%",margin:"auto",display:"grid",gridGap:"24px",gridTemplateRows:"auto 125px 150px 150px auto",gridTemplateColumns:"auto 300px 300px auto",gridAutoFlow:"column"},contentHeader:{gridColumn:"2/4",gridRow:2,marginTop:"auto"},contentHeaderLabel:{fontSize:"96px",color:e.accentColor,lineHeight:"104px",textTransform:"capitalize"},contentAppCard0:{gridColumn:"2/3",gridRow:3,textAlign:"center",padding:"32px"},contentAppCard1:{gridColumn:"3/4",gridRow:3,textAlign:"center",padding:"32px"},contentAppCard2:{gridColumn:"2/3",gridRow:4,textAlign:"center",padding:"32px"},contentAppCard3:{gridColumn:"3/4",gridRow:4,textAlign:"center",padding:"32px"}}))(DashboardPage_DashboardPage)));var ae=class GetUserService_GetUsersService{constructor(e,t){this.sink=void 0,this.sink=t,e.subscribe(this.getUser.bind(this))}getUser(e){const t=P.baseHost.getValue();fetch(t+"/api/v1/auth/user/me",{method:"GET"}).then(e=>(e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e)).then(e=>e.json()).then(e=>{e.firstName||(e.firstName=e.username),this.sink.next(e)}).catch(e=>{if(401===e.status||403===e.status)window.location="/";else{var t={code:e.status,status:e.statusText,message:e.responseText||e.message};this.sink.error(t)}})}},ne=s(113),oe=s.n(ne),re=s(155);var ie=class GetAllUsersService_GetAllUsersService{constructor(e,t,s){this.sink=void 0,this.sink=t,e.subscribe(this.getUsers.bind(this))}getUsers(){var e=this;return Object(re.a)(oe.a.mark((function _callee2(){var t,s,a,n;return oe.a.wrap((function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:return t=P.baseHost.getValue(),s=t+"/api/v1/auth/users",(a=new Headers).append("pragma","no-cache"),a.append("cache-control","no-cache"),o.next=7,fetch(s,{method:"GET",cache:"no-cache",headers:a}).then(function(){var e=Object(re.a)(oe.a.mark((function _callee(e){return oe.a.wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.json());case 1:case"end":return t.stop()}}),_callee)})));return function(t){return e.apply(this,arguments)}}()).then(e=>{for(var t=[],s=0;s<e.length;s++){var a=e[s];void 0===a.firstName&&(a.firstName=a.username),t.push(a)}return t.sort((function(e,t){return e.username>t.username?1:e.username<t.username?-1:0}))}).catch(e=>{if(401===e.status||403===e.status)window.location="/";else{var t={code:e.status,status:e.statusText,message:e.responseText||e.message};console.warn(t),setTimeout(()=>{le.getAllUsers.source.next(!0)},500)}});case 7:(n=o.sent)&&e.sink.next(n);case 9:case"end":return o.stop()}}),_callee2)})))()}};var le=new class UserActions_UserActions{constructor(){this.getUser={source:new W.Subject,sink:new W.Subject},this.getAllUsers={source:new W.Subject,sink:new W.Subject},this.getUserService=new ae(this.getUser.source,this.getUser.sink),this.getAllUsersService=new ie(this.getAllUsers.source,this.getAllUsers.sink)}};class App_App extends n.Component{constructor(e,t){super(e,t),this.state={context:t,locale:"en-EN",isMounted:!0,isAuthenticated:!1}}componentDidMount(){this.setState({isMounted:!0}),le.getUser.sink.takeWhile(()=>this.state.isMounted).subscribe(e=>{console.dir(e),console.log("UserActions.getUser.sink"),e?this.setState({user:e}):window.location="/index.html"}),le.getUser.source.next(null)}componentWillUnmount(){this.setState({isMounted:!1})}render(){const e=this.props.classes;return this.state.user?o.a.createElement(l.a,{locale:"en-EN",key:"en-EN",messages:this.props.i18nMessages["en-EN"]},o.a.createElement(w.a,null,o.a.createElement(f.c,null,o.a.createElement(f.a,{path:"/",component:()=>o.a.createElement(se,{user:this.state.user})})))):o.a.createElement("div",null,o.a.createElement(C.a,{className:e.progress,size:50}))}}var pe=Object(x.a)(e=>({progress:{margin:"0 ".concat(e.spacing(2),"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}))(App_App);Object(l.b)(s(458));const ce={"en-EN":s(459)},de=Object(c.a)({palette:{type:"light",primary:u.a,secondary:Object(a.a)({},m.a),error:v.a}});!function renderApp(){i.a.render(o.a.createElement(d.a,{theme:de},o.a.createElement(pe,{i18nMessages:ce})),document.getElementById("root"))}(),function register(){if("serviceWorker"in navigator){if(new URL("/home",window.location).origin!==window.location.origin)return;window.addEventListener("load",()=>{const e="".concat("/home","/service-worker.js");p?function checkValidServiceWorker(e){fetch(e).then(t=>{404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):registerValidSW(e)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(e):registerValidSW(e)})}}()}},[[184,1,2]]]);
//# sourceMappingURL=main.7e387aed.chunk.js.map