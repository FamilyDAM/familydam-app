(this.webpackJsonphome=this.webpackJsonphome||[]).push([[0],{157:function(e,t){},175:function(e,t,n){e.exports=n(444)},189:function(e,t){},195:function(e,t){},199:function(e,t,n){},443:function(e){e.exports=JSON.parse("{}")},444:function(e,t,n){"use strict";n.r(t);var a=n(169),o=n(0),s=n.n(o),i=n(21),r=n.n(i),l=n(48),c=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function registerValidSW(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var p=n(168),u=n(483),d=n(165),h=n.n(d),g=n(166),m=n.n(g),f=n(167),b=n.n(f),v=(n(199),n(19)),k=n(27),w=n(57),y=n(53),C=n(58),A=n(129),x=n(74),S=n(14),O=n(482),j=n(140),E=n(164),M=n.n(E),T=n(446),N=n(52),U=n(474),L=n(485),R=n(475),W=n(448),H=n(476),G=n(159),P=n.n(G),B=n(144),I=n.n(B),D=n(38),V=n(158),z=n.n(V),J=function(){function LoginService(e,t){Object(v.a)(this,LoginService),this.sink=void 0,this.sink=t,e.subscribe(this.loadApps.bind(this))}return Object(k.a)(LoginService,[{key:"loadApps",value:function loadApps(e){var t=this;z.a.get("/api/v1/core/clientapps").withCredentials().set("Accept","application/json").end((function(e,n){if(e)if(401===e.status)_.navigateTo.next("/");else if(403===e.status){var a={code:e.status,message:"Invalid Login (todo: show toast)"};t.sink.error(a)}else{console.dir(e);var o={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(o)}else t.sink.next({primaryApps:n.body.apps.primary,secondaryApps:n.body.apps.secondary})}))}}]),LoginService}(),$=new function AppSettings(){Object(v.a)(this,AppSettings),this.baseHost=new D.BehaviorSubject(""),this.basicUser=new D.BehaviorSubject(window.localStorage.getItem("u")),this.basicPwd=new D.BehaviorSubject(window.localStorage.getItem("p"))},F=function(){function LogoutService(e,t){Object(v.a)(this,LogoutService),this.sink=void 0,this.sink=t,e.subscribe(this.getUser.bind(this))}return Object(k.a)(LogoutService,[{key:"getUser",value:function getUser(e){var t=this,n=$.baseHost.getValue();fetch(n+"/logout",{method:"GET"}).then((function(e){return e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e})).catch((function(e){if(401===e.status||403===e.status)window.location="/";else{var n={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(n)}}))}}]),LogoutService}(),_=new function AppActions(){Object(v.a)(this,AppActions),this.navigateTo=new D.Subject,this.logout={source:new D.Subject,sink:new D.Subject},this.loadClientApps={source:new D.Subject,sink:new D.Subject},this.loadClientAppsService=new J(this.loadClientApps.source,this.loadClientApps.sink),this.logoutService=new F(this.logout.source,this.logout.sink)},q=function(e){function Sidebar(e,t){var n;return Object(v.a)(this,Sidebar),(n=Object(w.a)(this,Object(y.a)(Sidebar).call(this,e))).handleNavClick=n.handleNavClick.bind(Object(N.a)(n)),n}return Object(C.a)(Sidebar,e),Object(k.a)(Sidebar,[{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.open!==this.props.open||e.user!==this.props.user||e.apps!==this.props.apps||e.secondaryApps!==this.props.secondaryApps}},{key:"handleNavClick",value:function handleNavClick(e){this.props.onNavClick&&this.props.onNavClick(e)}},{key:"handleLogout",value:function handleLogout(){window.localStorage.clear(),_.logout.source.next(!0),_.navigateTo.next("://")}},{key:"findApp",value:function findApp(e,t){if(t){var n=!0,a=!1,o=void 0;try{for(var s,i=t[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var r=s.value;if(r.slug===e)return r}}catch(l){a=!0,o=l}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}}return null}},{key:"render",value:function render(){var e=this,t=this.props.classes,n=this.findApp("usermanager",this.props.secondaryApps);return s.a.createElement(T.a,{className:this.props.open?t.sidebarOpen:t.sidebarClosed},s.a.createElement(T.a,{className:this.props.open?t.sidebarUserInfo:t.sidebarUserInfoClosed},s.a.createElement("div",{className:t.sidebarProfileIcon},s.a.createElement(I.a,{style:{width:60,height:60}})),s.a.createElement("div",{className:t.sidebarProfileName},s.a.createElement(j.a,{component:"div",type:"title"},this.props.user.firstName," ",this.props.user.lastName)),s.a.createElement("div",{className:t.sidebarButtons},s.a.createElement(U.a,{onClick:this.handleLogout},"Logout"),n&&s.a.createElement(U.a,{onClick:function onClick(){return _.navigateTo.next(n.path)}},"Profile"))),s.a.createElement("div",{className:this.props.open?t.appListsOpen:t.appListsClosed},s.a.createElement("div",{style:{gridColumn:"1",gridRow:"1"}},s.a.createElement(j.a,{type:"title",className:this.props.open?t.openLabel:t.closedLabel,style:{paddingLeft:"16px",paddingTop:"16px",gridColumn:"1",gridRow:"1"}},"Apps")),s.a.createElement(R.a,{style:{gridColumn:"1",gridRow:"2"}},this.props.apps&&this.props.apps.map((function(n){return s.a.createElement(W.a,{button:!0,key:n.path,onClick:function onClick(){return e.handleNavClick(n.path)}},s.a.createElement(L.a,{style:{marginRight:"8px"}},s.a.createElement(P.a,null)),s.a.createElement(H.a,{primary:n.label,secondary:"",className:e.props.open?t.openLabel:t.closedLabel}))}))),s.a.createElement(R.a,{style:{gridColumn:"1",gridRow:"3"},className:this.props.open?t.closedLabel:t.openLabel},s.a.createElement(W.a,{button:!0,onClick:function onClick(){return e.handleNavClick("://app-usermanager/index.html")}},s.a.createElement(L.a,null,s.a.createElement(I.a,{style:{width:48,height:48}}))))))}}]),Sidebar}(o.Component),K=Object(l.c)(Object(S.a)((function styleSheet(e){return{sidebarOpen:{width:"240px",height:"100vh",background:"#fff"},sidebarClosed:{width:"72px",height:"100vh",background:"#fff"},sidebarUserInfo:{width:"100%",padding:"8px",display:"grid",gridGap:"8px",gridTemplateRows:"auto",gridTemplateColumns:"60px auto"},sidebarUserInfoClosed:{display:"none"},sidebarProfileIcon:{gridColumn:"1",gridRow:"1"},sidebarProfileName:{gridColumn:"2",gridRow:"1",alignSelf:"center"},sidebarButtons:{gridColumn:"1/3",gridRow:"2",justifySelf:"center"},appListsOpen:{display:"grid",gridGap:"0px",gridTemplateRows:"24px auto",gridTemplateColumns:"auto",marginTop:"16px"},appListsClosed:{height:"90%",display:"grid",gridGap:"0px",gridTemplateRows:"0px auto 72px",gridTemplateColumns:"auto"},openLabel:{display:"inline"},closedLabel:{display:"none"}}}))(q)),Q=n(477),X=n(478),Y=n(479),Z=n(481),ee=n(484),te=n(480),ne=n(161),ae=n.n(ne),oe=n(160),se=n.n(oe),ie=function(e){function AppHeader(e,t){var n;return Object(v.a)(this,AppHeader),(n=Object(w.a)(this,Object(y.a)(AppHeader).call(this,e))).state={openMoreMenu:!1},n.handleToggle=n.handleToggle.bind(Object(N.a)(n)),n.handleOpenMoreMenu=n.handleOpenMoreMenu.bind(Object(N.a)(n)),n.handleLogout=n.handleLogout.bind(Object(N.a)(n)),n}return Object(C.a)(AppHeader,e),Object(k.a)(AppHeader,[{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.onToggle!==this.props.onToggle||e.apps!==this.props.apps||t.openMoreMenu!==this.state.openMoreMenu}},{key:"handleOpenMoreMenu",value:function handleOpenMoreMenu(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}},{key:"handleToggle",value:function handleToggle(){this.props.onToggle&&this.props.onToggle()}},{key:"handleNavClick",value:function handleNavClick(e){this.props.onNavClick&&this.props.onNavClick(e)}},{key:"handleMenuClose",value:function handleMenuClose(){this.setState({openMoreMenu:!1})}},{key:"handleLogout",value:function handleLogout(){window.localStorage.clear(),_.logout.source.next(!0),window.location="/"}},{key:"render",value:function render(){var e=this,t=this.props.classes;return s.a.createElement(Q.a,{className:t.root,position:"static"},s.a.createElement(X.a,null,s.a.createElement(Y.a,{onClick:this.handleToggle,className:t.menuButton,color:"contrast","aria-label":"Menu"},s.a.createElement(se.a,null)),s.a.createElement(j.a,{variant:"h5",color:"inherit",className:t.flex,onClick:function onClick(){return e.handleNavClick("://home/index.html")}},"Family ",s.a.createElement("i",null,"D.A.M")),s.a.createElement(Y.a,{"aria-label":"More","aria-owns":this.state.open?"long-menu":null,"aria-haspopup":"true",onClick:this.handleOpenMoreMenu,className:t.moreButton},s.a.createElement(ae.a,null)),s.a.createElement(ee.a,{id:"long-menu",keepMounted:!0,anchorEl:this.state.openMoreMenuAnchorEl,open:this.state.openMoreMenu},s.a.createElement(te.a,{onClick:function onClick(){e.handleLogout(),e.handleMenuClose()}},"Logout"),s.a.createElement(Z.a,null),this.props.apps&&this.props.apps.map((function(t){return s.a.createElement(te.a,{key:t.path,color:"contrast",onClick:function onClick(){e.handleNavClick(t.path),e.handleMenuClose()}},t.label)})))))}}]),AppHeader}(o.Component),re=Object(l.c)(Object(S.a)((function styleSheet(e){return{root:{width:"100%",height:"64px"},headerContainer:{display:"grid",gridTemplateRows:"auto",gridTemplateColumns:"48px auto 48px"},hamburgerMenu:{display:"block",gridRow:"1",gridColumn:"1"},mainSection:{gridRow:"1",gridColumn:"2"},rightSection:{gridRow:"2",gridColumn:"3",textAlign:"right"},flex:{flex:1},menuButton:{marginLeft:-12,marginRight:20,color:"#ffffff"},moreButton:{color:"#ffffff"}}}))(ie)),le=function(e){function AppShell(e,t){var n;Object(v.a)(this,AppShell),n=Object(w.a)(this,Object(y.a)(AppShell).call(this,e));var a=window.localStorage.getItem("AppShell.isOpen");return a||(a=void 0===e.open||e.open),n.state={isMounted:!0,isOpen:Boolean(a)},n.handleOpenCloseToggle=n.handleOpenCloseToggle.bind(Object(N.a)(n)),n.handleOpenMoreMenu=n.handleOpenMoreMenu.bind(Object(N.a)(n)),n}return Object(C.a)(AppShell,e),Object(k.a)(AppShell,[{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.open!==this.props.open||e.user!==this.props.user||e.children!==this.props.children||t.isOpen!==this.state.isOpen||t.primaryApps!==this.state.primaryApps||t.secondaryApps!==this.state.secondaryApps}},{key:"componentWillMount",value:function componentWillMount(){var e=this;this.setState({isMounted:!0}),_.navigateTo.takeWhile((function(){return e.state.isMounted})).subscribe(function(e){"://"!==e&&"://"===e.substring(0,3)?window.location.href=e.substring(2):this.props.history&&this.props.history.push(e)}.bind(this)),_.loadClientApps.sink.subscribe((function(t){t&&e.setState({primaryApps:t.primaryApps,secondaryApps:t.secondaryApps})})),_.loadClientApps.source.next(!0)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"handleOpenMoreMenu",value:function handleOpenMoreMenu(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}},{key:"handleOpenCloseToggle",value:function handleOpenCloseToggle(){var e=!this.state.isOpen;this.setState({isOpen:e}),window.localStorage.setItem("AppShell.isOpen",e)}},{key:"handleLogout",value:function handleLogout(){window.localStorage.clear(),_.logout.source.next(!0),_.navigateTo.next("://")}},{key:"render",value:function render(){var e=this.props.classes;return this.props.user?s.a.createElement("div",{className:this.state.isOpen?e.dashboardShellContainerOpen:e.dashboardShellContainerClosed},s.a.createElement("header",{className:e.header},s.a.createElement(re,{apps:this.state.secondaryApps,onToggle:this.handleOpenCloseToggle,onNavClick:function onNavClick(e){return _.navigateTo.next(e)}})),s.a.createElement(K,{user:this.props.user,apps:this.state.primaryApps,secondaryApps:this.state.secondaryApps,open:this.state.isOpen,onNavClick:function onNavClick(e){return _.navigateTo.next(e)}}),s.a.createElement("div",{className:e.main},this.props.children)):s.a.createElement("div",null)}}]),AppShell}(o.Component),ce=Object(l.c)(Object(x.f)(Object(S.a)((function styleSheet(e){return{dashboardShellContainerOpen:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"240px auto"},dashboardShellContainerClosed:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"72px auto"},header:{gridColumn:"1/3",gridRow:"1",position:"inherit",height:"64px"},main:{background:"#eee"}}}))(le))),pe=function(e){function DashboardPage(e,t){var n;return Object(v.a)(this,DashboardPage),(n=Object(w.a)(this,Object(y.a)(DashboardPage).call(this,e))).state={isMounted:!0},n}return Object(C.a)(DashboardPage,e),Object(k.a)(DashboardPage,[{key:"componentWillMount",value:function componentWillMount(){var e=this;this.setState({isMounted:!0}),_.loadClientApps.sink.takeWhile((function(){return e.state.isMounted})).subscribe((function(t){t&&e.setState({primaryApps:t.primaryApps,secondaryApps:t.secondaryApps})}))}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(e,t){}},{key:"render",value:function render(){var e=this.props.classes;return this.state.isLoading?s.a.createElement("div",null,s.a.createElement(O.a,{className:e.progress,size:50})):s.a.createElement(ce,{user:this.props.user,history:this.props.history},s.a.createElement("div",{className:e.contentContainer},s.a.createElement("div",{className:e.contentHeader},s.a.createElement(j.a,{style:{fontSize:"24px",lineHeight:"24px"}},"Where would you like to start?")),this.state.primaryApps&&this.state.primaryApps.filter((function(e){return"home"!==e.slug})).map((function(t,n){return s.a.createElement(T.a,{key:t.path,"data-indx":n,className:e["contentAppCard"+n],onClick:function onClick(){return _.navigateTo.next(t.path)}},s.a.createElement(M.a,{style:{width:"48px",height:"48px"}}),s.a.createElement(j.a,{style:{fontSize:"24px"}},t.label))}))))}}]),DashboardPage}(o.Component),ue=Object(l.c)(Object(x.f)(Object(S.a)((function styleSheet(e){return{progress:{margin:"0 ".concat(e.spacing(2),"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},contentContainer:{height:"100%",margin:"auto",display:"grid",gridGap:"24px",gridTemplateRows:"auto 125px 150px 150px auto",gridTemplateColumns:"auto 300px 300px auto",gridAutoFlow:"column"},contentHeader:{gridColumn:"2/4",gridRow:2,marginTop:"auto"},contentHeaderLabel:{fontSize:"96px",color:e.accentColor,lineHeight:"104px",textTransform:"capitalize"},contentAppCard0:{gridColumn:"2/3",gridRow:3,textAlign:"center",padding:"32px"},contentAppCard1:{gridColumn:"3/4",gridRow:3,textAlign:"center",padding:"32px"},contentAppCard2:{gridColumn:"2/3",gridRow:4,textAlign:"center",padding:"32px"},contentAppCard3:{gridColumn:"3/4",gridRow:4,textAlign:"center",padding:"32px"}}}))(pe))),de=function(){function GetUsersService(e,t){Object(v.a)(this,GetUsersService),this.sink=void 0,this.sink=t,e.subscribe(this.getUser.bind(this))}return Object(k.a)(GetUsersService,[{key:"getUser",value:function getUser(e){var t=this,n=$.baseHost.getValue();fetch(n+"/api/v1/auth/user/me",{method:"GET"}).then((function(e){return e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e})).then((function(e){return e.json()})).then((function(e){e.firstName||(e.firstName=e.username),t.sink.next(e)})).catch((function(e){if(401===e.status||403===e.status)window.location="/";else{var n={code:e.status,status:e.statusText,message:e.responseText||e.message};t.sink.error(n)}}))}}]),GetUsersService}(),he=n(139),ge=n.n(he),me=function(){function GetAllUsersService(e,t,n){Object(v.a)(this,GetAllUsersService),this.sink=void 0,this.sink=t,e.subscribe(this.getUsers.bind(this))}return Object(k.a)(GetAllUsersService,[{key:"getUsers",value:function getUsers(){var e,t,n,a;return ge.a.async((function getUsers$(o){for(;;)switch(o.prev=o.next){case 0:return e=$.baseHost.getValue(),t=e+"/api/v1/auth/users",(n=new Headers).append("pragma","no-cache"),n.append("cache-control","no-cache"),o.next=7,ge.a.awrap(fetch(t,{method:"GET",cache:"no-cache",headers:n}).then((function _callee(e){return ge.a.async((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.json());case 1:case"end":return t.stop()}}))})).then((function(e){for(var t=[],n=0;n<e.length;n++){var a=e[n];void 0===a.firstName&&(a.firstName=a.username),t.push(a)}return t.sort((function(e,t){return e.username>t.username?1:e.username<t.username?-1:0}))})).catch((function(e){if(401===e.status||403===e.status)window.location="/";else{var t={code:e.status,status:e.statusText,message:e.responseText||e.message};console.warn(t),setTimeout((function(){fe.getAllUsers.source.next(!0)}),500)}})));case 7:(a=o.sent)&&this.sink.next(a);case 9:case"end":return o.stop()}}),null,this)}}]),GetAllUsersService}(),fe=new function UserActions(){Object(v.a)(this,UserActions),this.getUser={source:new D.Subject,sink:new D.Subject},this.getAllUsers={source:new D.Subject,sink:new D.Subject},this.getUserService=new de(this.getUser.source,this.getUser.sink),this.getAllUsersService=new me(this.getAllUsers.source,this.getAllUsers.sink)},be=function(e){function App(e,t){var n;return Object(v.a)(this,App),(n=Object(w.a)(this,Object(y.a)(App).call(this,e,t))).state={context:t,locale:"en-EN",isMounted:!0,isAuthenticated:!1},n}return Object(C.a)(App,e),Object(k.a)(App,[{key:"componentDidMount",value:function componentDidMount(){var e=this;this.setState({isMounted:!0}),fe.getUser.sink.takeWhile((function(){return e.state.isMounted})).subscribe((function(t){console.dir(t),console.log("UserActions.getUser.sink"),t?e.setState({user:t}):window.location="/index.html"})),fe.getUser.source.next(null)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"render",value:function render(){var e=this,t=this.props.classes;return this.state.user?s.a.createElement(l.a,{locale:"en-EN",key:"en-EN",messages:this.props.i18nMessages["en-EN"]},s.a.createElement(A.a,null,s.a.createElement(x.c,null,s.a.createElement(x.a,{path:"/",component:function component(){return s.a.createElement(ue,{user:e.state.user})}})))):s.a.createElement("div",null,s.a.createElement(O.a,{className:t.progress,size:50}))}}]),App}(o.Component),ve=Object(S.a)((function styleSheet(e){return{progress:{margin:"0 ".concat(e.spacing(2),"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}}))(be);Object(l.b)(n(442));var ke={"en-EN":n(443)},we=Object(p.a)({palette:{type:"light",primary:h.a,secondary:Object(a.a)({},m.a),error:b.a}});!function renderApp(){r.a.render(s.a.createElement(u.a,{theme:we},s.a.createElement(ve,{i18nMessages:ke})),document.getElementById("root"))}(),function register(){if("serviceWorker"in navigator){if(new URL("/home",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/home","/service-worker.js");c?function checkValidServiceWorker(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):registerValidSW(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e):registerValidSW(e)}))}}()}},[[175,1,2]]]);
//# sourceMappingURL=main.1646bc2a.chunk.js.map