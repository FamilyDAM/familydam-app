(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{190:function(e,t){},206:function(e,t,n){e.exports=n(591)},218:function(e,t){},224:function(e,t){},228:function(e,t,n){},590:function(e){e.exports={}},591:function(e,t,n){"use strict";n.r(t);var a=n(204),o=n(1),i=n.n(o),s=n(51),r=n.n(s),l=n(50),c=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function u(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var p=n(47),d=n(203),h=n.n(d),g=n(154),m=n.n(g),f=n(155),b=n.n(f),v=(n(228),n(21)),w=n(36),y=n(60),k=n(56),C=n(61),x=n(595),O=n(597),j=n(594),E=n(139),S=n.n(E),M=n(596),A=n(69),N=n.n(A),T=n(200),L=n.n(T),U=n(78),R=n.n(U),I=n(55),W=n(157),B=n.n(W),P=n(159),z=n.n(P),H=n(138),G=n.n(H),V=n(158),J=n.n(V),D=n(194),F=n.n(D),$=n(193),_=n.n($),q=n(156),K=n.n(q),Q=n(40),X=n(109),Y=n.n(X),Z=function(){function e(t,n){Object(v.a)(this,e),this.sink=void 0,this.sink=n,t.subscribe(this.loadApps.bind(this))}return Object(w.a)(e,[{key:"loadApps",value:function(e){var t=this,n=window.localStorage.getItem("u"),a=window.localStorage.getItem("p");Y.a.get("/api/v1/core/clientapps").withCredentials().set("Accept","application/json").set("Authorization","user "+n+":"+a).end(function(e,n){if(e)if(401===e.status)ee.navigateTo.next("/");else if(403===e.status){var a={code:e.status,message:"Invalid Login (todo: show toast)"};t.sink.error(a)}else{console.dir(e);var o={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(o)}else t.sink.next({primaryApps:n.body.apps.primary,secondaryApps:n.body.apps.secondary})})}}]),e}(),ee=new function e(){Object(v.a)(this,e),this.logout={source:new Q.Subject,sink:new Q.Subject},this.navigateTo=new Q.Subject,this.loadClientApps={source:new Q.BehaviorSubject,sink:new Q.BehaviorSubject},this.loadClientAppsService=new Z(this.loadClientApps.source,this.loadClientApps.sink)},te=function(e){function t(e,n){var a;return Object(v.a)(this,t),(a=Object(y.a)(this,Object(k.a)(t).call(this,e))).handleNavClick=a.handleNavClick.bind(Object(I.a)(a)),a}return Object(C.a)(t,e),Object(w.a)(t,[{key:"handleNavClick",value:function(e){this.props.onNavClick&&this.props.onNavClick(e)}},{key:"handleLogout",value:function(){window.localStorage.clear(),ee.logout.source.next(!0),ee.navigateTo.next("://")}},{key:"findApp",value:function(e,t){if(t){var n=!0,a=!1,o=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var r=i.value;if(r.slug===e)return r}}catch(l){a=!0,o=l}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}}return null}},{key:"render",value:function(){var e=this,t=this.props.classes,n=this.findApp("user_manager",this.props.secondaryApps);return i.a.createElement(R.a,{className:this.props.open?t.sidebarOpen:t.sidebarClosed},i.a.createElement(R.a,{className:this.props.open?t.sidebarUserInfo:t.sidebarUserInfoClosed},i.a.createElement("div",{className:t.sidebarProfileIcon},i.a.createElement(K.a,{style:{width:60,height:60}})),i.a.createElement("div",{className:t.sidebarProfileName},i.a.createElement(N.a,{component:"div",type:"title"},this.props.user.firstName," ",this.props.user.lastName)),i.a.createElement("div",{className:t.sidebarButtons},i.a.createElement(B.a,{onClick:this.handleLogout},"Logout"),n&&i.a.createElement(B.a,{onClick:function(){return ee.navigateTo.next(n.path)}},"Profile"))),i.a.createElement("div",{className:this.props.open?t.appListsOpen:t.appListsClosed},i.a.createElement("div",{style:{gridColumn:"1",gridRow:"1"}},i.a.createElement(N.a,{type:"title",className:this.props.open?t.openLabel:t.closedLabel,style:{paddingLeft:"16px",paddingTop:"16px",gridColumn:"1",gridRow:"1"}},"Apps")),i.a.createElement(G.a,{style:{gridColumn:"1",gridRow:"2"}},this.props.apps&&this.props.apps.map(function(n){return i.a.createElement(J.a,{button:!0,key:n.path,onClick:function(){return e.handleNavClick(n.path)}},i.a.createElement(z.a,null,i.a.createElement(_.a,null)),i.a.createElement(F.a,{primary:n.label,secondary:"",className:e.props.open?t.openLabel:t.closedLabel}))})),i.a.createElement(G.a,{style:{gridColumn:"1",gridRow:"3"},className:this.props.open?t.closedLabel:t.openLabel},i.a.createElement(J.a,{button:!0,onClick:function(){return e.handleNavClick("://app-usermanager/index.html")}},i.a.createElement(z.a,null,i.a.createElement(K.a,{style:{width:48,height:48}}))))))}}]),t}(o.Component),ne=Object(l.c)(Object(p.withStyles)(function(e){return{sidebarOpen:{width:"240px",height:"100vh",background:"#fff"},sidebarClosed:{width:"72px",height:"100vh",background:"#fff"},sidebarUserInfo:{width:"100%",padding:"8px",display:"grid",gridGap:"8px",gridTemplateRows:"auto",gridTemplateColumns:"60px auto"},sidebarUserInfoClosed:{display:"none"},sidebarProfileIcon:{gridColumn:"1",gridRow:"1"},sidebarProfileName:{gridColumn:"2",gridRow:"1",alignSelf:"center"},sidebarButtons:{gridColumn:"1/3",gridRow:"2",justifySelf:"center"},appListsOpen:{display:"grid",gridGap:"0px",gridTemplateRows:"24px auto",gridTemplateColumns:"auto",marginTop:"16px"},appListsClosed:{height:"90%",display:"grid",gridGap:"0px",gridTemplateRows:"0px auto 72px",gridTemplateColumns:"auto"},openLabel:{display:"inline"},closedLabel:{display:"none"}}})(te)),ae=n(195),oe=n.n(ae),ie=n(196),se=n.n(ie),re=n(160),le=n.n(re),ce=n(199),ue=n.n(ce),pe=n(142),de=n.n(pe),he=n(198),ge=n.n(he),me=n(197),fe=n.n(me),be=function(e){function t(e,n){var a;return Object(v.a)(this,t),(a=Object(y.a)(this,Object(k.a)(t).call(this,e))).state={openMoreMenu:!1},a.handleToggle=a.handleToggle.bind(Object(I.a)(a)),a.handleOpenMoreMenu=a.handleOpenMoreMenu.bind(Object(I.a)(a)),a.handleLogout=a.handleLogout.bind(Object(I.a)(a)),a}return Object(C.a)(t,e),Object(w.a)(t,[{key:"handleOpenMoreMenu",value:function(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}},{key:"handleToggle",value:function(){this.props.onToggle&&this.props.onToggle()}},{key:"handleNavClick",value:function(e){this.props.onNavClick&&this.props.onNavClick(e)}},{key:"handleMenuClose",value:function(){this.setState({openMoreMenu:!1})}},{key:"handleLogout",value:function(){window.localStorage.clear(),ee.logout.source.next(!0),ee.navigateTo.next("://")}},{key:"render",value:function(){var e=this,t=this.props.classes;return i.a.createElement(oe.a,{className:t.root,position:"static"},i.a.createElement(se.a,null,i.a.createElement(le.a,{onClick:this.handleToggle,className:t.menuButton,color:"contrast","aria-label":"Menu"},i.a.createElement(fe.a,null)),i.a.createElement(N.a,{type:"title",color:"inherit",className:t.flex,onClick:function(){return e.handleNavClick("://dashboard/index.html")}},"Family ",i.a.createElement("i",null,"D.A.M")),i.a.createElement(le.a,{"aria-label":"More","aria-owns":this.state.open?"long-menu":null,"aria-haspopup":"true",onClick:this.handleOpenMoreMenu,className:t.moreButton},i.a.createElement(ge.a,null)),i.a.createElement(de.a,{id:"long-menu",anchorEl:this.state.openMoreMenuAnchorEl,open:this.state.openMoreMenu},i.a.createElement(pe.MenuItem,{color:"contrast",onClick:function(){e.handleLogout(),e.handleMenuClose()}},"Logout"),i.a.createElement(ue.a,null),this.props.apps&&this.props.apps.map(function(t){return i.a.createElement(pe.MenuItem,{key:t.path,color:"contrast",onClick:function(){e.handleNavClick(t.path),e.handleMenuClose()}},t.label)}))))}}]),t}(o.Component),ve=Object(l.c)(Object(p.withStyles)(function(e){return{root:{width:"100%",height:"64px"},headerContainer:{display:"grid",gridTemplateRows:"auto",gridTemplateColumns:"48px auto 48px"},hamburgerMenu:{display:"block",gridRow:"1",gridColumn:"1"},mainSection:{gridRow:"1",gridColumn:"2"},rightSection:{gridRow:"2",gridColumn:"3",textAlign:"right"},flex:{flex:1},menuButton:{marginLeft:-12,marginRight:20},moreButton:{color:"#fff"}}})(be)),we=function(e){function t(e,n){var a;Object(v.a)(this,t),a=Object(y.a)(this,Object(k.a)(t).call(this,e));var o=window.localStorage.getItem("AppShell.isOpen");return a.state={isMounted:!0,isOpen:o||!0},a.handleOpenCloseToggle=a.handleOpenCloseToggle.bind(Object(I.a)(a)),a.handleOpenMoreMenu=a.handleOpenMoreMenu.bind(Object(I.a)(a)),a}return Object(C.a)(t,e),Object(w.a)(t,[{key:"componentWillMount",value:function(){var e=this;this.setState({isMounted:!0}),ee.navigateTo.takeWhile(function(){return e.state.isMounted}).subscribe(function(e){"://"!==e&&"://"===e.substring(0,3)?window.location.href=e.substring(2):this.props.history&&this.props.history.push(e)}.bind(this)),ee.loadClientApps.sink.subscribe(function(t){t&&e.setState({primaryApps:t.primaryApps,secondaryApps:t.secondaryApps})}),ee.loadClientApps.source.next(!0)}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}},{key:"handleOpenMoreMenu",value:function(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}},{key:"handleOpenCloseToggle",value:function(){var e=!this.state.isOpen;this.setState({isOpen:e}),window.localStorage.setItem("AppShell.isOpen",e)}},{key:"handleLogout",value:function(){window.localStorage.clear(),ee.logout.source.next(!0),ee.navigateTo.next("://")}},{key:"render",value:function(){var e=this.props.classes;if(this.props.user)return i.a.createElement("div",{className:this.state.isOpen?e.dashboardShellContainerOpen:e.dashboardShellContainerClosed},i.a.createElement("header",{className:e.header},i.a.createElement(ve,{apps:this.state.secondaryApps,onToggle:this.handleOpenCloseToggle,onNavClick:function(e){return ee.navigateTo.next(e)}})),i.a.createElement(ne,{user:this.props.user,apps:this.state.primaryApps,secondaryApps:this.state.secondaryApps,open:this.state.isOpen,onNavClick:function(e){return ee.navigateTo.next(e)}}),i.a.createElement("div",{className:e.main},this.props.children));this.handleLogout()}}]),t}(o.Component),ye=Object(l.c)(Object(p.withStyles)(function(e){return{dashboardShellContainerOpen:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"240px auto"},dashboardShellContainerClosed:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"72px auto"},header:{gridColumn:"1/3",gridRow:"1",position:"inherit",height:"64px"},main:{background:"#eee"}}})(we)),ke=function(e){function t(e,n){var a;return Object(v.a)(this,t),(a=Object(y.a)(this,Object(k.a)(t).call(this,e))).state={isMounted:!0},a}return Object(C.a)(t,e),Object(w.a)(t,[{key:"componentWillMount",value:function(){var e=this;this.setState({isMounted:!0}),ee.loadClientApps.sink.takeWhile(function(){return e.state.isMounted}).subscribe(function(t){t&&e.setState({primaryApps:t.primaryApps,secondaryApps:t.secondaryApps})})}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function(e,t){}},{key:"render",value:function(){var e=this.props.classes;return this.state.isLoading?i.a.createElement("div",null,i.a.createElement(S.a,{className:e.progress,size:50})):i.a.createElement(ye,{user:this.props.user,history:this.props.history},i.a.createElement("div",{className:e.contentContainer},i.a.createElement("div",{className:e.contentHeader},i.a.createElement(N.a,{style:{fontSize:"24px",lineHeight:"24px"}},"Where would you like to start?")),this.state.primaryApps&&this.state.primaryApps.filter(function(e){return"home"!==e.slug}).map(function(t,n){return i.a.createElement(R.a,{key:t.path,"data-indx":n,className:e["contentAppCard"+n],onClick:function(){return ee.navigateTo.next(t.path)}},i.a.createElement(L.a,{style:{width:"48px",height:"48px"}}),i.a.createElement(N.a,{style:{fontSize:"24px"}},t.label))})))}}]),t}(o.Component),Ce=Object(l.c)(Object(M.a)(Object(p.withStyles)(function(e){return{progress:{margin:"0 ".concat(2*e.spacing.unit,"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},contentContainer:{height:"100%",margin:"auto",display:"grid",gridGap:"24px",gridTemplateRows:"auto 125px 150px 150px auto",gridTemplateColumns:"auto 300px 300px auto",gridAutoFlow:"column"},contentHeader:{gridColumn:"2/4",gridRow:2,marginTop:"auto"},contentHeaderLabel:{fontSize:"96px",color:e.accentColor,lineHeight:"104px",textTransform:"capitalize"},contentAppCard0:{gridColumn:"2/3",gridRow:3,textAlign:"center",padding:"32px"},contentAppCard1:{gridColumn:"3/4",gridRow:3,textAlign:"center",padding:"32px"},contentAppCard2:{gridColumn:"2/3",gridRow:4,textAlign:"center",padding:"32px"},contentAppCard3:{gridColumn:"3/4",gridRow:4,textAlign:"center",padding:"32px"}}})(ke))),xe=new function e(){Object(v.a)(this,e),this.baseHost=new Q.BehaviorSubject("http://localhost:9000"),this.basicUser=new Q.BehaviorSubject(window.localStorage.getItem("u")),this.basicPwd=new Q.BehaviorSubject(window.localStorage.getItem("p"))},Oe=function(){function e(t,n){Object(v.a)(this,e),this.sink=void 0,this.sink=n,t.subscribe(this.getUser.bind(this))}return Object(w.a)(e,[{key:"getUser",value:function(e){var t=this,n=xe.baseHost.getValue();fetch(n+"/api/v1/auth/user/me",{method:"GET"}).then(function(e){return e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e}).then(function(e){return console.log("getUserService: SUCCESS"),console.dir(e),e}).then(function(e){return e.json()}).then(function(e){return console.log("JSON"),console.log(e),e}).then(function(e){e.firstName||(e.firstName=e.username),t.sink.next(e)}).catch(function(e){if(401===e.status||403===e.status)window.location="/";else{var n={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(n)}})}}]),e}(),je=function(){function e(t,n,a){Object(v.a)(this,e),this.sink=void 0,this.sink=n,t.subscribe(this.getUsers.bind(this))}return Object(w.a)(e,[{key:"getUsers",value:function(){var e=this,t=xe.baseHost.getValue(),n=xe.basicUser.getValue(),a=xe.basicPwd.getValue();Y.a.get(t+"/api/v1/auth/users").withCredentials().set("Accept","application/json").set("Authorization","user "+n+":"+a).end(function(t,n){if(t)if(401===t.status)ee.navigateTo.next("/");else{var a={code:t.status,status:t.statusText,message:t.responseText};e.sink.error(a)}else{for(var o=[],i=0;i<n.body.length;i++){var s=n.body[i];void 0===s.firstName&&(s.firstName=s.username),o.push(s)}var r=o.sort(function(e,t){return e.username>t.username?1:e.username<t.username?-1:0});e.sink.next(r)}})}}]),e}(),Ee=new function e(){Object(v.a)(this,e),this.getUser={source:new Q.Subject,sink:new Q.Subject},this.getAllUsers={source:new Q.Subject,sink:new Q.Subject},this.getUserService=new Oe(this.getUser.source,this.getUser.sink),this.getAllUsersService=new je(this.getAllUsers.source,this.getAllUsers.sink)},Se=function(e){function t(e,n){var a;return Object(v.a)(this,t),(a=Object(y.a)(this,Object(k.a)(t).call(this,e,n))).state={context:n,locale:"en-EN",isMounted:!0,isAuthenticated:!1},a}return Object(C.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({isMounted:!0}),Ee.getUser.sink.takeWhile(function(){return e.state.isMounted}).subscribe(function(t){console.dir(t),console.log("UserActions.getUser.sink"),t?e.setState({user:t}):window.location="/index.html"}),Ee.getUser.source.next(null)}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}},{key:"render",value:function(){var e=this,t=this.props.classes;return this.state.user?i.a.createElement(l.a,{locale:"en-EN",key:"en-EN",messages:this.props.i18nMessages["en-EN"]},i.a.createElement(x.a,null,i.a.createElement(O.a,null,i.a.createElement(j.a,{path:"/",component:function(){return i.a.createElement(Ce,{user:e.state.user})}})))):i.a.createElement("div",null,i.a.createElement(S.a,{className:t.progress,size:50}))}}]),t}(o.Component),Me=Object(p.withStyles)(function(e){return{progress:{margin:"0 ".concat(2*e.spacing.unit,"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}})(Se);Object(l.b)(n(589));var Ae={"en-EN":n(590)},Ne=Object(p.createMuiTheme)({palette:{type:"light",primary:h.a,secondary:Object(a.a)({},m.a),error:b.a}});r.a.render(i.a.createElement(p.MuiThemeProvider,{theme:Ne},i.a.createElement(Me,{i18nMessages:Ae})),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/home",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/home","/service-worker.js");c?function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):u(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e):u(e)})}}()}},[[206,1,2]]]);
//# sourceMappingURL=main.51f600c7.chunk.js.map