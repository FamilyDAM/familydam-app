(this.webpackJsonpfiles=this.webpackJsonpfiles||[]).push([[0],{444:function(e,t,n){},716:function(e,t){},717:function(e,t){},893:function(e){e.exports=JSON.parse("{}")},894:function(e,t,n){"use strict";n.r(t);var a=n(272),i=n(0),r=n.n(i),o=n(24),s=n.n(o),l=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function registerValidSW(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}n(443);var c=n(411),d=n(963),p=n(408),u=n.n(p),h=n(409),g=n.n(h),m=n(410),f=n.n(m),b=(n(444),n(22)),v=n(27),y=n(49),w=n(48),k=n(137),x=n(59),S=n(966),O=n(15),C=n(962),F=(n(445),n(379)),E=n(947),j=n(948),T=n(971),A=n(973),M=n(101),D=n(974),N=n(975),R=n(976),L=n(977),P=n(52),U=n(326),I=n(145),W=n(944),_=n(896),V=n(978),G=n(945),H=n(897),K=n(946),B=n(275),Y=n(378),z=n.n(Y),$=n(309),J=n.n($),q=n(30),Q=new function AppSettings(){Object(b.a)(this,AppSettings),this.baseHost=new q.BehaviorSubject("http://localhost:9000"),this.basicUser=new q.BehaviorSubject(window.localStorage.getItem("u")),this.basicPwd=new q.BehaviorSubject(window.localStorage.getItem("p"))},X=function(){function LogoutService(e,t){Object(b.a)(this,LogoutService),this.sink=void 0,this.sink=t,e.subscribe(this.getUser.bind(this))}return Object(v.a)(LogoutService,[{key:"getUser",value:function getUser(e){var t=this,n=Q.baseHost.getValue();fetch(n+"/logout",{method:"GET"}).then((function(e){return e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e})).catch((function(e){if(401===e.status||403===e.status)window.location="/";else{var n={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(n)}}))}}]),LogoutService}(),Z=new function AppActions(){Object(b.a)(this,AppActions),this.navigateTo=new q.Subject,this.logout={source:new q.Subject,sink:new q.Subject},this.logoutService=new X(this.logout.source,this.logout.sink)},ee=function(e){Object(y.a)(Sidebar,e);var t=Object(w.a)(Sidebar);function Sidebar(){return Object(b.a)(this,Sidebar),t.apply(this,arguments)}return Object(v.a)(Sidebar,[{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.open!==this.props.open||e.user!==this.props.user||e.apps!==this.props.apps||e.secondaryApps!==this.props.secondaryApps}},{key:"handleLogout",value:function handleLogout(){window.localStorage.clear(),Z.logout.source.next(!0),window.location="/index.html"}},{key:"findApp",value:function findApp(e,t){if(t){var n,a=Object(I.a)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.slug===e)return i}}catch(err){a.e(err)}finally{a.f()}}return null}},{key:"render",value:function render(){var e=this,t=this.props.classes,n=this.findApp("usermanager",this.props.secondaryApps);return r.a.createElement(_.a,{className:this.props.open?t.sidebarOpen:t.sidebarClosed},r.a.createElement(_.a,{className:this.props.open?t.sidebarUserInfo:t.sidebarUserInfoClosed},r.a.createElement("div",{className:t.sidebarProfileIcon},r.a.createElement(J.a,{style:{width:60,height:60}})),r.a.createElement("div",{className:t.sidebarProfileName},r.a.createElement(B.a,{component:"div",type:"title"},this.props.user.name," ",this.props.user.lastName)),r.a.createElement("div",{className:t.sidebarButtons},r.a.createElement(W.a,{onClick:this.handleLogout},"Logout"),n&&r.a.createElement(W.a,{onClick:function onClick(){return Z.navigateTo.next(n.path)}},"Profile"))),r.a.createElement("div",{className:this.props.open?t.appListsOpen:t.appListsClosed},r.a.createElement("div",{style:{gridColumn:"1",gridRow:"1"}},r.a.createElement(B.a,{type:"title",className:this.props.open?t.openLabel:t.closedLabel,style:{paddingLeft:"16px",paddingTop:"16px",gridColumn:"1",gridRow:"1"}},"Apps")),r.a.createElement(G.a,{style:{gridColumn:"1",gridRow:"2"}},this.props.apps&&this.props.apps.map((function(n){return r.a.createElement(H.a,{button:!0,key:n.path,onClick:function onClick(){return window.location.href=n.path}},r.a.createElement(V.a,{style:{marginRight:"8px"}},r.a.createElement(z.a,null)),r.a.createElement(K.a,{primary:n.label,primaryTypographyProps:{type:"body2"},className:e.props.open?t.openLabel:t.closedLabel}))}))),r.a.createElement(G.a,{style:{gridColumn:"1",gridRow:"3"},className:this.props.open?t.closedLabel:t.openLabel},r.a.createElement(H.a,{button:!0,onClick:function onClick(){return window.location.href="://app-usermanager/index.html"}},r.a.createElement(V.a,null,r.a.createElement(J.a,{style:{width:48,height:48}}))))))}}]),Sidebar}(i.Component),te=Object(F.b)(Object(O.a)((function styleSheet(e){return{sidebarOpen:{width:"240px",height:"100vh",background:"#fff"},sidebarClosed:{width:"72px",height:"100vh",background:"#fff"},sidebarUserInfo:{width:"100%",padding:"8px",display:"grid",gridGap:"8px",gridTemplateRows:"auto",gridTemplateColumns:"60px auto"},sidebarUserInfoClosed:{display:"none"},sidebarProfileIcon:{gridColumn:"1",gridRow:"1"},sidebarProfileName:{gridColumn:"2",gridRow:"1",alignSelf:"center"},sidebarButtons:{gridColumn:"1/3",gridRow:"2",justifySelf:"center"},appListsOpen:{display:"grid",gridGap:"0px",gridTemplateRows:"24px auto",gridTemplateColumns:"auto",marginTop:"16px"},appListsClosed:{height:"90%",display:"grid",gridGap:"0px",gridTemplateRows:"0px auto 72px",gridTemplateColumns:"auto"},openLabel:{display:"inline"},closedLabel:{display:"none"}}}))(ee)),ne=n(949),ae=n(951),ie=n(415),re=n(950),oe=n(382),se=n.n(oe),le=n(381),ce=n.n(le),de=function(e){Object(y.a)(AppHeader,e);var t=Object(w.a)(AppHeader);function AppHeader(e,n){var a;return Object(b.a)(this,AppHeader),(a=t.call(this,e)).state={openMoreMenu:!1},a.handleToggle=a.handleToggle.bind(Object(P.a)(a)),a.handleOpenMoreMenu=a.handleOpenMoreMenu.bind(Object(P.a)(a)),a.handleLogout=a.handleLogout.bind(Object(P.a)(a)),a}return Object(v.a)(AppHeader,[{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.onToggle!==this.props.onToggle||e.apps!==this.props.apps||t.openMoreMenu!==this.state.openMoreMenu}},{key:"handleOpenMoreMenu",value:function handleOpenMoreMenu(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}},{key:"handleToggle",value:function handleToggle(){this.props.onToggle&&this.props.onToggle()}},{key:"handleNavClick",value:function handleNavClick(e){this.props.onNavClick&&this.props.onNavClick(e)}},{key:"handleMenuClose",value:function handleMenuClose(){this.setState({openMoreMenu:!1})}},{key:"handleLogout",value:function handleLogout(){window.localStorage.clear(),Z.logout.source.next(!0),window.location="/"}},{key:"render",value:function render(){var e=this,t=this.props.classes;return r.a.createElement(E.a,{className:t.root,position:"static"},r.a.createElement(j.a,null,r.a.createElement(ne.a,{onClick:this.handleToggle,className:t.menuButton,color:"secondary","aria-label":"Menu"},r.a.createElement(ce.a,null)),r.a.createElement(B.a,{variant:"h5",color:"inherit",className:t.flex,onClick:function onClick(){return e.handleNavClick("://home/index.html")}},"Family ",r.a.createElement("i",null,"D.A.M")),r.a.createElement(ne.a,{"aria-label":"More","aria-owns":this.state.open?"long-menu":null,"aria-haspopup":"true",onClick:this.handleOpenMoreMenu,className:t.moreButton},r.a.createElement(se.a,null)),r.a.createElement(ie.a,{id:"long-menu",keepMounted:!0,anchorEl:this.state.openMoreMenuAnchorEl,open:this.state.openMoreMenu},r.a.createElement(re.a,{onClick:function onClick(){e.handleLogout(),e.handleMenuClose()}},"Logout"),r.a.createElement(ae.a,null),this.props.apps&&this.props.apps.map((function(t){return r.a.createElement(re.a,{key:t.path,color:"secondary",onClick:function onClick(){e.handleNavClick(t.path),e.handleMenuClose()}},t.label)})))))}}]),AppHeader}(i.Component),pe=Object(F.b)(Object(O.a)((function styleSheet(e){return{root:{width:"100%",height:"64px"},headerContainer:{display:"grid",gridTemplateRows:"auto",gridTemplateColumns:"48px auto 48px"},hamburgerMenu:{display:"block",gridRow:"1",gridColumn:"1"},mainSection:{gridRow:"1",gridColumn:"2"},rightSection:{gridRow:"2",gridColumn:"3",textAlign:"right"},flex:{flex:1},menuButton:{marginLeft:-12,marginRight:20,color:"#ffffff"},moreButton:{color:"#ffffff"}}}))(de)),ue=n(58),he=n.n(ue),ge=n(100),me=new(function(){function LoadClientAppsService(){Object(b.a)(this,LoadClientAppsService),this.isLoading=new q.BehaviorSubject(!1),this.source=new q.Subject,this.sink=new q.Subject,this.source.subscribe(this.loadApps.bind(this))}return Object(v.a)(LoadClientAppsService,[{key:"loadApps",value:function(){var e=Object(ge.a)(he.a.mark((function _callee(e){var t,n,a,i,r,o,s,l,c;return he.a.wrap((function _callee$(e){for(;;)switch(e.prev=e.next){case 0:return t=Q.baseHost.getValue(),n=t+"/api/v1/apps/",(a=new Headers).append("Accept","application/hal+json"),this.isLoading.next(!0),e.next=7,fetch(n,{method:"GET",cache:"no-cache",headers:a,credentials:"include"});case 7:return i=e.sent,e.next=10,i.json();case 10:r=e.sent,200==i.status&&r._embedded&&r._embedded.apps&&(o=[],s=[],r._embedded.apps.forEach((function(e){e.primary?o.push(e):s.push(e)})),l=o.sort((function(e,t){return e.order-t.order})),c=s.sort((function(e,t){return e.order-t.order})),this.sink.next({primaryApps:l,secondaryApps:c}));case 12:case"end":return e.stop()}}),_callee,this)})));return function loadApps(t){return e.apply(this,arguments)}}()}]),LoadClientAppsService}()),fe=function(e){Object(y.a)(AppShell,e);var t=Object(w.a)(AppShell);function AppShell(e,n){var a;Object(b.a)(this,AppShell),a=t.call(this,e);var i=window.localStorage.getItem("AppShell.isOpen");return i||(i=void 0===e.open||e.open),a.state={isMounted:!0,isOpen:Boolean(i)},a.handleOpenCloseToggle=a.handleOpenCloseToggle.bind(Object(P.a)(a)),a.handleOpenMoreMenu=a.handleOpenMoreMenu.bind(Object(P.a)(a)),a}return Object(v.a)(AppShell,[{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.open!==this.props.open||e.user!==this.props.user||e.children!==this.props.children||t.isOpen!==this.state.isOpen||t.primaryApps!==this.state.primaryApps||t.secondaryApps!==this.state.secondaryApps}},{key:"componentDidMount",value:function componentDidMount(){var e=this;this.setState({isMounted:!0}),Z.navigateTo.pipe(Object(U.a)((function(){return e.state.isMounted}))).subscribe(function(e){"://"!==e&&"://"===e.substring(0,3)?window.location.href=e.substring(2):this.props.history&&this.props.history.push(e)}.bind(this)),me.sink.pipe(Object(U.a)((function(){return e.state.isMounted}))).subscribe((function(t){t&&e.setState({primaryApps:t.primaryApps||[],secondaryApps:t.secondaryApps||[]})})),me.source.next(!0)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"handleOpenMoreMenu",value:function handleOpenMoreMenu(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}},{key:"handleOpenCloseToggle",value:function handleOpenCloseToggle(){var e=!this.state.isOpen;this.setState({isOpen:e}),window.localStorage.setItem("AppShell.isOpen",e)}},{key:"handleLogout",value:function handleLogout(){window.localStorage.clear(),Z.logout.source.next(!0),Z.navigateTo.next("://")}},{key:"render",value:function render(){var e=this.props.classes;return this.props.user?r.a.createElement("div",{className:this.state.isOpen?e.dashboardShellContainerOpen:e.dashboardShellContainerClosed},r.a.createElement("header",{className:e.header},r.a.createElement(pe,{apps:this.state.secondaryApps,onToggle:this.handleOpenCloseToggle,onNavClick:function onNavClick(e){return Z.navigateTo.next(e)}})),r.a.createElement(te,{user:this.props.user,apps:this.state.primaryApps,secondaryApps:this.state.secondaryApps,open:this.state.isOpen,onNavClick:function onNavClick(e){return Z.navigateTo.next(e)}}),r.a.createElement("div",{className:e.main},this.props.children)):r.a.createElement("div",null)}}]),AppShell}(i.Component),be=Object(F.b)(Object(x.f)(Object(O.a)((function styleSheet(e){return{dashboardShellContainerOpen:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"240px auto"},dashboardShellContainerClosed:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"72px auto"},header:{gridColumn:"1/3",gridRow:"1",position:"inherit",height:"64px"},main:{fontSize:".5rem",background:"#eee"}}}))(fe))),ve=n(19),ye=n.n(ve),we=n(5),ke=n.n(we),xe=n(383),Se=n.n(xe),Oe=n(384),Ce=n.n(Oe),Fe=function(e){Object(y.a)(FileListTableToolbar,e);var t=Object(w.a)(FileListTableToolbar);function FileListTableToolbar(){return Object(b.a)(this,FileListTableToolbar),t.apply(this,arguments)}return Object(v.a)(FileListTableToolbar,[{key:"render",value:function render(){var e=this,t=this.props,n=t.files,a=t.classes,i=n.length;return r.a.createElement(j.a,{className:ke()(a.root,{[a.highlight]:i>0})},r.a.createElement("div",{className:a.title},n.length>1&&r.a.createElement(B.a,{type:"subheading"},i," selected"),1===n.length&&r.a.createElement(B.a,{type:"title"},n[0].substr(n[0].lastIndexOf("/")+1))),r.a.createElement("div",{className:a.spacer}),r.a.createElement("div",{className:a.actions,style:{width:"100px",marginRight:"8px"}},r.a.createElement(ne.a,{"aria-label":"Delete",onChange:function onChange(e,t){alert("todo")}},r.a.createElement(Se.a,null)),r.a.createElement(ne.a,{"aria-label":"Download",onClick:function onClick(t,a){e.props.handleDownload(n[0].name,n[0].path)}},r.a.createElement(Ce.a,null))))}}]),FileListTableToolbar}(i.Component),Ee=Object(O.a)((function styleSheet(e){return{root:{paddingRight:2},highlight:"light"===e.palette.type?{color:e.palette.secondary.A700,backgroundColor:e.palette.secondary.A100}:{color:e.palette.secondary.A100,backgroundColor:e.palette.secondary.A700},spacer:{flex:"1 1 100%"},actions:{color:e.palette.text.secondary,display:"flex"},title:{flex:"0 0 auto",overflow:"hidden",maxWidth:"250px",overflowWrap:"break-word"}}}))(Fe),je=n(156),Te=n.n(je),Ae=function(){function GetFileDataService(e,t){Object(b.a)(this,GetFileDataService),this.sink=void 0,this.sink=t,e.subscribe(function(e){this.getFiles(e)}.bind(this))}return Object(v.a)(GetFileDataService,[{key:"getFiles",value:function getFiles(e){var t=this,n=Q.baseHost.getValue();if(void 0!==e&&e.length>0){for(var a=[],i=0;i<e.length;i++){var r=e[i],o=Te.a.get(n+r).withCredentials().set("Accept","application/json");a.push(o)}Promise.all(a).then((function(e){for(var n=[],a=0;a<e.length;a++){var i=e[a];n.push(i.body)}t.sink.next(n)})).catch((function(e){console.log(e)}))}}}]),GetFileDataService}();n(694)(Te.a);var Me=function(){function UploadFileService(e,t){var n=this;Object(b.a)(this,UploadFileService),this.sink=void 0,this.sink=t;var a=Q.baseHost.getValue();e.mergeMap((function(e){if(!Array.isArray(e))return n.uploadNextFile(a,e);for(var t=0;t<e.length;t++){var i=e[t];return n.uploadNextFile(a,i)}}),3).subscribe(console.debug)}return Object(v.a)(UploadFileService,[{key:"uploadNextFile",value:function uploadNextFile(e,t){var n=this;return t?q.Observable.of(t).flatMap((function(a){return new Promise((function(a,i){return n.uploadFile(e,t).then((function(e){return a(e)})).catch((function(e){var n=1;return t.retry&&(n=t.retry+1),t.progress=0,t.retry=n,t.error="Retrying request ("+n+"/3)",i(e)}))}))})).retry(2).catch((function(e){return t.error=e.status+": "+e.message,t.progress=0,q.Observable.of(e)})):null}},{key:"uploadFile",value:function uploadFile(e,t){var n=t.uploadPath;t.webkitRelativePath?n+="/"+t.webkitRelativePath.substr(0,t.webkitRelativePath.lastIndexOf("/")):t.relativePath&&(n+=t.relativePath.substr(0,t.relativePath.lastIndexOf("/")));var a=new FormData;return a.append("name",t.name),a.append("path",n),a.append("destination",n),a.append("file",t),a.append("type",t.type),a.append("size",t.size),a.append("jcr:primaryType","nt:file"),a.append("dam:date.created",t.lastModified),a.append("dam:date.modified",t.lastModified),Te.a.post(e+n).withCredentials().charset("UTF-8").send(a).parse((function(e){var t=e.text;return 0===t.length?{}:JSON.parse(t)})).on("progress",(function(e){t.progress=e.percent,Le.uploadProgress.next(t)}))}}]),UploadFileService}(),De=function(){function DeleteFileOrFolderService(e,t){Object(b.a)(this,DeleteFileOrFolderService),this.sink=void 0,this.sink=t,e.subscribe(function(e){this.deleteFileOrFolder(e)}.bind(this))}return Object(v.a)(DeleteFileOrFolderService,[{key:"deleteFileOrFolder",value:function deleteFileOrFolder(e){var t=this,n=Q.baseHost.getValue();if(void 0!==e&&e.length>0){var a=n+e;Te.a.delete(a).withCredentials().set("Accept","application/json").end((function(e,n){if(e)if(401===e.status)Z.navigateTo.next("/");else if(403===e.status)Z.alert.next("You do not have permission to access these files");else{var a={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(a)}else t.sink.next(!0)}))}}}]),DeleteFileOrFolderService}(),Ne=function(){function CreateFolderService(e,t){Object(b.a)(this,CreateFolderService),this.sink=void 0,this.sink=t,e.subscribe(this.createDirectory.bind(this))}return Object(v.a)(CreateFolderService,[{key:"createDirectory",value:function createDirectory(e){var t=this,n=Q.baseHost.getValue(),a=e.name,i=n+e.path+"/"+a,r=new FormData;r.append("name",e.username),r.append("jcr:primaryType","nt:folder"),fetch(i,{method:"POST",body:r}).then((function(e){console.info("CreateFolder success handler"),e.redirected&&(console.debug("redirect to: "+e.url),window.location=e.url),t.sink.next(!0)})).then((function(e){return e.json()})).then((function(e){e.firstName||(e.firstName=e.username),t.sink.next(e)})).catch((function(e){if(console.warn(e),401===e.status)Z.navigateTo.next("/");else if(403===e.status)Z.alert.next("You do not have permission to add a new user");else{console.error(e);var n={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(n)}}))}}]),CreateFolderService}(),Re=function(){function SetFilePropertyService(e,t){Object(b.a)(this,SetFilePropertyService),this.sink=void 0,this.sink=t,e.subscribe(function(e){this.execute(e)}.bind(this))}return Object(v.a)(SetFilePropertyService,[{key:"execute",value:function execute(e){var t=this,n=Q.baseHost.getValue(),a=new FormData;for(var i in e)"path"!==i&&a.append(i,e[i]);fetch(n+e.path,{method:"PUT",body:a}).then((function(e){return e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e})).then((function(e){return e.json()})).then((function(e){t.sink.next(e)})).catch((function(e){if(401===e.status||403===e.status)window.location="/";else{var n={code:e.status,status:e.statusText,message:e.responseText||e.message};t.sink.error(n)}}))}}]),SetFilePropertyService}(),Le=new function FileActions(){Object(b.a)(this,FileActions),this.getFileData={source:new q.Subject,sink:new q.Subject},this.setFileProperty={source:new q.Subject,sink:new q.Subject},this.uploadFile={source:new q.Subject,sink:new q.Subject},this.deleteFileOrFolder={source:new q.Subject,sink:new q.Subject},this.createFolder={source:new q.Subject,sink:new q.Subject},this.stageAction=new q.Subject,this.stageFile=new q.Subject,this.uploadProgress=new q.Subject,this.uploadCompleted=new q.Subject,this.uploadError=new q.Subject,this.getFileDataService=new Ae(this.getFileData.source,this.getFileData.sink),this.setFilePropertyService=new Re(this.setFileProperty.source,this.setFileProperty.sink),this.uploadFileService=new Me(this.uploadFile.source,this.uploadFile.sink),this.deleteFileOrFolderService=new De(this.deleteFileOrFolder.source,this.deleteFileOrFolder.sink),this.createFolderService=new Ne(this.createFolder.source,this.createFolder.sink)},Pe=n(979),Ue=n(980),Ie=n(965),We=n(968),_e=n(952),Ve=n(953),Ge=n(954),He=n(955),Ke=n(956),Be=n(261),Ye=n.n(Be),ze=function(e){Object(y.a)(SingleImageView,e);var t=Object(w.a)(SingleImageView);function SingleImageView(e,n){var a;return Object(b.a)(this,SingleImageView),(a=t.call(this,e,n)).state={keyword:"",tabIndex:a.props.tabIndex?a.props.tabIndex:0},a.handleTabChange=a.handleTabChange.bind(Object(P.a)(a)),a.handleAddKeywordChange=a.handleAddKeywordChange.bind(Object(P.a)(a)),a.handleAddKeywordClick=a.handleAddKeywordClick.bind(Object(P.a)(a)),a.handleKeywordDelete=a.handleKeywordDelete.bind(Object(P.a)(a)),a}return Object(v.a)(SingleImageView,[{key:"handleAddKeywordChange",value:function handleAddKeywordChange(e){this.setState({keyword:e.target.value})}},{key:"handleAddKeywordClick",value:function handleAddKeywordClick(e,t){var n,a=this.props.node["dam:tags"],i=this.state.keyword.split(","),r=Object(I.a)(i);try{for(r.s();!(n=r.n()).done;){var o=n.value;a.push(o)}}catch(err){r.e(err)}finally{r.f()}this.props.handleTagChange(a),this.setState({keyword:""})}},{key:"handleKeywordDelete",value:function handleKeywordDelete(e){for(var t=[],n=this.props.node["dam:tags"],a=0;a<n.length;a++)n[a]!==e&&t.push(n[a]);this.props.handleTagChange(t),this.props.node["dam:tags"]=t}},{key:"handleTabChange",value:function handleTabChange(e,t){this.setState({tabIndex:t})}},{key:"render",value:function render(){var e=this,t=this.props.classes;return r.a.createElement("div",{className:t.gridListRoot},r.a.createElement("div",{className:t.itemPreview},r.a.createElement("div",{style:{height:"100%",maxWidth:"100%",textAlign:"center"}},r.a.createElement("img",{src:Q.baseHost.getValue()+this.props.node.path,alt:this.props.node.path,style:{maxHeight:"100%",maxWidth:"100%",alignSelf:"center"}}))),r.a.createElement("div",{className:t.itemRating},r.a.createElement(Pe.a,{name:"img-ratings",value:this.props.node["dam:rating"],onChange:this.props.handleRatingChange,style:{float:"right"}})),r.a.createElement("div",{className:t.itemKeywords},r.a.createElement(B.a,{variant:"h6"},"Keywords:"),r.a.createElement("div",null,this.props.node["dam:tags"]&&this.props.node["dam:tags"].map((function(t){return r.a.createElement(Ue.a,{size:"small",label:t,onDelete:function onDelete(){return e.handleKeywordDelete(t)}})}))),r.a.createElement("div",null,r.a.createElement(Ie.a,{id:"addKeyword",ref:"addKeywordField",label:"Add Keyword",margin:"normal",value:this.state.keyword,style:{width:"75%"},onChange:this.handleAddKeywordChange}),r.a.createElement(W.a,{color:"primary",style:{verticalAlign:"bottom"},disabled:0==this.state.keyword.length,onClick:this.handleAddKeywordClick},"Add"))),r.a.createElement("div",{className:t.itemInfo},r.a.createElement("hr",{style:{width:"100%"}}),r.a.createElement(We.a,{value:"Details",indicatorColor:"primary",textColor:"primary",variant:"fullWidth",onChange:this.props.handleTabChange},r.a.createElement(_e.a,{label:"Details"}),r.a.createElement(_e.a,{label:"Versions"})),0===this.state.tabIndex&&r.a.createElement("div",null,r.a.createElement(Ve.a,null,r.a.createElement(Ge.a,null,r.a.createElement(He.a,{style:{padding:"8px"}},r.a.createElement(Ke.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Type"),r.a.createElement(Ke.a,{align:"left"},this.props.node["jcr:content"]["jcr:mimeType"])),r.a.createElement(He.a,null,r.a.createElement(Ke.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Resolution"),r.a.createElement(Ke.a,{align:"left"},this.props.node.width," x ",this.props.node.height)),r.a.createElement(He.a,null,r.a.createElement(Ke.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Created"),r.a.createElement(Ke.a,{align:"left"},Ye()(this.props.node["dam:date.created"]).format("MMM Do YYYY, h:mm:ss a"))),r.a.createElement(He.a,null,r.a.createElement(Ke.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Modified"),r.a.createElement(Ke.a,{align:"left"},Ye()(this.props.node["jcr:lastModified"]).format("MMM Do YYYY, h:mm:ss a")))))),1===this.state.tabIndex&&r.a.createElement("div",null,"Versions Panel")))}}]),SingleImageView}(i.Component),$e=Object(O.a)((function styleSheet(e){return{gridListRoot:{margin:"24px",display:"grid",gridGap:"8px",gridTemplateRows:"175px 25px 50px 3fr",gridTemplateColumns:"16px auto 16px",background:e.palette.background.paper,justifyContent:"center"},itemPreview:{gridRow:"1",gridColumn:"2",justifyContent:"center"},itemRating:{gridRow:"2",gridColumn:"2"},itemKeywords:{gridRow:"3/5",gridColumn:"2"},itemInfo:{gridRow:"5",gridColumn:"2"}}}))(ze),Je=n(957),qe=n(958),Qe=function(e){Object(y.a)(MultiImageView,e);var t=Object(w.a)(MultiImageView);function MultiImageView(e,n){var a;return Object(b.a)(this,MultiImageView),(a=t.call(this,e,n)).state={},a}return Object(v.a)(MultiImageView,[{key:"render",value:function render(){var e=this.props.classes;return r.a.createElement("div",{className:e.gridListRoot},r.a.createElement("div",{className:e.itemPreview},r.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden"}},r.a.createElement(Je.a,{cellHeight:160,style:{width:"100%",height:"100%"},cols:3},this.props.nodes.map((function(e){return r.a.createElement(qe.a,{key:e.path,cols:e.cols||1},r.a.createElement("img",{src:Q.baseHost.getValue()+e.path,alt:e["jcr:path"],style:{height:"100%",maxWidth:"100%",alignSelf:"center"}}))}))))))}}]),MultiImageView}(i.Component),Xe=Object(O.a)((function styleSheet(e){return{gridListRoot:{margin:"24px",display:"grid",gridGap:"8px",gridTemplateRows:"175px 25px 50px 3fr",gridTemplateColumns:"16px auto 16px",background:e.palette.background.paper,justifyContent:"center"},itemPreview:{gridRow:"1",gridColumn:"2",justifyContent:"center"}}}))(Qe),Ze=function(e){Object(y.a)(FileInfoSidebar,e);var t=Object(w.a)(FileInfoSidebar);function FileInfoSidebar(e,n){var a;return Object(b.a)(this,FileInfoSidebar),(a=t.call(this,e)).state={fileNodes:[],isMounted:!0,tabIndex:0},a}return Object(v.a)(FileInfoSidebar,[{key:"componentDidMount",value:function componentDidMount(){var e=this;this.setState({isMounted:!0,fileActions:Le}),this.handleRatingChange=this.handleRatingChange.bind(this),this.handleTagChange=this.handleTagChange.bind(this),this.props.fileNodes?this.setState({fileNodes:this.props.fileNodes}):(Le.getFileData.sink.takeWhile((function(){return e.state.isMounted})).subscribe((function(t){console.log(JSON.stringify(t)),e.setState({fileNodes:t})})),Le.getFileData.source.next(this.props.files))}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(e){this.props=e,Le.getFileData.source.next(this.props.files)}},{key:"handleRatingChange",value:function handleRatingChange(e,t){var n=this.state.fileNodes;n[0]["dam:rating"]=t,this.setState({fileNodes:n});var a={path:this.props.files[0],"dam:rating":t};Le.setFileProperty.source.next(a)}},{key:"handleTagChange",value:function handleTagChange(e){var t=e;Array.isArray(e)||(t=e.split(","));var n=this.state.fileNodes;n[0]["dam:tags"]=t,this.setState({fileNodes:n});var a={path:this.props.files[0],"dam:tags":t};this.state.fileActions.setFileProperty.source.next(a)}},{key:"render",value:function render(){this.props.classes;return r.a.createElement(_.a,{style:this.props.style},r.a.createElement(Ee,{onDownload:this.props.handleDownload,files:this.props.files}),1===this.state.fileNodes.length&&this.state.fileNodes[0]["jcr:mixinTypes"].indexOf("dam:image")>-1&&r.a.createElement($e,{node:this.state.fileNodes[0],tabIndex:this.state.tabIndex,handleTabChange:this.handleTabChange,handleRatingChange:this.handleRatingChange,handleTagChange:this.handleTagChange}),this.state.fileNodes.length>1&&r.a.createElement(Xe,{nodes:this.state.fileNodes}))}}]),FileInfoSidebar}(i.Component);FileList.propTypes={files:ye.a.array.isRequired};var et=Object(x.f)(Object(O.a)((function styleSheet(e){return{gridSingleItemInfo:{},title:{color:e.palette.primary[200]},titleBar:{background:"linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 70%, rgba(0,0,0,0) 100%)"}}}))(Ze)),tt=n(385),nt=n.n(tt),at=n(959),it=n(961),rt=n(972),ot=n(960),st=n(386),lt=n.n(st);function SlideTransition(e){return r.a.createElement(at.a,Object.assign({direction:"up"},e))}var ct=function(e){Object(y.a)(UploadDialog,e);var t=Object(w.a)(UploadDialog);function UploadDialog(e,n){var a;return Object(b.a)(this,UploadDialog),(a=t.call(this,e)).state={isMounted:!0,isReceiverOpen:!1,files:[],filter:"all"},a.handleClose=a.handleClose.bind(Object(P.a)(a)),a}return Object(v.a)(UploadDialog,[{key:"componentDidMount",value:function componentDidMount(){var e=this;this.setState({isMounted:!0}),Le.uploadProgress.subscribe((function(t){for(var n=[],a=0;a<e.props.files.length;a++){var i=e.props.files[a];t.id===i.id&&100!==t.progress&&(i.progress=t.progress),n.push(i)}e.setState({files:n})})),Le.uploadError.subscribe((function(t){for(var n=[],a=0;a<e.props.files.length;a++){var i=e.props.files[a];t.id===i.id&&(i.error=t.error),n.push(i)}e.setState({files:n})})),setTimeout((function(){return e.startFileUploads(e.props.files)}),500)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(e){var t=this;this.props=e,setTimeout((function(){return t.startFileUploads(t.props.files)}),1e3)}},{key:"handleClose",value:function handleClose(){this.setState({files:[],filter:"all"}),this.props.onClose&&this.props.onClose()}},{key:"startFileUploads",value:function startFileUploads(e){if(this.props.files.length>0){for(var t=0;t<Math.min(3,this.props.files.length);t++);var n,a=Object(I.a)(this.props.files);try{for(a.s();!(n=a.n()).done;){var i=n.value;"uploadReady"===i.status&&(i.status="uploading",Le.uploadFile.source.next(i))}}catch(err){a.e(err)}finally{a.f()}}}},{key:"render",value:function render(){var e=this,t=this.props.classes,n=this.props.files.filter((function(e){return 100===e.progress})).length,a=n/this.props.files.length*100,i=this.props.files.filter((function(t){return"completed"===e.state.filter?100===t.progress:"uploading"===e.state.filter?t.progress>0&&t.progress<100:"waiting"!==e.state.filter||0===t.progress}));return i.sort((function(e,t){return e.progress<t.progress?1:e.progress>t.progress?-1:0})),r.a.createElement(rt.a,{maxWidth:"lg",fullWidth:!0,open:this.props.open,transition:SlideTransition,classes:{paper:t.dialogPaper}},r.a.createElement(E.a,{className:t.appBar},r.a.createElement(j.a,null,r.a.createElement(B.a,{type:"title",color:"inherit",className:t.flex},"Adding Files"),r.a.createElement(W.a,{onClick:this.handleClose,style:{color:"white"}},"close"))),this.props.files.length>0&&r.a.createElement("div",{style:{position:"absolute",top:"80px",right:"24px",left:"24px"}},r.a.createElement(B.a,{style:{display:"inline"}},n," / ",this.props.files.length),r.a.createElement(ot.a,{variant:"determinate",value:Math.min(a,100)}),r.a.createElement(B.a,null,"Files will be added to: ",r.a.createElement("strong",null,this.props.path))),this.props.files.length>0&&i.length>0&&r.a.createElement("div",{style:{height:"100%",overflow:"scroll",position:"absolute",top:"148px",bottom:"24px",left:"16px",right:"16px"}},r.a.createElement(Ve.a,null,r.a.createElement(it.a,null,r.a.createElement(He.a,null,r.a.createElement(Ke.a,{style:{width:"32px",padding:"0 8px 0 8px"}}),r.a.createElement(Ke.a,{style:{width:"100%",padding:"0 8px 0 8px"}},"Name"),r.a.createElement(Ke.a,{style:{width:"50px",padding:"0 8px 0 8px"},numeric:!0},"Size"),r.a.createElement(Ke.a,{style:{width:"50px",padding:"0 8px 0 8px"},numeric:!0},"Progress"))),r.a.createElement(Ge.a,null,i.map((function(e){return e.progress<100?r.a.createElement(He.a,{key:e.id},r.a.createElement(Ke.a,{style:{padding:"0 8px 0 8px"}},e.progress>0?r.a.createElement(C.a,{size:24}):r.a.createElement(lt.a,{color:"primary"})),r.a.createElement(Ke.a,{style:{padding:"0 8px 0 8px"}},r.a.createElement(B.a,null,e.name),r.a.createElement(B.a,{variant:"caption"},e.relativePath," ",e.error),r.a.createElement(ot.a,{variant:"determinate",value:e.progress,style:{height:"4px"}})),r.a.createElement(Ke.a,{style:{padding:"0 8px 0 8px"},numeric:!0},nt()(e.size,{base:10})),r.a.createElement(Ke.a,{style:{padding:"0 8px 0 8px"},numeric:!0},Math.round(e.progress),"%")):""}))))))}}]),UploadDialog}(i.Component),dt=Object(O.a)((function styleSheet(e){return{appBar:{position:"relative"},flex:{flex:1},dialogPaper:{minHeight:"90%"}}}))(ct),pt=n(967),ut=new(function(){function GetFilesAndFoldersService(){Object(b.a)(this,GetFilesAndFoldersService),this.isLoading=new q.BehaviorSubject(!1),this.sink=new q.Subject,this.source=new q.Subject,this.source.subscribe(function(e){this.getFilesAndFolders(e)}.bind(this))}return Object(v.a)(GetFilesAndFoldersService,[{key:"getFilesAndFolders",value:function(){var e=Object(ge.a)(he.a.mark((function _callee(e){var t,n,a,i,r,o,s;return he.a.wrap((function _callee$(l){for(;;)switch(l.prev=l.next){case 0:return t=Q.baseHost.getValue(),n=t+"/content/",e&&e.length>1&&(n=t+e),(a=new Headers).append("Accept","application/hal+json"),this.isLoading.next(!0),l.next=8,fetch(n,{method:"GET",cache:"no-cache",headers:a,credentials:"include"});case 8:return i=l.sent,l.next=11,i.json();case 11:r=l.sent,200==i.status?(o=r._embedded.nodes.filter((function(e){return!e.name.startsWith(".")})),this.sink.next(o),this.isLoading.next(!1)):(console.dir(err),s={code:err.status,status:err.statusText,message:err.responseText},this.sink.error(s),this.isLoading.next(!1));case 13:case"end":return l.stop()}}),_callee,this)})));return function getFilesAndFolders(t){return e.apply(this,arguments)}}()},{key:"getFilesAndFoldersOld",value:function getFilesAndFoldersOld(e){var t=this,n=Q.baseHost.getValue();if(void 0!==e&&e.length>0){var a=n+e;request.get(a).withCredentials().set("Accept","application/json").end((function(e,n){if(e)if(401===e.status)Z.navigateTo.next("/");else if(403===e.status)Z.alert.next("You do not have permission to access these files");else{var a={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(a)}else{var i=[];n.body&&(i=n.body.filter((function(e){return!e.name.toString().startsWith(".")}))),t.sink.next(i)}}))}}}]),GetFilesAndFoldersService}()),ht=function(e){Object(y.a)(NewFolderDialog,e);var t=Object(w.a)(NewFolderDialog);function NewFolderDialog(e,n){var a;return Object(b.a)(this,NewFolderDialog),(a=t.call(this,e)).showModal=function(){a.setState({open:!0})},a.hideModal=function(){a.setState({open:!1})},a.state={folderName:"",open:!1},a.handleSave=a.handleSave.bind(Object(P.a)(a)),a}return Object(v.a)(NewFolderDialog,[{key:"componentDidMount",value:function componentDidMount(){this.setState({isMounted:!0})}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(e){this.props=e,this.setState({open:e.open})}},{key:"handleSave",value:function handleSave(){this.props.handleSave&&this.state.folderName.length>0&&this.props.handleSave(this.state.folderName)}},{key:"render",value:function render(){var e=this;return r.a.createElement(pt.a,{visible:this.state.open,onCancel:this.hideModal,onOk:this.handleSave,okText:"Create",cancelText:"Cancel",title:"New Folder"},r.a.createElement(Ie.a,{id:"newFolderName",label:"Folder Name",value:this.state.folderName,onChange:function onChange(t){return e.setState({folderName:t.target.value})},margin:"dense"}))}}]),NewFolderDialog}(i.Component),gt=Object(O.a)((function styleSheet(e){return{}}))(ht),mt=n(392),ft=n(969),bt=function FileScanner(){Object(b.a)(this,FileScanner),this.processFile=function(){var e=Object(ge.a)(he.a.mark((function _callee(e,t,n){return he.a.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:e.id||(e.id=Object(ft.a)()),e.progress=0,e.status="uploadReady",e.uploadPath=t,e.uploadProgress=30,n&&(e.relativePath=n),console.debug("FILE:"+e.uploadPath),Le.stageFile.next(e);case 8:case"end":return a.stop()}}),_callee)})));return function(t,n,a){return e.apply(this,arguments)}}(),this.readDir=function(){var e=Object(ge.a)(he.a.mark((function _callee4(e,t,n){var a;return he.a.wrap((function _callee4$(i){for(;;)switch(i.prev=i.next){case 0:a=this,e.createReader().readEntries(function(){var e=Object(ge.a)(he.a.mark((function _callee3(e){var i,r,o;return he.a.wrap((function _callee3$(s){for(;;)switch(s.prev=s.next){case 0:i=he.a.mark((function _loop(i){var r;return he.a.wrap((function _loop$(s){for(;;)switch(s.prev=s.next){case 0:if(o=e[i],r=o.fullPath,!o.isFile){s.next=6;break}o.file(function(){var e=Object(ge.a)(he.a.mark((function _callee2(e){return he.a.wrap((function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.processFile(e,n,r);case 2:case"end":return t.stop()}}),_callee2)})));return function(t){return e.apply(this,arguments)}}()),s.next=10;break;case 6:if(!o.isDirectory){s.next=10;break}return console.debug("DIR:"+o.fullPath),s.next=10,a.readDir(o,t,n);case 10:case"end":return s.stop()}}),_loop)})),r=0;case 2:if(!(r<e.length)){s.next=7;break}return s.delegateYield(i(r),"t0",4);case 4:r++,s.next=2;break;case 7:case"end":return s.stop()}}),_callee3)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return i.stop()}}),_callee4,this)})));return function(t,n,a){return e.apply(this,arguments)}}(),this.scanFiles=function(){var e=Object(ge.a)(he.a.mark((function _callee5(e,t,n){var a,i,r,o,s,l,c,d,p,u;return he.a.wrap((function _callee5$(h){for(;;)switch(h.prev=h.next){case 0:if(Le.stageAction.next("open"),!e.dataTransfer){h.next=22;break}a=e.dataTransfer.items,i=0;case 4:if(!(i<a.length)){h.next=20;break}if(r=t,o=a[i],s=o.getAsFile(),!(l=o.webkitGetAsEntry()).isFile){h.next=14;break}return h.next=12,this.processFile(s,r);case 12:h.next=17;break;case 14:if(!l.isDirectory){h.next=17;break}return h.next=17,this.readDir(l,s,r);case 17:i++,h.next=4;break;case 20:h.next=23;break;case 22:if(n){c=t,d=Object(I.a)(n);try{for(d.s();!(p=d.n()).done;)u=p.value,this.processFile(u,c)}catch(err){d.e(err)}finally{d.f()}}case 23:case"end":return h.stop()}}),_callee5,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},vt=function(e){Object(y.a)(FileReceiver,e);var t=Object(w.a)(FileReceiver);function FileReceiver(e,n){var a;return Object(b.a)(this,FileReceiver),(a=t.call(this,e)).state={isMounted:!0},a.handleOnDragEnter=a.handleOnDragEnter.bind(Object(P.a)(a)),a.handleOnDragOver=a.handleOnDragOver.bind(Object(P.a)(a)),a.handleOnDragLeave=a.handleOnDragLeave.bind(Object(P.a)(a)),a.handleAddFile=a.handleAddFile.bind(Object(P.a)(a)),a}return Object(v.a)(FileReceiver,[{key:"componentDidMount",value:function componentDidMount(){this.setState({isMounted:!0})}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(e){this.props=e}},{key:"handleOnDragEnter",value:function handleOnDragEnter(e){this.setState({isReceiverOpen:!0})}},{key:"handleOnDragOver",value:function handleOnDragOver(e){this.state.isReceiverOpen&&this.setState({isReceiverOpen:!0})}},{key:"handleOnDragLeave",value:function handleOnDragLeave(e){this.setState({isReceiverOpen:!1})}},{key:"handleAddFile",value:function handleAddFile(e,t){(new bt).scanFiles(e,this.props.path,t)}},{key:"render",value:function render(){return r.a.createElement(mt.Receiver,{onDragEnter:this.handleOnDragEnter,onDragOver:this.handleOnDragOver,onDragLeave:this.handleOnDragLeave,onFileDrop:this.handleAddFile})}}]),FileReceiver}(i.Component),yt=n(964),wt=function(e){Object(y.a)(TableView,e);var t=Object(w.a)(TableView);function TableView(e){var n;return Object(b.a)(this,TableView),(n=t.call(this,e)).state={isMounted:!0,folders:[],files:[]},n.handleRowClick=n.handleRowClick.bind(Object(P.a)(n)),n}return Object(v.a)(TableView,[{key:"handleRowClick",value:function handleRowClick(e){var t=e.currentTarget.attributes["data-id"].value;this.props.onRowClick(t)}},{key:"onTableChangeHandler",value:function onTableChangeHandler(e,t,n,a){console.log("onTableChange")}},{key:"getColumns",value:function getColumns(){return[{title:"type",dataIndex:"type",width:80,render:function render(e,t){return r.a.createElement("span",null,t.primaryType)}},{title:"Name",dataIndex:"name",key:"name",render:function render(e,t){return r.a.createElement(k.b,{to:t.path},e)}},{title:"Action",key:"action",width:200,render:function render(e,t){return r.a.createElement(A.b,{size:"middle"},r.a.createElement("a",null,"Info"),r.a.createElement("a",null,"Delete"))}}]}},{key:"getRowSelection",value:function getRowSelection(){return{onChange:function onChange(e,t){console.log("selectedRowKeys: ".concat(e),"selectedRows: ",t)},getCheckboxProps:function getCheckboxProps(e){return{disabled:"application/folder"===e.contentType,name:e.name}}}}},{key:"render",value:function render(){this.props.classes;var e=[];e=(e=e.concat(this.props.folders)).concat(this.props.files);var t=this.getRowSelection();return r.a.createElement(yt.a,{rowKey:"path",loading:this.props.loading,columns:this.getColumns(),dataSource:e,size:"small",pagination:{hideOnSinglePage:!1},rowSelection:Object(a.a)({type:"checkbox"},t),onChange:this.onTableChangeHandler})}}]),TableView}(i.Component),kt=Object(x.f)(wt),xt=new(function(){function CreateFolderService(e,t){Object(b.a)(this,CreateFolderService),this.sink=new q.Subject,this.source=new q.Subject,this.isLoading=new q.BehaviorSubject,this.source.subscribe(function(e){this.createDirectory(e)}.bind(this))}return Object(v.a)(CreateFolderService,[{key:"createDirectory",value:function(){var e=Object(ge.a)(he.a.mark((function _callee(e){var t,n,a,i,r,o,s;return he.a.wrap((function _callee$(e){for(;;)switch(e.prev=e.next){case 0:return t=Q.baseHost.getValue(),n=data_.name,a=t+data_.path+"/"+n,(i=new FormData).append("name",data_.username),i.append("contentType","application/folder"),e.next=8,fetch(a,{method:"POST",body:i});case 8:return r=e.sent,e.next=11,r.json();case 11:o=e.sent,200==apps.status?(this.sink.next(o),this.isLoading.next(!1)):(console.dir(err),s={code:err.status,status:err.statusText,message:err.responseText},this.sink.error(s),this.isLoading.next(!1));case 13:case"end":return e.stop()}}),_callee,this)})));return function createDirectory(t){return e.apply(this,arguments)}}()}]),CreateFolderService}()),St=function(e){Object(y.a)(FilesPage,e);var t=Object(w.a)(FilesPage);function FilesPage(e,n){var a;return Object(b.a)(this,FilesPage),(a=t.call(this,e)).state={isLoading:!0,isMounted:!0,canAddFile:!0,canAddFolder:!0,showAddFolderDialog:!1,showUploadSidebar:!1,showNewFolderDialog:!1,showUploadDialog:!1,selectedFiles:[],uploadFiles:[],root:"/",visibleRoot:"/",path:"/",folders:[],files:[]},a}return Object(v.a)(FilesPage,[{key:"componentDidMount",value:function componentDidMount(){var e=this;this.setState({isMounted:!0}),ut.isLoading.takeWhile((function(){return e.state.isMounted})).subscribe((function(t){e.setState({isLoading:t})})),xt.isLoading.takeWhile((function(){return e.state.isMounted})).subscribe((function(t){e.setState({isLoading:t})})),ut.sink.takeWhile((function(){return e.state.isMounted})).subscribe((function(t){var n=[],a=[];t._embedded&&(n=t._embedded.folders||[]),t._embedded&&(a=t._embedded.files||[]),e.setState({folder:t,folders:n,files:a})})),ut.source.next(this.props.location.pathname)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(e){this.props.location.pathname!==e.location.pathname&&ut.source.next(e.location.pathname),this.props=e}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t,n){return this.props.location.pathname!=e.location.pathname||this.state.folders!=t.folders||this.state.files!=t.files||this.state.showNewFolderDialog!=t.showNewFolderDialog||this.state.isLoading!=t.isLoading}},{key:"handleCreateFolder",value:function handleCreateFolder(e){var t=this.state.folder.id||null;xt.sink.subscribe(function(e){console.log(e)}.bind(this)),xt.source.next({parentId:t,name:e})}},{key:"render",value:function render(){var e=this,t=this.props.classes,n=this.state.showUploadSidebar||this.state.uploadFiles.length>0||this.state.selectedFiles.length>0;return r.a.createElement(be,{user:this.props.user,open:!1},r.a.createElement("div",{className:t.fileGrid},r.a.createElement(E.a,{color:"default",position:"static",elevation:0,className:t.fileGridAppBar},r.a.createElement(j.a,{className:t.toolbarContainer},r.a.createElement(B.a,{variant:"h6",className:t.title},r.a.createElement(T.a,null,r.a.createElement(T.a.Item,{href:"/"},r.a.createElement(D.a,null)),r.a.createElement(T.a.Item,{href:"/files"},r.a.createElement(N.a,null),r.a.createElement("span",null,"Files")),r.a.createElement(T.a.Item,null,this.props.path))),r.a.createElement(A.b,null,r.a.createElement(M.a,{type:"primary",disabled:!this.state.canAddFile,onClick:this.handleFileSelect,icon:r.a.createElement(R.a,null)},"Add Files"),r.a.createElement(M.a,{type:"primary",disabled:!this.state.canAddFolder,onClick:function onClick(){e.setState({showNewFolderDialog:!0})},icon:r.a.createElement(L.a,null)},"New Folder")))),r.a.createElement("div",{className:t.fileGridFileList,style:{gridColumn:n?"1/2":"1/3"}},r.a.createElement(vt,{path:this.state.path,onFileDrop:this.handleOnFileDrop}),r.a.createElement(kt,{loading:this.state.isLoading,folders:this.state.folders,files:this.state.files,onRowClick:this.handleOnRowClick})),r.a.createElement(et,{files:this.state.selectedFiles,className:t.fileGridSidebar,onDelete:this.handleAfterOnDelete,onDownload:this.handleFileDownload,style:{display:this.state.selectedFiles.length>0?"block":"none"}}),r.a.createElement(dt,{onClose:this.handleUploadClosed,open:this.state.showUploadDialog,files:this.state.uploadFiles,path:this.state.path}),r.a.createElement(gt,{onSave:this.handleCreateFolder,onClose:function onClose(){e.setState({showNewFolderDialog:!1})},open:this.state.showNewFolderDialog,path:this.state.path})),r.a.createElement("input",{type:"file",ref:"fileInputField",multiple:!0,style:{display:"none"},onChange:this.handleFileChange}))}}]),FilesPage}(i.Component),Ot=Object(F.b)(Object(x.f)(Object(O.a)((function styleSheet(e){return{progress:{margin:"0 ".concat(2*e.spacing(),"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},toolbarContainer:{},fileGrid:{height:"100%",display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"4fr minmax(2px, 400px)"},fileGridAppBar:{gridRow:"1",gridColumn:"1/3",zIndex:500,colorDefault:"#eeeeee"},fileGridFileList:{gridRow:"2",gridColumn:"1",margin:"24px"},fileGridSidebar:{gridRow:"2",gridColumn:"2",margin:"24px"},filePondSidebar:{gridRow:"2",gridColumn:"2",margin:"24px"},mainGrid:{height:"100%",overflow:"scroll",display:"grid",gridGap:"16px",gridTemplateRows:"1fr 1fr 1fr",gridTemplateColumns:"2fr 6fr"},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}))(St))),Ct=new(function(){function GetUsersService(){Object(b.a)(this,GetUsersService),this.isLoading=new q.BehaviorSubject(!1),this.source=new q.Subject,this.sink=new q.Subject,this.source.subscribe(this.getUser.bind(this))}return Object(v.a)(GetUsersService,[{key:"getUser",value:function getUser(e){var t=this,n=Q.baseHost.getValue()+"/api/v1/auth/user/me",a=new Headers;a.append("pragma","no-cache"),a.append("cache-control","no-cache"),a.append("accept","application/json"),this.isLoading.next(!0),fetch(n,{method:"GET",mode:"cors",headers:a,credentials:"include"}).then((function(e){return e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e})).then((function(e){return e.json()})).then((function(e){t.sink.next(e)})).catch((function(e){if(401===e.status||403===e.status)window.location="/";else{console.error(e.statusText);var n={code:e.status,status:e.statusText,message:e.responseText||e.message};t.sink.error(n)}}))}}]),GetUsersService}()),Ft=function(e){Object(y.a)(App,e);var t=Object(w.a)(App);function App(e,n){var a;return Object(b.a)(this,App),(a=t.call(this,e,n)).state={context:n,locale:"en-EN",isAuthenticated:!1,isLoading:!0,isMounted:!1},window.location.href.indexOf(":3000"),a}return Object(v.a)(App,[{key:"componentDidMount",value:function componentDidMount(){var e=this;this.setState({isMounted:!0}),Ct.sink.takeWhile((function(){return e.state.isMounted})).subscribe((function(t){t&&e.setState({isAuthenticated:!0,isLoading:!1,user:t})})),Ct.source.next(null)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"render",value:function render(){var e=this,t=this.props.classes,n="en-EN";return this.state.isLoading?r.a.createElement("div",null,r.a.createElement(C.a,{className:t.progress,size:50})):r.a.createElement(S.a,{locale:n,key:n,messages:this.props.i18nMessages[n]},r.a.createElement(k.a,null,r.a.createElement(x.c,null,r.a.createElement(x.a,{path:"/",component:function component(){return r.a.createElement(Ot,{user:e.state.user})}}))))}}]),App}(i.Component),Et=Object(O.a)((function styleSheet(e){return{progress:{margin:"0 ".concat(2*e.spacing(),"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}}))(Ft),jt={"en-EN":n(893)},Tt=Object(c.a)({palette:{type:"light",primary:u.a,secondary:Object(a.a)({},g.a),error:f.a}});!function renderApp(){s.a.render(r.a.createElement(d.a,{theme:Tt},r.a.createElement(Et,{i18nMessages:jt})),document.getElementById("root"))}(),function register(){if("serviceWorker"in navigator){if(new URL("/files",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/files","/service-worker.js");l?function checkValidServiceWorker(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):registerValidSW(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e):registerValidSW(e)}))}}()}},[[894,1,2]]]);
//# sourceMappingURL=main.39c19846.chunk.js.map