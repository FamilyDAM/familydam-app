(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1008:function(e){e.exports={}},1009:function(e,t,a){"use strict";a.r(t);var n=a(233),i=a(0),l=a.n(i),r=a(50),s=a.n(r),o=a(55),c=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function d(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var u=a(27),h=a(412),p=a.n(h),g=a(288),m=a.n(g),f=a(289),b=a.n(f),v=(a(436),a(14)),y=a(19),w=a(38),k=a(37),C=a(39),E=a(179),x=a(109),O=a(108),j=a.n(O),F=a(23),S=a(163),D=a.n(S),N=a(40),A=a.n(N),T=a(107),R=a.n(T),M=a(106),P=a.n(M),L=a(411),I=a.n(L),W=a(291),B=a.n(W),U=a(42),V=a.n(U),H=a(79),K=a.n(H),z=a(292),G=a.n(z),J=a(237),q=a.n(J),Y=a(238),Q=a.n(Y),_=a(388),X=a.n(_),$=a(28),Z=a(57),ee=a.n(Z),te=function(){function e(t,a){Object(v.a)(this,e),this.sink=void 0,this.sink=a,t.subscribe(this.loadApps.bind(this))}return Object(y.a)(e,[{key:"loadApps",value:function(e){var t=this,a=window.localStorage.getItem("u"),n=window.localStorage.getItem("p");ee.a.get("/api/v1/core/clientapps").withCredentials().set("Accept","application/json").set("Authorization","user "+a+":"+n).end(function(e,a){if(e)if(401===e.status)ae.navigateTo.next("/");else if(403===e.status){var n={code:e.status,message:"Invalid Login (todo: show toast)"};t.sink.error(n)}else{console.dir(e);var i={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(i)}else t.sink.next({primaryApps:a.body.apps.primary,secondaryApps:a.body.apps.secondary})})}}]),e}(),ae=new function e(){Object(v.a)(this,e),this.logout={source:new $.Subject,sink:new $.Subject},this.navigateTo=new $.Subject,this.loadClientApps={source:new $.BehaviorSubject,sink:new $.BehaviorSubject},this.loadClientAppsService=new te(this.loadClientApps.source,this.loadClientApps.sink)},ne=function(e){function t(e,a){var n;return Object(v.a)(this,t),(n=Object(w.a)(this,Object(k.a)(t).call(this,e))).handleNavClick=n.handleNavClick.bind(Object(F.a)(n)),n}return Object(C.a)(t,e),Object(y.a)(t,[{key:"handleNavClick",value:function(e){this.props.onNavClick&&this.props.onNavClick(e)}},{key:"handleLogout",value:function(){window.localStorage.clear(),ae.logout.source.next(!0),ae.navigateTo.next("://")}},{key:"findApp",value:function(e,t){if(t){var a=!0,n=!1,i=void 0;try{for(var l,r=t[Symbol.iterator]();!(a=(l=r.next()).done);a=!0){var s=l.value;if(s.slug===e)return s}}catch(o){n=!0,i=o}finally{try{a||null==r.return||r.return()}finally{if(n)throw i}}}return null}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.findApp("user_manager",this.props.secondaryApps);return l.a.createElement(K.a,{className:this.props.open?t.sidebarOpen:t.sidebarClosed},l.a.createElement(K.a,{className:this.props.open?t.sidebarUserInfo:t.sidebarUserInfoClosed},l.a.createElement("div",{className:t.sidebarProfileIcon},l.a.createElement(B.a,{style:{width:60,height:60}})),l.a.createElement("div",{className:t.sidebarProfileName},l.a.createElement(V.a,{component:"div",type:"title"},this.props.user.firstName," ",this.props.user.lastName)),l.a.createElement("div",{className:t.sidebarButtons},l.a.createElement(A.a,{onClick:this.handleLogout},"Logout"),a&&l.a.createElement(A.a,{onClick:function(){return ae.navigateTo.next(a.path)}},"Profile"))),l.a.createElement("div",{className:this.props.open?t.appListsOpen:t.appListsClosed},l.a.createElement("div",{style:{gridColumn:"1",gridRow:"1"}},l.a.createElement(V.a,{type:"title",className:this.props.open?t.openLabel:t.closedLabel,style:{paddingLeft:"16px",paddingTop:"16px",gridColumn:"1",gridRow:"1"}},"Apps")),l.a.createElement(q.a,{style:{gridColumn:"1",gridRow:"2"}},this.props.apps&&this.props.apps.map(function(a){return l.a.createElement(Q.a,{button:!0,key:a.path,onClick:function(){return e.handleNavClick(a.path)}},l.a.createElement(G.a,null,l.a.createElement(P.a,null)),l.a.createElement(X.a,{primary:a.label,secondary:"",className:e.props.open?t.openLabel:t.closedLabel}))})),l.a.createElement(q.a,{style:{gridColumn:"1",gridRow:"3"},className:this.props.open?t.closedLabel:t.openLabel},l.a.createElement(Q.a,{button:!0,onClick:function(){return e.handleNavClick("://app-usermanager/index.html")}},l.a.createElement(G.a,null,l.a.createElement(B.a,{style:{width:48,height:48}}))))))}}]),t}(i.Component),ie=Object(o.d)(Object(u.withStyles)(function(e){return{sidebarOpen:{width:"240px",height:"100vh",background:"#fff"},sidebarClosed:{width:"72px",height:"100vh",background:"#fff"},sidebarUserInfo:{width:"100%",padding:"8px",display:"grid",gridGap:"8px",gridTemplateRows:"auto",gridTemplateColumns:"60px auto"},sidebarUserInfoClosed:{display:"none"},sidebarProfileIcon:{gridColumn:"1",gridRow:"1"},sidebarProfileName:{gridColumn:"2",gridRow:"1",alignSelf:"center"},sidebarButtons:{gridColumn:"1/3",gridRow:"2",justifySelf:"center"},appListsOpen:{display:"grid",gridGap:"0px",gridTemplateRows:"24px auto",gridTemplateColumns:"auto",marginTop:"16px"},appListsClosed:{height:"90%",display:"grid",gridGap:"0px",gridTemplateRows:"0px auto 72px",gridTemplateColumns:"auto"},openLabel:{display:"inline"},closedLabel:{display:"none"}}})(ne)),le=a(124),re=a.n(le),se=a(392),oe=a.n(se),ce=a(391),de=a.n(ce),ue=a(111),he=a.n(ue),pe=a(390),ge=a.n(pe),me=a(389),fe=a.n(me),be=function(e){function t(e,a){var n;return Object(v.a)(this,t),(n=Object(w.a)(this,Object(k.a)(t).call(this,e))).state={openMoreMenu:!1},n.handleToggle=n.handleToggle.bind(Object(F.a)(n)),n.handleOpenMoreMenu=n.handleOpenMoreMenu.bind(Object(F.a)(n)),n.handleLogout=n.handleLogout.bind(Object(F.a)(n)),n}return Object(C.a)(t,e),Object(y.a)(t,[{key:"handleOpenMoreMenu",value:function(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}},{key:"handleToggle",value:function(){this.props.onToggle&&this.props.onToggle()}},{key:"handleNavClick",value:function(e){this.props.onNavClick&&this.props.onNavClick(e)}},{key:"handleMenuClose",value:function(){this.setState({openMoreMenu:!1})}},{key:"handleLogout",value:function(){window.localStorage.clear(),ae.logout.source.next(!0),ae.navigateTo.next("://")}},{key:"render",value:function(){var e=this,t=this.props.classes;return l.a.createElement(D.a,{className:t.root,position:"static"},l.a.createElement(R.a,null,l.a.createElement(re.a,{onClick:this.handleToggle,className:t.menuButton,"aria-label":"Menu"},l.a.createElement(fe.a,{style:{color:"white"}})),l.a.createElement(V.a,{type:"title",color:"inherit",className:t.flex,onClick:function(){return e.handleNavClick("://dashboard/index.html")}},"Family ",l.a.createElement("i",null,"D.A.M")),l.a.createElement(re.a,{"aria-label":"More","aria-owns":this.state.open?"long-menu":null,"aria-haspopup":"true",onClick:this.handleOpenMoreMenu,className:t.moreButton},l.a.createElement(ge.a,null)),l.a.createElement(de.a,{id:"long-menu",anchorEl:this.state.openMoreMenuAnchorEl,open:this.state.openMoreMenu},l.a.createElement(he.a,{color:"contrast",onClick:function(){e.handleLogout(),e.handleMenuClose()}},"Logout"),l.a.createElement(oe.a,null),this.props.apps&&this.props.apps.map(function(t){return l.a.createElement(he.a,{key:t.path,color:"contrast",onClick:function(){e.handleNavClick(t.path),e.handleMenuClose()}},t.label)}))))}}]),t}(i.Component),ve=Object(o.d)(Object(u.withStyles)(function(e){return{root:{width:"100%",height:"64px"},headerContainer:{display:"grid",gridTemplateRows:"auto",gridTemplateColumns:"48px auto 48px"},hamburgerMenu:{display:"block",gridRow:"1",gridColumn:"1"},mainSection:{gridRow:"1",gridColumn:"2"},rightSection:{gridRow:"2",gridColumn:"3",textAlign:"right"},flex:{flex:1},menuButton:{marginLeft:-12,marginRight:20},moreButton:{color:"#fff"}}})(be)),ye=function(e){function t(e,a){var n;Object(v.a)(this,t),n=Object(w.a)(this,Object(k.a)(t).call(this,e));var i=window.localStorage.getItem("AppShell.isOpen");return n.state={isMounted:!0,isOpen:i||!0},n.handleOpenCloseToggle=n.handleOpenCloseToggle.bind(Object(F.a)(n)),n.handleOpenMoreMenu=n.handleOpenMoreMenu.bind(Object(F.a)(n)),n}return Object(C.a)(t,e),Object(y.a)(t,[{key:"componentWillMount",value:function(){var e=this;this.setState({isMounted:!0}),ae.navigateTo.takeWhile(function(){return e.state.isMounted}).subscribe(function(e){if("://"===e.substring(0,3)){var t=window.location.href.indexOf("#");-1===t&&window.location.href!==e.substring(2)?window.location.href=e.substring(2):window.location.href.substr(t+1)!==e.substring(2)&&(window.location.href=e.substring(2))}else this.props.history.push(e)}.bind(this)),ae.loadClientApps.sink.subscribe(function(t){t&&e.setState({primaryApps:t.primaryApps,secondaryApps:t.secondaryApps})}),ae.loadClientApps.source.next(!0)}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}},{key:"handleOpenMoreMenu",value:function(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}},{key:"handleOpenCloseToggle",value:function(){var e=!this.state.isOpen;this.setState({isOpen:e}),window.localStorage.setItem("AppShell.isOpen",e)}},{key:"handleLogout",value:function(){window.localStorage.clear(),ae.logout.source.next(!0),ae.navigateTo.next("://")}},{key:"render",value:function(){var e=this.props.classes;if(this.props.user)return l.a.createElement("div",{className:this.state.isOpen?e.dashboardShellContainerOpen:e.dashboardShellContainerClosed},l.a.createElement("header",{className:e.header},l.a.createElement(ve,{apps:this.state.secondaryApps,onToggle:this.handleOpenCloseToggle,onNavClick:function(e){return ae.navigateTo.next(e)}})),l.a.createElement(ie,{user:this.props.user,apps:this.state.primaryApps,secondaryApps:this.state.secondaryApps,open:this.state.isOpen,onNavClick:function(e){return ae.navigateTo.next(e)}}),l.a.createElement("div",{className:e.main},this.props.children));this.handleLogout()}}]),t}(i.Component),we=Object(o.d)(Object(u.withStyles)(function(e){return{dashboardShellContainerOpen:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"240px auto"},dashboardShellContainerClosed:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"72px auto"},header:{gridColumn:"1/3",gridRow:"1",position:"inherit",height:"64px"},main:{background:"#eee"}}})(ye)),ke=function(e){function t(e,a){var n;return Object(v.a)(this,t),(n=Object(w.a)(this,Object(k.a)(t).call(this,e))).state={paths:[]},n}return Object(C.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){this.parsePath(this.props.path)}},{key:"componentWillUnmount",value:function(){this.currentPathSubscription&&this.currentPathSubscription.dispose()}},{key:"componentWillReceiveProps",value:function(e){e.path&&this.parsePath(e.path)}},{key:"parsePath",value:function(e){for(var t=e.split("/"),a="",n=[],i=[],l=0;l<t.length;l++){var r=t[l];r.trim().length>0&&(a=a+"/"+r,i[l]=r,n.push({label:r,level:l,path:a,style:{color:l>2?"blue":"black",cursor:l>2?"pointer":"default"}}))}this.setState({paths:n})}},{key:"render",value:function(){var e=this.props.classes;return l.a.createElement("div",null,l.a.createElement("ol",{className:e.breadcrumb},this.state.paths.map(function(t){return t.path?l.a.createElement("li",{className:e.li,key:t.path,style:t.style,onClick:function(){return ae.navigateTo.next(t.path)}},t.label):l.a.createElement("li",{className:e.li,key:t.label},t.label)})))}}]),t}(i.Component),Ce=Object(u.withStyles)(function(e){return{breadcrumb:{backgroundColor:"transparent",listStyle:"none",padding:"0px"},li:{float:"left",margin:"0 0 10px 5px",color:"blue",cursor:"pointer","&:before":{content:'"/ "',color:"black"},"&:after":{content:'" "',color:"black"}}}})(ke),Ee=(a(785),a(393)),xe=a.n(Ee),Oe=a(127),je=a.n(Oe),Fe=a(128),Se=a.n(Fe),De=a(25),Ne=a.n(De),Ae=a(68),Te=a.n(Ae),Re=a(399),Me=a.n(Re),Pe=a(126),Le=a.n(Pe),Ie=a(125),We=a.n(Ie),Be=a(129),Ue=a.n(Be),Ve=a(184),He=a.n(Ve),Ke=a(183),ze=a.n(Ke),Ge=a(182),Je=a.n(Ge),qe=a(181),Ye=a.n(qe),Qe=a(293),_e=a.n(Qe),Xe=function(e){function t(){var e,a;Object(v.a)(this,t);for(var n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return(a=Object(w.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(i)))).createSortHandler=function(e){return function(t){a.props.onRequestSort(t,e)}},a}return Object(C.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=(e.onSelectAllClick,e.order),n=e.orderBy;e.numSelected,e.rowCount;return l.a.createElement(Ye.a,{className:t.tableHead},l.a.createElement(Te.a,null,l.a.createElement(Ne.a,{padding:"none",style:{width:"100%",padding:"16px 8px 16px 16px"}},l.a.createElement(_e.a,{active:"name"===n,direction:a,onClick:this.createSortHandler("name")},"Name")),l.a.createElement(Ne.a,{padding:"none",style:{minWidth:"200px",padding:"16px 8px"}},l.a.createElement(_e.a,{active:"dam:datecreated"===n,direction:a,onClick:this.createSortHandler("dam:datecreated")},"Created")),l.a.createElement(Ne.a,{padding:"none",style:{textAlign:"center",minWidth:"100px",padding:"16px 8px"}},"Actions")))}}]),t}(i.Component),$e=Object(u.withStyles)(function(e){return{tableHead:{backgroundColor:"#fff",fontSize:"16px"}}})(Xe),Ze=new function e(){Object(v.a)(this,e),this.baseHost=new $.BehaviorSubject(""),this.basicUser=new $.BehaviorSubject(window.localStorage.getItem("u")),this.basicPwd=new $.BehaviorSubject(window.localStorage.getItem("p"))},et=function(){function e(t,a){Object(v.a)(this,e),this.sink=void 0,this.sink=a,t.subscribe(function(e){this.getFilesAndFolders(e)}.bind(this))}return Object(y.a)(e,[{key:"getFilesAndFolders",value:function(e){var t=this;console.log("loading files & folders: "+e);var a=Ze.baseHost.getValue(),n=Ze.basicUser.getValue(),i=Ze.basicPwd.getValue();if(void 0!==e&&e.length>0){var l=a+e;ee.a.get(l).withCredentials().set("Accept","application/json").set("Authorization","Basic "+btoa(unescape(encodeURIComponent(n+":"+i)))).end(function(e,a){if(e)if(401===e.status)ae.navigateTo.next("/");else if(403===e.status)ae.alert.next("You do not have permission to access these files");else{var n={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(n)}else{var i=[];a.body.children&&(i=a.body.children.filter(function(e){return!e.name.toString().startsWith(".")})),t.sink.next(i)}})}}}]),e}(),tt=function(){function e(t,a){Object(v.a)(this,e),this.sink=void 0,this.sink=a,t.subscribe(function(e){this.getFiles(e)}.bind(this))}return Object(y.a)(e,[{key:"getFiles",value:function(e){var t=this,a=Ze.baseHost.getValue(),n=Ze.basicUser.getValue(),i=Ze.basicPwd.getValue();if(void 0!==e&&e.length>0){for(var l=[],r=0;r<e.length;r++){var s=e[r],o=ee.a.get(a+s+".1.json").withCredentials().set("Authorization","Basic "+btoa(unescape(encodeURIComponent(n+":"+i)))).set("Accept","application/json");l.push(o)}Promise.all(l).then(function(e){for(var a=[],n=0;n<e.length;n++){var i=e[n];a.push(i.body)}t.sink.next(a)}).catch(function(e){console.log(e)})}}}]),e}(),at=function(){function e(t,a){var n=this;Object(v.a)(this,e),this.host="http://localhost:9000",this.sink=void 0,this.fileQueue=new $.Subject,this.sink=a,t.subscribe(function(e){n.fileQueue.next(e)}),this.fileQueue.flatMap(function(e){if(!Array.isArray(e))return n.uploadNextFile(e);for(var t=0;t<e.length;t++){var a=e[t];return n.uploadNextFile(a)}},null,3).subscribe(function(e){})}return Object(y.a)(e,[{key:"uploadNextFile",value:function(e){var t=this;return console.log("file: "+e),e?$.Observable.of(e).flatMap(function(a){return new Promise(function(a,n){return t.uploadFile(e).then(function(e){return a(e)}).catch(function(t){var a=1;return e.retry&&(a=e.retry+1),e.progress=0,e.retry=a,e.error="Retrying request ("+a+"/3)",n(t)})})}).retry(2).catch(function(t){return e.error=t.status+": "+t.message,e.progress=0,$.Observable.of(t)}):null}},{key:"checkAccess",value:function(e){var t=Ze.baseHost.getValue(),a=Ze.basicUser.getValue(),n=Ze.basicPwd.getValue();return ee.a.get(t+"/api/familydam/v1/files/upload/info").set("Authorization","Basic "+btoa(unescape(encodeURIComponent(a+":"+n)))).withCredentials().send({path:encodeURI(e.path).replace("&","%26")}).then(function(e){return JSON.parse(e)},function(e){if(401===e.status)ae.navigateTo.next("://login");else{var t={code:e.status,message:e.message};lt.uploadError.next(t)}})}},{key:"copyLocalFile",value:function(e){return e.recursive||(e.recursive=!0),ee.a.post(this.host+"/api/familydam/v1/files/upload/copy").withCredentials().field("dir",e.uploadPath).field("path",e.path).field("recursive",e.recursive).then(function(t){return e.status="COMPLETE",e.percentComplete="100",lt.uploadCompleted.next(t),JSON.parse(t)})}},{key:"uploadFile",value:function(e){var t=e.uploadPath;e.webkitRelativePath?t+="/"+e.webkitRelativePath.substr(0,e.webkitRelativePath.lastIndexOf("/")):e.relativePath&&(t+=e.relativePath.substr(0,e.relativePath.lastIndexOf("/")));var a=new FormData;a.append("name",e.name),a.append("path",t),a.append("destination",t),a.append(e.name,e);var n=window.localStorage.getItem("u"),i=window.localStorage.getItem("p");return console.log("Upload to:"+this.host+t),console.dir(e),ee.a.post("http://localhost:9000/api/familydam/v1/files/upload").withCredentials().set("Authorization","user "+n+":"+i).send(a).on("progress",function(t){console.log(t),e.progress=t.percent,lt.uploadProgress.next(e)})}}]),e}(),nt=function(){function e(t,a){Object(v.a)(this,e),this.sink=void 0,this.sink=a,t.subscribe(function(e){this.deleteFileOrFolder(e)}.bind(this))}return Object(y.a)(e,[{key:"deleteFileOrFolder",value:function(e){var t=this,a=Ze.baseHost.getValue(),n=Ze.basicUser.getValue(),i=Ze.basicPwd.getValue();if(void 0!==e&&e.length>0){var l=a+e;ee.a.delete(l).withCredentials().set("Accept","application/json").set("Authorization","Basic "+btoa(unescape(encodeURIComponent(n+":"+i)))).end(function(e,a){if(e)if(401===e.status)ae.navigateTo.next("/");else if(403===e.status)ae.alert.next("You do not have permission to access these files");else{var n={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(n)}else t.sink.next(!0)})}}}]),e}(),it=function(){function e(t,a){Object(v.a)(this,e),this.sink=void 0,this.sink=a,t.subscribe(this.createDirectory.bind(this))}return Object(y.a)(e,[{key:"createDirectory",value:function(e){var t=this,a=Ze.baseHost.getValue(),n=Ze.basicUser.getValue(),i=Ze.basicPwd.getValue(),l=e.name,r=a+e.path+"/"+l;ee.a.post(r).withCredentials().field("jcr:primaryType","sling:Folder").set("Authorization","Basic "+btoa(unescape(encodeURIComponent(n+":"+i)))).end(function(e,a){if(e)if(console.log(e),401===e.status)ae.navigateTo.next("/");else{var n={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(n)}else t.sink.next(a)})}}]),e}(),lt=new function e(){Object(v.a)(this,e),this.getFileAndFolders={source:new $.Subject,sink:new $.Subject},this.getFilesByPath={source:new $.Subject,sink:new $.Subject},this.uploadFile={source:new $.Subject,sink:new $.Subject},this.deleteFileOrFolder={source:new $.Subject,sink:new $.Subject},this.createFolder={source:new $.Subject,sink:new $.Subject},this.uploadProgress=new $.Subject,this.uploadCompleted=new $.Subject,this.uploadError=new $.Subject,this.getFilesAndFoldersService=new et(this.getFileAndFolders.source,this.getFileAndFolders.sink),this.getFilesByPathService=new tt(this.getFilesByPath.source,this.getFilesByPath.sink),this.uploadFileService=new at(this.uploadFile.source,this.uploadFile.sink),this.deleteFileOrFolderService=new nt(this.deleteFileOrFolder.source,this.deleteFileOrFolder.sink),this.createFolderService=new it(this.createFolder.source,this.createFolder.sink)},rt=function(e){function t(e,a){var n;return Object(v.a)(this,t),(n=Object(w.a)(this,Object(k.a)(t).call(this,e))).handleClick=n.handleClick.bind(Object(F.a)(n)),n}return Object(C.a)(t,e),Object(y.a)(t,[{key:"handleClick",value:function(e){console.log("loading button click"),this.props.onClick?this.props.onClick(e):console.dir(this.props)}},{key:"render",value:function(){var e=this.props.classes,t={minWidth:"40px",color:"#fff"};return this.props.isLoading&&(t.paddingLeft="16px"),l.a.createElement(A.a,{variant:"contained",color:"primary",style:{height:"25px",padding:"0px 16px"},onClick:this.handleClick},this.props.isLoading&&l.a.createElement(j.a,{className:e.progress,color:"#fff",size:25}),l.a.createElement(V.a,{style:t},this.props.label))}}]),t}(i.Component),st=Object(o.d)(Object(u.withStyles)(function(e){return{progress:{}}})(rt)),ot=a(296),ct=a(123),dt=a(47),ut=a(242),ht=function(e){function t(){var e,a;Object(v.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(w.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(i)))).getRowClassName=function(e){var t=e.index,n=a.props,i=n.classes,l=n.onRowClick;return Object(dt.a)(i.tableRow,i.flexContainer,Object(ct.a)({},i.tableRowHover,-1!==t&&null!=l))},a.cellRenderer=function(e){var t=e.cellData,n=(e.columnData,e.columnIndex),i=(e.dataKey,e.isScrolling,e.parent,e.rowData,e.rowIndex,a.props),r=i.columns,s=i.classes,o=i.rowHeight,c=i.onRowClick;return r[n].icons?r[n].icons.map(function(e){return"delete"===e?l.a.createElement(A.a,{onClick:function(){return a.props.onDelete(a.props.folder.path)},style:{minWidth:"24px",padding:"4px"}},l.a.createElement(We.a,null)):"download"===e?l.a.createElement(A.a,{onClick:function(){return a.props.onDownload(a.props.folder.path)},style:{minWidth:"24px",padding:"4px"}},l.a.createElement(Le.a,null)):l.a.createElement("div",null)}):l.a.createElement(Ne.a,{component:"div",className:Object(dt.a)(s.tableCell,s.flexContainer,Object(ct.a)({},s.noClick,null==c)),variant:"body",style:{height:o},align:null!=n&&r[n].numeric?"right":"left"},t)},a.headerRenderer=function(e){var t=e.label,n=e.columnIndex,i=a.props,r=i.headerHeight,s=i.columns,o=i.classes;return l.a.createElement(Ne.a,{component:"div",className:Object(dt.a)(o.tableCell,o.flexContainer,o.noClick),variant:"head",style:{height:r},align:s[n].numeric?"right":"left"},l.a.createElement("span",null,t))},a}return Object(C.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,i=t.columns,r=Object(ot.a)(t,["classes","columns"]);return l.a.createElement(ut.a,null,function(t){var s=t.height,o=t.width;return l.a.createElement(ut.c,Object.assign({height:s,width:o},r,{rowClassName:e.getRowClassName}),i.map(function(t,i){var r=t.dataKey,s=Object(ot.a)(t,["dataKey"]);return l.a.createElement(ut.b,Object.assign({key:r,headerRenderer:function(t){return e.headerRenderer(Object(n.a)({},t,{columnIndex:i}))},className:a.flexContainer,cellRenderer:e.cellRenderer,dataKey:r},s))}))})}}]),t}(l.a.PureComponent);ht.defaultProps={headerHeight:48,rowHeight:48};var pt=Object(u.withStyles)(function(e){return{flexContainer:{display:"flex",alignItems:"center",boxSizing:"border-box"},tableRow:{cursor:"pointer"},tableRowHover:{"&:hover":{backgroundColor:e.palette.grey[200]}},tableCell:{flex:1},noClick:{cursor:"initial"}}})(ht),gt=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(w.a)(this,Object(k.a)(t).call(this,e))).isCntlPressed=!1,a.isSpacePressed=!1,a.handleClick=function(e,t){var n=a.state.selected,i=n.indexOf(t),l=[];a.isCntlPressed,console.log("selected ="+i),-1==i?l.push(t):l=(l=[]).concat(n.slice(0,i),n.slice(i+1)),a.setState({selected:l}),a.props.onSelectionChange&&a.props.onSelectionChange(l)},a.handleRequestSort=function(e,t){var n=t,i="desc";a.state.orderBy===t&&"desc"===a.state.order&&(i="asc");var l="desc"===i?a.state.files.sort(function(e,t){return t[n]<e[n]?-1:1}):a.state.files.sort(function(e,t){return e[n]<t[n]?-1:1});a.setState({data:l,order:i,orderBy:n})},a.state={files:[],rootPath:"/content",isMounted:!0,order:"asc",orderBy:"name",selected:[],showDeleteFileDialog:!1,showDeleteFolderDialog:!1},a.handleFileDelete=a.handleFileDelete.bind(Object(F.a)(a)),a.handleFolderDelete=a.handleFolderDelete.bind(Object(F.a)(a)),a.handleFileDownload=a.handleFileDownload.bind(Object(F.a)(a)),a.handleFolderDownload=a.handleFolderDownload.bind(Object(F.a)(a)),a.handleCancelDialog=a.handleCancelDialog.bind(Object(F.a)(a)),a.handleFileDeleteOk=a.handleFileDeleteOk.bind(Object(F.a)(a)),a.handleFolderDeleteOk=a.handleFolderDeleteOk.bind(Object(F.a)(a)),a}return Object(C.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({isMounted:!0}),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.handleClick=this.handleClick.bind(this),document.addEventListener("keydown",this.handleKeyDown,!1),document.addEventListener("keyup",this.handleKeyUp,!1),document.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.props.files&&this.setState({files:this.props.files}),lt.getFileAndFolders.sink.takeWhile(function(){return e.state.isMounted}).subscribe(function(t){var a=e.state.orderBy,n=t.sort(function(e,t){return e["jcr:primaryType"]&&t["jcr:primaryType"]&&e["jcr:primaryType"]!==t["jcr:primaryType"]?e["jcr:primaryType"]>t["jcr:primaryType"]?-1:1:e[a]&&t[a]?e[a].toString().toLowerCase()<t[a].toString().toLowerCase()?-1:1:0});console.log(JSON.stringify(n)),e.setState({files:n})}),lt.getFileAndFolders.source.next(this.props.path)}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function(e){this.props=e,lt.getFileAndFolders.source.next(this.props.path)}},{key:"handleKeyDown",value:function(e){switch(console.log("keydown="+e.keyCode),e.keyCode){case 17:case 91:this.isCntlPressed=!0;break;case 16:this.isSpacePressed=!0}}},{key:"handleKeyUp",value:function(e){switch(console.log("keyup="+e.keyCode),e.keyCode){case 17:case 91:this.isCntlPressed=!1;break;case 16:this.isSpacePressed=!1}}},{key:"handleFileDelete",value:function(e){return this.setState({showDeleteFileDialog:!0,pendingFileToDelete:e}),!1}},{key:"handleFolderDelete",value:function(e){return this.setState({showDeleteFolderDialog:!0,pendingFolderToDelete:e}),!1}},{key:"handleFileDownload",value:function(e,t){var a=document.createElement("a");return document.body.appendChild(a),a.href="http://localhost:9000"+t,a.download=e,a.click(),!1}},{key:"handleFolderDownload",value:function(e){return!1}},{key:"handleFileDeleteOk",value:function(){var e=this;lt.deleteFileOrFolder.source.next(this.state.pendingFileToDelete);var t=this.state.pendingFileToDelete;lt.deleteFileOrFolder.sink.subscribe(function(){e.props.onDelete&&e.props.onDelete(t)}),this.setState({showDeleteFileDialog:!1,pendingFileToDelete:null})}},{key:"handleFolderDeleteOk",value:function(e){var t=this;lt.deleteFileOrFolder.source.next(this.state.pendingFolderToDelete),lt.deleteFileOrFolder.sink.subscribe(function(){t.props.onDelete&&t.props.onDelete(t.state.pendingFolderToDelete)}),this.setState({showDeleteFolderDialog:!1,pendingFolderToDelete:null})}},{key:"handleCancelDialog",value:function(e){this.setState({showDeleteFileDialog:!1,showDeleteFolderDialog:!1,pendingFileToDelete:null})}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state,n=a.files,i=a.order,r=a.orderBy,s=a.selected;return l.a.createElement(K.a,{className:t.root},l.a.createElement("div",{className:t.tableWrapper},l.a.createElement(je.a,null,l.a.createElement($e,{numSelected:s.length,order:i,orderBy:r,onRequestSort:this.handleRequestSort,rowCount:n.length}),l.a.createElement(Se.a,null,this.state.files.filter(function(e){return!e.toString().startsWith(".")&&!e.toString().startsWith("jcr:")}).map(function(t){var a,n=(a=t.path,-1!==e.state.selected.indexOf(a));return"dam:folder"===t["jcr:primaryType"]||"sling:Folder"===t["jcr:primaryType"]||"nt:folder"===t["jcr:primaryType"]?l.a.createElement(mt,{key:t.path,folder:t,isSelected:n,onDelete:e.handleFolderDelete,onDownload:e.handleFolderDownload,onNavigate:function(e){return ae.navigateTo.next(e)}}):l.a.createElement(ft,{key:t.path,file:t,isSelected:n,onDelete:function(){return e.handleFileDelete(t.path)},onDownload:e.handleFileDownload,onClick:function(t,a){return e.handleClick(t,a)},onKeyDown:function(t,a){return e.handleClick(t,a)},onNavigate:function(e){return ae.navigateTo.next(e)}})})))),l.a.createElement(Ue.a,{ignoreBackdropClick:!0,ignoreEscapeKeyUp:!0,maxWidth:"xs",open:this.state.showDeleteFileDialog},l.a.createElement(Je.a,null,"Delete Confirmation"),l.a.createElement(ze.a,null,l.a.createElement(V.a,null,"Are you sure you want to delete this file?")),l.a.createElement(He.a,null,l.a.createElement(A.a,{onClick:this.handleCancelDialog,color:"primary"},"Cancel"),l.a.createElement(st,{isLoading:this.state.isLoading,label:"Delete",onClick:this.handleFileDeleteOk}))),l.a.createElement(Ue.a,{ignoreBackdropClick:!0,ignoreEscapeKeyUp:!0,maxWidth:"xs",open:this.state.showDeleteFolderDialog},l.a.createElement(Je.a,null,"Delete Confirmation"),l.a.createElement(ze.a,null,l.a.createElement(V.a,null,"Are you sure you want to delete this folder and all of the files in it?")),l.a.createElement(He.a,null,l.a.createElement(A.a,{onClick:this.handleCancelDialog,color:"primary"},"Cancel"),l.a.createElement(st,{isLoading:this.state.isLoading,label:"Delete",onClick:this.handleFolderDeleteOk}))))}},{key:"renderVirtualTable",value:function(){var e=this;return l.a.createElement(K.a,{style:{height:"100%",width:"100%"}},l.a.createElement(pt,{rowCount:this.state.files.length,rowGetter:function(t){var a=t.index;return e.state.files[a]},columns:[{width:300,label:"Name",dataKey:"name"},{width:150,label:"Created",dataKey:"jcr:created"},{width:150,label:"Actions",actions:["delete","download"]}]}))}}]),t}(i.Component),mt=function(e,t){return l.a.createElement(Te.a,{hover:!0,role:"checkbox",tabIndex:-1,selected:e.isSelected,"aria-checked":e.isSelected},l.a.createElement(Ne.a,{padding:"default",style:{padding:"8px 8px 8px 16px"},onClick:function(){return e.onNavigate(e.folder.path)}},l.a.createElement(P.a,null),l.a.createElement(V.a,{component:"span",style:{display:"inline",paddingLeft:"16px"}},e.folder.name)),l.a.createElement(Ne.a,{padding:"default"}),l.a.createElement(Ne.a,{padding:"default",style:{padding:"8px",textAlign:"center"}},l.a.createElement(A.a,{onClick:function(){return e.onDelete(e.folder.path)},style:{minWidth:"24px",padding:"4px"}},l.a.createElement(We.a,null)),l.a.createElement(A.a,{onClick:function(){return e.onDownload(e.folder.path)},style:{minWidth:"24px",padding:"4px"}},l.a.createElement(Le.a,null))))},ft=function(e,t){return l.a.createElement(Te.a,{hover:!0,role:"checkbox","aria-checked":e.isSelected,tabIndex:-1,selected:e.isSelected},l.a.createElement(Ne.a,{padding:"default",style:{padding:"8px 8px 8px 16px"},onClick:function(t){console.log("onclick"),e.onClick(t,e.file.path)}},e.file.path.toString().toLowerCase().endsWith(".jpg")||e.file.path.toString().toLowerCase().endsWith(".png")?l.a.createElement("img",{src:"http://localhost:9000"+e.file.path,alt:"",style:{width:"25px"}}):l.a.createElement(Me.a,null),l.a.createElement(V.a,{style:{display:"inline",paddingLeft:"16px"}},e.file.name)),l.a.createElement(Ne.a,{padding:"default",style:{padding:"8px"}},xe()(e.file["dam:datecreated"]?e.file["dam:datecreated"]:e.file["jcr:created"]).format("MMM Do YYYY, h:mm:ss a")),l.a.createElement(Ne.a,{padding:"default",style:{padding:"8px",textAlign:"center"}},l.a.createElement(A.a,{onClick:function(){return e.onDelete(e.file.path)},style:{minWidth:"24px",padding:"4px"}},l.a.createElement(We.a,null)),e.file._links.download&&l.a.createElement(A.a,{onClick:function(){return e.onDownload(e.file.name,e.file._links.download)},style:{minWidth:"24px",padding:"4px"}},l.a.createElement(Le.a,null))))},bt=Object(x.f)(Object(u.withStyles)(function(e){return{main:{width:"100%",height:"100%",backgroundColor:"#fff"},root:{gridRow:"1/4",gridColumn:"1/4"},tableWrapper:{overflowX:"auto"}}})(gt)),vt=a(4),yt=a.n(vt),wt=a(401),kt=a.n(wt),Ct=a(402),Et=a.n(Ct),xt=a(12),Ot=a.n(xt),jt=function(e){function t(){return Object(v.a)(this,t),Object(w.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this.props,t=e.files,a=e.classes,n=t.length;return l.a.createElement(R.a,{className:Ot()(a.root,Object(ct.a)({},a.highlight,n>0))},l.a.createElement("div",{className:a.title},t.length>1&&l.a.createElement(V.a,{type:"subheading"},n," selected"),1===t.length&&l.a.createElement(V.a,{type:"title"},t[0].substr(t[0].lastIndexOf("/")+1))),l.a.createElement("div",{className:a.spacer}),l.a.createElement("div",{className:a.actions,style:{width:"100px",marginRight:"8px"}},l.a.createElement(re.a,{"aria-label":"Delete"},l.a.createElement(We.a,null)),l.a.createElement(re.a,{"aria-label":"Download"},l.a.createElement(Le.a,null))))}}]),t}(i.Component),Ft=Object(u.withStyles)(function(e){return{root:{paddingRight:2},highlight:"light"===e.palette.type?{color:e.palette.secondary.A700,backgroundColor:e.palette.secondary.A100}:{color:e.palette.secondary.A100,backgroundColor:e.palette.secondary.A700},spacer:{flex:"1 1 100%"},actions:{color:e.palette.text.secondary,display:"flex"},title:{flex:"0 0 auto"}}})(jt),St=a(403),Dt=a.n(St),Nt=a(295),At=a.n(Nt),Tt=function(e){function t(e,a){var n;return Object(v.a)(this,t),(n=Object(w.a)(this,Object(k.a)(t).call(this,e))).state={fileNodes:[],isMounted:!0,tabIndex:0},n}return Object(C.a)(t,e),Object(y.a)(t,[{key:"componentWillMount",value:function(){var e=this;this.setState({isMounted:!0}),this.handleTabChange=this.handleTabChange.bind(this),this.props.fileNodes?this.setState({fileNodes:this.props.fileNodes}):(lt.getFilesByPath.sink.takeWhile(function(){return e.state.isMounted}).subscribe(function(t){console.log(JSON.stringify(t)),e.setState({fileNodes:t})}),lt.getFilesByPath.source.next(this.props.files))}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function(e){this.props=e,lt.getFilesByPath.source.next(this.props.files)}},{key:"handleTabChange",value:function(e,t){this.setState({tabIndex:t})}},{key:"render",value:function(){var e=this.props.classes;return l.a.createElement(K.a,{style:this.props.style},l.a.createElement(Ft,{files:this.props.files}),1===this.props.files.length&&l.a.createElement(Rt,{handleTabChange:this.handleTabChange,tabIndex:this.state.tabIndex,fileNodes:this.state.fileNodes,classes:e}))}}]),t}(i.Component),Rt=function(e,t){return l.a.createElement("div",{className:e.classes.gridListRoot},l.a.createElement("div",{className:e.classes.itemPreview},1==e.fileNodes.length&&l.a.createElement("div",{style:{height:"100%",maxWidth:"100%",textAlign:"center"}},e.fileNodes.map(function(e){return l.a.createElement("img",{src:Ze.baseHost.getValue()+(e["jcr:path"]||e.path),alt:e["jcr:path"],style:{height:"100%",maxWidth:"100%",alignSelf:"center"}})})),e.fileNodes.length>1&&l.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden"}},l.a.createElement(kt.a,{cellHeight:160,style:{width:"100%",height:"100%"},cols:3},e.fileNodes.map(function(e){return l.a.createElement(Et.a,{key:e.path,cols:e.cols||1},l.a.createElement("img",{src:Ze.baseHost.getValue()+e.path,alt:e["jcr:path"],style:{height:"100%",maxWidth:"100%",alignSelf:"center"}}))})))),1===e.fileNodes.length&&l.a.createElement("div",{className:e.classes.itemRating},l.a.createElement(V.a,null,"TODO: ADD RATING")),1===e.fileNodes.length&&l.a.createElement("div",{className:e.classes.itemKeywords},l.a.createElement(V.a,null,"TODO: ADD Keywords")),1===e.fileNodes.length&&l.a.createElement("div",{className:e.classes.itemInfo},l.a.createElement(Dt.a,{value:"Details",indicatorColor:"primary",textColor:"primary",variant:"fullWidth",onChange:e.handleTabChange},l.a.createElement(At.a,{label:"Details"}),l.a.createElement(At.a,{label:"Versions",disabled:!0})),0===e.tabIndex&&l.a.createElement("div",null,l.a.createElement(je.a,null,l.a.createElement(Se.a,null,l.a.createElement(Te.a,{style:{padding:"8px"}},l.a.createElement(Ne.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Type"),l.a.createElement(Ne.a,{align:"left"},e.fileNodes[0]["jcr:content"]["jcr:mimeType"])),l.a.createElement(Te.a,null,l.a.createElement(Ne.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Resolution"),l.a.createElement(Ne.a,{align:"left"},e.fileNodes[0].width," x ",e.fileNodes[0].height)),l.a.createElement(Te.a,null,l.a.createElement(Ne.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Created"),l.a.createElement(Ne.a,{align:"left"},e.fileNodes[0]["dam:datecreated"])),l.a.createElement(Te.a,null,l.a.createElement(Ne.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Modified"),l.a.createElement(Ne.a,{align:"left"},e.fileNodes[0]["jcr:lastModified"]))))),1===e.tabIndex&&l.a.createElement("div",null,"Versions Panel")))};FileList.propTypes={files:yt.a.array.isRequired};var Mt=Object(x.f)(Object(u.withStyles)(function(e){return{gridListRoot:{margin:"24px",display:"grid",gridTemplateRows:"175px 25px 50px 3fr",gridTemplateColumns:"16px auto 16px",background:e.palette.background.paper,justifyContent:"center"},itemPreview:{gridRow:"1",gridColumn:"2",justifyContent:"center"},itemRating:{gridRow:"2",gridColumn:"2"},itemKeywords:{gridRow:"3",gridColumn:"2"},itemInfo:{gridRow:"4",gridColumn:"2"},gridSingleItemInfo:{},title:{color:e.palette.primary[200]},titleBar:{background:"linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 70%, rgba(0,0,0,0) 100%)"}}})(Tt)),Pt=a(404),Lt=a.n(Pt),It=a(405),Wt=a.n(It),Bt=a(178),Ut=a.n(Bt),Vt=a(290),Ht=a.n(Vt),Kt=a(241),zt=a.n(Kt),Gt=a(408),Jt=a.n(Gt),qt=a(409),Yt=a.n(qt),Qt=a(407),_t=a.n(Qt),Xt=a(406);function $t(e){return l.a.createElement(zt.a,Object.assign({direction:"up"},e))}var Zt=function(e){function t(e,a){var n;return Object(v.a)(this,t),(n=Object(w.a)(this,Object(k.a)(t).call(this,e))).state={isMounted:!0,isReceiverOpen:!1,files:[],filter:"all"},n.handleClose=n.handleClose.bind(Object(F.a)(n)),n.handleOnDragEnter=n.handleOnDragEnter.bind(Object(F.a)(n)),n.handleOnDragOver=n.handleOnDragOver.bind(Object(F.a)(n)),n.handleOnDragLeave=n.handleOnDragLeave.bind(Object(F.a)(n)),n.handleAddFile=n.handleAddFile.bind(Object(F.a)(n)),n.handleFileChange=n.handleFileChange.bind(Object(F.a)(n)),n.handleFolderChange=n.handleFolderChange.bind(Object(F.a)(n)),n.handleSelectFileBtnClick=n.handleSelectFileBtnClick.bind(Object(F.a)(n)),n.handleSelectFolderBtnClick=n.handleSelectFolderBtnClick.bind(Object(F.a)(n)),n.handleFilterChange=n.handleFilterChange.bind(Object(F.a)(n)),n}return Object(C.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({isMounted:!0,files:[]}),lt.uploadFile.sink.subscribe(function(t){for(var a=[],n=0;n<e.state.files.length;n++){var i=e.state.files[n];t.id===i.id&&(i.progress=100),a.push(i)}e.setState({files:a})}),lt.uploadProgress.subscribe(function(t){for(var a=[],n=0;n<e.state.files.length;n++){var i=e.state.files[n];t.id===i.id&&100!==t.progress&&(i.progress=t.progress),a.push(i)}e.setState({files:a})}),lt.uploadError.subscribe(function(t){for(var a=[],n=0;n<e.state.files.length;n++){var i=e.state.files[n];t.id===i.id&&(i.error=t.error),a.push(i)}e.setState({files:a})})}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}},{key:"handleClose",value:function(){this.setState({files:[],filter:"all"}),this.props.onClose&&this.props.onClose()}},{key:"handleOnDragEnter",value:function(e){this.setState({isReceiverOpen:!0})}},{key:"handleOnDragOver",value:function(e){this.state.isReceiverOpen&&this.setState({isReceiverOpen:!0})}},{key:"handleOnDragLeave",value:function(e){this.setState({isReceiverOpen:!1})}},{key:"handleFilterChange",value:function(e){this.setState({filter:e.target.value})}},{key:"handleSelectFileBtnClick",value:function(e){this.refs.fileInputField.click()}},{key:"handleSelectFolderBtnClick",value:function(e){this.refs.folderInputField.setAttribute("directory","directory"),this.refs.folderInputField.setAttribute("webkitdirectory","webkitdirectory"),this.refs.folderInputField.click()}},{key:"handleFileChange",value:function(e,t){var a=e.currentTarget.files;this.handleAddFile(e,a)}},{key:"handleFolderChange",value:function(e){var t=e.currentTarget.files;this.handleAddFile(e,t)}},{key:"handleAddFile",value:function(e,t){for(var a=this.state.files,n=e.dataTransfer.items,i=function(e,t,n){a.push(e),e.id||(e.id=Wt()()),e.progress=0,e.uploadPath=t,n&&(e.relativePath=n),lt.uploadFile.source.next(e)},l=function e(t,a,n){t.createReader().readEntries(function(t){for(var l=function(l){s=t[l],console.dir(s),console.dir(s.file),console.dir(s.fullPath);var r=s.fullPath;s.isFile?s.file(function(e){i(e,n,r)}):s.isDirectory&&e(s,a,n)},r=0;r<t.length;r++){var s;l(r)}})},r=0;r<n.length;r++){var s=this.props.path,o=n[r],c=o.getAsFile(),d=o.webkitGetAsEntry();d.isFile?i(c,s):d.isDirectory&&l(d,c,s)}this.setState({isReceiverOpen:!1,files:a})}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state.files.filter(function(e){return 100===e.progress}).length,n=a/this.state.files.length*100,i=this.state.files.filter(function(t){return"completed"===e.state.filter?100===t.progress:"uploading"===e.state.filter?t.progress>0&&t.progress<100:"waiting"!==e.state.filter||0===t.progress});console.log("render");var r={marginLeft:"24px",marginRight:"24px",marginBottom:"24px",height:"100%",border:"3px #ccc dashed"};return this.state.isReceiverOpen&&(r.border="5px #ccc dashed"),l.a.createElement(Ue.a,{maxWidth:"md",fullScreen:!0,open:this.props.open,transition:$t},l.a.createElement(D.a,{className:t.appBar},l.a.createElement(R.a,null,l.a.createElement(V.a,{type:"title",color:"inherit",className:t.flex},"Import Files"),l.a.createElement(A.a,{onClick:this.handleClose,disabled:a!==this.state.files.length,style:{color:"white"}},"close"))),l.a.createElement("div",{style:{paddingTop:"24px",paddingBottom:"24px",width:"100%",display:"flex"}},l.a.createElement(A.a,{className:"btn btn-default",onClick:this.handleSelectFileBtnClick},l.a.createElement(o.a,{id:"selectFiles",defaultMessage:"Select Files"})),l.a.createElement(A.a,{className:"btn btn-default",onClick:this.handleSelectFolderBtnClick},l.a.createElement(o.a,{id:"selectFiles",defaultMessage:"Select Folder"})),l.a.createElement(Ht.a,{value:this.state.filter,onChange:this.handleFilterChange,defaultValue:"all",input:l.a.createElement(Ut.a,{id:"filterInput"}),style:{textAlign:"right",right:"24px",position:"absolute",minWidth:"100px"},autoWidth:!0},l.a.createElement(he.a,{value:"all"},l.a.createElement("em",null,"All")),l.a.createElement(he.a,{value:"waiting"},"Waiting"),l.a.createElement(he.a,{value:"uploading"},"Uploading"),l.a.createElement(he.a,{value:"completed"},"Completed"))),0===this.state.files.length&&l.a.createElement(Xt.Receiver,{style:r,isOpen:!0,onDragEnter:this.handleOnDragEnter,onDragOver:this.handleOnDragOver,onDragLeave:this.handleOnDragLeave,onFileDrop:this.handleAddFile},0===this.state.files.length&&l.a.createElement(je.a,{style:{minHeight:"150px",maxHeight:"70%",minWidth:"50%",margin:"24px"}},l.a.createElement(Se.a,null,l.a.createElement(Te.a,null,l.a.createElement(Ne.a,{style:{padding:"0 8px 0 8px",border:"0px"}},l.a.createElement("div",{onClick:this.handleSelectFileBtnClick,style:{margin:"40px",textAlign:"center",fontSize:"1.4rem"}},"Click or drag files to this area to upload",l.a.createElement("div",{style:{margin:"16px"}},l.a.createElement(_t.a,{style:{fontSize:"2rem"}})),l.a.createElement("p",{style:{fontSize:"1rem"}},this.props.path))))))),this.state.files.length>0&&l.a.createElement("div",{style:{paddingLeft:"24px",paddingRight:"24px",position:"absolute",top:"135px",right:"24px",left:"24px"}},l.a.createElement(V.a,{style:{display:"inline"}},a," / ",this.state.files.length),l.a.createElement(Jt.a,{variant:"determinate",value:Math.min(n,100)}),l.a.createElement(V.a,null,"Files will be added to: ",l.a.createElement("strong",null,this.props.path))),this.state.files.length>0&&i.length>0&&l.a.createElement("div",{style:{marginLeft:"24px",marginRight:"24px",height:"100%",top:"180px",position:"absolute",left:"16px",right:"16px"}},l.a.createElement(je.a,null,l.a.createElement(Ye.a,null,l.a.createElement(Te.a,null,l.a.createElement(Ne.a,{style:{width:"32px",padding:"0 8px 0 8px"}}),l.a.createElement(Ne.a,{style:{width:"100%",padding:"0 8px 0 8px"}},"Name"),l.a.createElement(Ne.a,{style:{width:"50px",padding:"0 8px 0 8px"},numeric:!0},"Size"),l.a.createElement(Ne.a,{style:{width:"50px",padding:"0 8px 0 8px"},numeric:!0},"Progress"))),l.a.createElement(Se.a,null,i.map(function(e){return l.a.createElement(Te.a,{key:e.id},l.a.createElement(Ne.a,{style:{padding:"0 8px 0 8px"}},e.progress<100?l.a.createElement(j.a,{size:24}):l.a.createElement(Yt.a,{color:"primary"})),l.a.createElement(Ne.a,{style:{padding:"0 8px 0 8px"}},l.a.createElement(V.a,null,e.name),l.a.createElement(V.a,null,e.webkitRelativePath,"  ",e.error)),l.a.createElement(Ne.a,{style:{padding:"0 8px 0 8px"},numeric:!0},Lt()(e.size,{base:10})),l.a.createElement(Ne.a,{style:{padding:"0 8px 0 8px"},numeric:!0},Math.round(e.progress),"%"))})))),l.a.createElement("input",{type:"file",ref:"fileInputField",multiple:!0,style:{display:"none"},onChange:this.handleFileChange}),l.a.createElement("input",{type:"file",ref:"folderInputField",style:{display:"none"},onChange:this.handleFolderChange}))}}]),t}(i.Component),ea=Object(u.withStyles)(function(e){return{appBar:{position:"relative"},flex:{flex:1}}})(Zt),ta=a(410),aa=a.n(ta);function na(e){return l.a.createElement(zt.a,Object.assign({direction:"up"},e))}var ia=function(e){function t(e,a){var n;return Object(v.a)(this,t),(n=Object(w.a)(this,Object(k.a)(t).call(this,e))).state={folderName:""},n.handleSave=n.handleSave.bind(Object(F.a)(n)),n}return Object(C.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){this.setState({isMounted:!0})}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}},{key:"handleSave",value:function(){var e=this;lt.createFolder.source.next({name:this.state.folderName,path:this.props.path}),lt.createFolder.sink.subscribe(function(){e.props.onClose&&e.props.onClose()})}},{key:"render",value:function(){var e=this;return l.a.createElement(Ue.a,{maxWidth:"md",fullScreen:!1,open:this.props.open,transition:na},l.a.createElement(Je.a,null,"Create New Folder"),l.a.createElement(ze.a,null,l.a.createElement(aa.a,{id:"newFolderName",label:"Folder Name",value:this.state.folderName,onChange:function(t){return e.setState({folderName:t.target.value})},margin:"dense"})),l.a.createElement(He.a,null,l.a.createElement(A.a,{onClick:this.props.onClose,color:"primary"},"Close"),l.a.createElement(A.a,{raised:!0,color:"primary",onClick:this.handleSave},"Save")),l.a.createElement("input",{type:"file",ref:"fileInputField",multiple:!0,style:{display:"none"},onChange:this.handleFileChange}),l.a.createElement("input",{type:"file",ref:"folderInputField",style:{display:"none"},onChange:this.handleFolderChange}))}}]),t}(i.Component),la=Object(u.withStyles)(function(e){return{}})(ia),ra=function(e){function t(e,a){var n;return Object(v.a)(this,t),(n=Object(w.a)(this,Object(k.a)(t).call(this,e))).state={isMounted:!1,isLoading:!1,canAddFile:!0,canAddFolder:!0,showAddFolderDialog:!1,showUploadDialog:!1,showNewFolderDialog:!1,selectedFiles:[],root:"/content",visibleRoot:"/content/files",path:"/content/files"},n.handleFileSelectionChange=n.handleFileSelectionChange.bind(Object(F.a)(n)),n.handleUploadClosed=n.handleUploadClosed.bind(Object(F.a)(n)),n.handleAfterOnDelete=n.handleAfterOnDelete.bind(Object(F.a)(n)),n}return Object(C.a)(t,e),Object(y.a)(t,[{key:"componentWillMount",value:function(){this.setState({isMounted:!0}),this.validatePath()}},{key:"componentDidMount",value:function(){var e=this;ae.navigateTo.takeWhile(function(){return e.state.isMounted}).subscribe(function(t){console.log("{FilesPage} navigateTo="+t),"://"===t.substring(0,3)?window.location.href.substring(window.location.href.indexOf("#")+1)!==t.substring(2)&&(window.location.href=t.substring(2)):e.props.history.push(t)})}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function(e){this.props=e,this.validatePath()}},{key:"validatePath",value:function(){var e=this.props.path;this.props.location.pathname&&this.props.location.pathname.toString().startsWith(this.state.visibleRoot)&&(e=this.props.location.pathname),e||(e=this.state.visibleRoot),e.toString().startsWith(this.state.visibleRoot)?this.setState({path:e}):console.log("Invalid Path: "+e)}},{key:"handleFileSelectionChange",value:function(e){this.setState({selectedFiles:e})}},{key:"handleUploadClosed",value:function(){this.setState({showUploadDialog:!1}),lt.getFileAndFolders.source.next(this.state.path)}},{key:"handleAfterOnDelete",value:function(e){for(var t=[],a=0;a<this.state.selectedFiles.length;a++){var n=this.state.selectedFiles[a];n!==e&&t.push(n)}this.setState({selectedFiles:t}),lt.getFileAndFolders.source.next(this.state.path)}},{key:"render",value:function(){var e=this,t=this.props.classes;return this.state.isLoading?l.a.createElement(we,{user:this.props.user},l.a.createElement(j.a,{className:t.progress,size:50})):l.a.createElement(we,{user:this.props.user},l.a.createElement("div",{className:t.fileGrid},l.a.createElement(D.a,{color:"default",position:"static",elevation:0,className:t.fileGridAppBar,style:{colorDefault:"#eeeeee"}},l.a.createElement(R.a,{className:t.toolbarContainer},l.a.createElement("div",{style:{gridRow:"1",gridColumn:"1"}},l.a.createElement(P.a,{style:{width:"36px",height:"36px"}})),l.a.createElement("div",{style:{gridRow:"1",gridColumn:"2"}},l.a.createElement(Ce,{root:this.state.root,path:this.state.path})),l.a.createElement("div",{style:{gridRow:"1",gridColumn:"3",textAlign:"right"}},l.a.createElement(A.a,{color:"primary",disabled:!this.state.canAddFile,onClick:function(){e.setState({showUploadDialog:!0})}},l.a.createElement(P.a,null),"\xa0\xa0Add Files"),l.a.createElement(A.a,{label:"New Folder",color:"primary",disabled:!this.state.canAddFolder,onClick:function(){e.setState({showNewFolderDialog:!0})}},l.a.createElement(I.a,null),"\xa0\xa0New Folder")))),l.a.createElement("div",{className:t.fileGridFileList,style:{gridColumn:this.state.selectedFiles.length>0?"1/2":"1/3"}},l.a.createElement(bt,{path:this.state.path,onSelectionChange:this.handleFileSelectionChange,onDelete:this.handleAfterOnDelete,style:{gridRow:"1 / 4",gridColumn:"1 / 3"}})),l.a.createElement(Mt,{files:this.state.selectedFiles,className:t.fileGridSidebar,style:{display:this.state.selectedFiles.length>0?"block":"none"}}),l.a.createElement(ea,{onClose:this.handleUploadClosed,open:this.state.showUploadDialog,path:this.state.path}),l.a.createElement(la,{onClose:function(){e.setState({showNewFolderDialog:!1})},open:this.state.showNewFolderDialog,path:this.state.path})))}}]),t}(i.Component),sa=Object(o.d)(Object(x.f)(Object(u.withStyles)(function(e){return{progress:{margin:"0 ".concat(2*e.spacing.unit,"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},toolbarContainer:{display:"grid",gridTemplateRows:"auto",gridTemplateColumns:"48px auto auto"},fileGrid:{height:"100%",display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"4fr 2fr"},fileGridAppBar:{gridRow:"1",gridColumn:"1/3"},fileGridFileList:{gridRow:"2",gridColumn:"1",margin:"24px"},fileGridSidebar:{gridRow:"2",gridColumn:"2",margin:"24px"},mainGrid:{height:"100%",overflow:"scroll",display:"grid",gridGap:"16px",gridTemplateRows:"1fr 1fr 1fr",gridTemplateColumns:"2fr 6fr"}}})(ra))),oa=function(){function e(t,a){Object(v.a)(this,e),this.sink=void 0,this.sink=a,t.subscribe(this.getUsers.bind(this))}return Object(y.a)(e,[{key:"getUsers",value:function(e){var t=this,a=Ze.baseHost.getValue(),n=Ze.basicUser.getValue(),i=Ze.basicPwd.getValue();ee.a.get(a+"/api/v1/auth/"+e.username).withCredentials().set("Accept","application/json").set("Authorization","Basic "+btoa(unescape(encodeURIComponent(n+":"+i)))).end(function(e,a){if(e)if(401===e.status)ae.navigateTo.next("/");else{var n={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(n)}else{for(var i=[],l=0;l<a.body.length;l++){var r=a.body[l];void 0===r.firstName&&(r.firstName=r.username),i.push(r),window.localStorage.setItem("user",JSON.stringify(r))}var s=i.sort(function(e,t){return e.username>t.username?1:e.username<t.username?-1:0});t.sink.next(s)}})}}]),e}(),ca=new function e(){Object(v.a)(this,e),this.getUser={source:new $.Subject,sink:new $.BehaviorSubject(JSON.parse(window.localStorage.getItem("user")))},this.getUserService=new oa(this.getUser.source,this.getUser.sink)},da=function(e){function t(e,a){var n;return Object(v.a)(this,t),(n=Object(w.a)(this,Object(k.a)(t).call(this,e,a))).state={context:a,locale:"en-EN",isAuthenticated:!1,isLoading:!0,isMounted:!1},window.location.href.indexOf(":3000"),n}return Object(C.a)(t,e),Object(y.a)(t,[{key:"componentWillMount",value:function(){this.setState({isMounted:!0})}},{key:"componentDidMount",value:function(){var e=this;ca.getUser.sink.takeWhile(function(){return e.state.isMounted}).subscribe(function(t){t&&e.setState({isAuthenticated:!0,isLoading:!1,user:t})}),ca.getUser.source.next({username:"admin"})}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}},{key:"render",value:function(){var e=this,t=this.props.classes;return this.state.isLoading?l.a.createElement("div",null,l.a.createElement(j.a,{className:t.progress,size:50})):l.a.createElement(o.b,{locale:"en-EN",key:"en-EN",messages:this.props.i18nMessages["en-EN"]},l.a.createElement(E.a,null,l.a.createElement(x.c,null,l.a.createElement(x.a,{path:"/",component:function(){return l.a.createElement(sa,{user:e.state.user})}}))))}}]),t}(i.Component),ua=Object(u.withStyles)(function(e){return{progress:{margin:"0 ".concat(2*e.spacing.unit,"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}})(da);Object(o.c)(a(1007));var ha={"en-EN":a(1008)},pa=Object(u.createMuiTheme)({palette:{type:"light",primary:p.a,secondary:Object(n.a)({},m.a),error:b.a}});s.a.render(l.a.createElement(u.MuiThemeProvider,{theme:pa},l.a.createElement(ua,{i18nMessages:ha})),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/files",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/files","/service-worker.js");c?function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):d(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e):d(e)})}}()},386:function(e,t){},414:function(e,t,a){e.exports=a(1009)},426:function(e,t){},432:function(e,t){},436:function(e,t,a){}},[[414,1,2]]]);
//# sourceMappingURL=main.7beefaee.chunk.js.map