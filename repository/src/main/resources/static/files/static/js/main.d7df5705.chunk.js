(this.webpackJsonpfiles=this.webpackJsonpfiles||[]).push([[0],{268:function(e,t){},305:function(e,t,a){e.exports=a(714)},319:function(e,t){},325:function(e,t){},329:function(e,t,a){},595:function(e,t){},596:function(e,t){},713:function(e){e.exports=JSON.parse("{}")},714:function(e,t,a){"use strict";a.r(t);var s=a(284),i=a(0),n=a.n(i),l=a(21),r=a.n(l),o=a(47),d=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function registerValidSW(e){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{var t=e.installing;t.onstatechange=()=>{"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(e=>{console.error("Error during service worker registration:",e)})}var h=a(282),p=a(777),c=a(279),u=a.n(c),g=a(280),m=a.n(g),f=a(281),b=a.n(f),v=(a(329),a(95)),w=a(26),y=a(7),x=a(766),F=(a(330),a(58)),C=a(758),E=a(755),k=a(759),S=a(86),D=a.n(S),A=a(278),O=a.n(A),T=a(33),N=a.n(T),j=a(79),M=a(269),R=a.n(M),L=a(16),_=a(62),U=a.n(_);var P=class LoadClientAppsService_LoginService{constructor(e,t){this.sink=void 0,this.sink=t,e.subscribe(this.loadApps.bind(this))}loadApps(e){U.a.get("/api/v1/core/clientapps").withCredentials().set("Accept","application/json").end((e,t)=>{if(e)if(401===e.status)B.navigateTo.next("/");else if(403===e.status){var a={code:e.status,message:"Invalid Login (todo: show toast)"};this.sink.error(a)}else{console.dir(e);var s={code:e.status,status:e.statusText,message:e.responseText};this.sink.error(s)}else this.sink.next({primaryApps:t.body.apps.primary,secondaryApps:t.body.apps.secondary})})}};var W=new class AppSettings_AppSettings{constructor(){this.baseHost=new L.BehaviorSubject(""),this.basicUser=new L.BehaviorSubject(window.localStorage.getItem("u")),this.basicPwd=new L.BehaviorSubject(window.localStorage.getItem("p"))}};var I=class LogoutService_LogoutService{constructor(e,t){this.sink=void 0,this.sink=t,e.subscribe(this.getUser.bind(this))}getUser(e){var t=W.baseHost.getValue();fetch(t+"/logout",{method:"GET"}).then(e=>(e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e)).catch(e=>{if(401===e.status||403===e.status)window.location="/";else{var t={code:e.status,status:e.statusText,message:e.responseText};this.sink.error(t)}})}};var B=new class AppActions_AppActions{constructor(){this.navigateTo=new L.Subject,this.logout={source:new L.Subject,sink:new L.Subject},this.loadClientApps={source:new L.Subject,sink:new L.Subject},this.loadClientAppsService=new P(this.loadClientApps.source,this.loadClientApps.sink),this.logoutService=new I(this.logout.source,this.logout.sink)}};var H=class GetFileAndFoldersService_GetFilesAndFoldersService{constructor(e,t){this.sink=void 0,this.sink=t,e.subscribe(function(e){this.getFilesAndFolders(e)}.bind(this))}getFilesAndFolders(e){var t=W.baseHost.getValue();if(void 0!==e&&e.length>0){var a=t+e;U.a.get(a).withCredentials().set("Accept","application/json").end((e,t)=>{if(e)if(401===e.status)B.navigateTo.next("/");else if(403===e.status)B.alert.next("You do not have permission to access these files");else{var a={code:e.status,status:e.statusText,message:e.responseText};this.sink.error(a)}else{var s=[];t.body&&(s=t.body.filter(e=>!e.name.toString().startsWith(".")));var i,n=Object(F.a)(s);try{for(n.s();!(i=n.n()).done;){var l=i.value;l["dam:tags"]&&1==l["dam:tags"].length&&(l["dam:tags"]=l["dam:tags"][0].split(","))}}catch(e){n.e(e)}finally{n.f()}this.sink.next(s)}})}}};var K=class GetFileDataService_GetFileDataService{constructor(e,t){this.sink=void 0,this.sink=t,e.subscribe(function(e){this.getFiles(e)}.bind(this))}getFiles(e){var t=W.baseHost.getValue();if(void 0!==e&&e.length>0){for(var a=[],s=0;s<e.length;s++){var i=e[s],n=U.a.get(t+i).withCredentials().set("Accept","application/json");a.push(n)}Promise.all(a).then(e=>{for(var t=[],a=0;a<e.length;a++){var s=e[a];t.push(s.body)}this.sink.next(t)}).catch(e=>{console.log(e)})}}};a(573)(U.a);var G=class UploadFileService_UploadFileService{constructor(e,t){this.sink=void 0,this.sink=t;var a=W.baseHost.getValue();e.mergeMap(e=>{if(!Array.isArray(e))return this.uploadNextFile(a,e);for(var t=0;t<e.length;t++){var s=e[t];return this.uploadNextFile(a,s)}},3).subscribe(console.debug)}uploadNextFile(e,t){return t?L.Observable.of(t).flatMap(a=>new Promise((a,s)=>this.uploadFile(e,t).then(e=>a(e)).catch(e=>{var a=1;return t.retry&&(a=t.retry+1),t.progress=0,t.retry=a,t.error="Retrying request ("+a+"/3)",s(e)}))).retry(2).catch(e=>(t.error=e.status+": "+e.message,t.progress=0,L.Observable.of(e))):null}uploadFile(e,t){var a=t.uploadPath;t.webkitRelativePath?a+="/"+t.webkitRelativePath.substr(0,t.webkitRelativePath.lastIndexOf("/")):t.relativePath&&(a+=t.relativePath.substr(0,t.relativePath.lastIndexOf("/")));var s=new FormData;return s.append("name",t.name),s.append("path",a),s.append("destination",a),s.append("file",t),s.append("type",t.type),s.append("size",t.size),s.append("jcr:primaryType","nt:file"),s.append("dam:date.created",t.lastModified),s.append("dam:date.modified",t.lastModified),U.a.post(e+a).withCredentials().charset("UTF-8").send(s).parse(({text:e})=>0===e.length?{}:JSON.parse(e)).on("progress",e=>{t.progress=e.percent,$.uploadProgress.next(t)})}};var V=class DeleteFileOrFolderService_DeleteFileOrFolderService{constructor(e,t){this.sink=void 0,this.sink=t,e.subscribe(function(e){this.deleteFileOrFolder(e)}.bind(this))}deleteFileOrFolder(e){var t=W.baseHost.getValue();if(void 0!==e&&e.length>0){var a=t+e;U.a.delete(a).withCredentials().set("Accept","application/json").end((e,t)=>{if(e)if(401===e.status)B.navigateTo.next("/");else if(403===e.status)B.alert.next("You do not have permission to access these files");else{var a={code:e.status,status:e.statusText,message:e.responseText};this.sink.error(a)}else this.sink.next(!0)})}}};var Y=class CreateFolderService_CreateFolderService{constructor(e,t){this.sink=void 0,this.sink=t,e.subscribe(this.createDirectory.bind(this))}createDirectory(e){var t=W.baseHost.getValue(),a=e.name,s=t+e.path+"/"+a,i=new FormData;i.append("name",e.username),i.append("jcr:primaryType","nt:folder"),fetch(s,{method:"POST",body:i}).then(e=>{console.info("CreateFolder success handler"),e.redirected&&(console.debug("redirect to: "+e.url),window.location=e.url),this.sink.next(!0)}).then(e=>e.json()).then(e=>{e.firstName||(e.firstName=e.username),this.sink.next(e)}).catch(e=>{if(console.warn(e),401===e.status)B.navigateTo.next("/");else if(403===e.status)B.alert.next("You do not have permission to add a new user");else{console.error(e);var t={code:e.status,status:e.statusText,message:e.responseText};this.sink.error(t)}})}};var z=class SetFilePropertyService_SetFilePropertyService{constructor(e,t){this.sink=void 0,this.sink=t,e.subscribe(function(e){this.execute(e)}.bind(this))}execute(e){var t=W.baseHost.getValue(),a=new FormData;for(var s in e)"path"!==s&&a.append(s,e[s]);fetch(t+e.path,{method:"PUT",body:a}).then(e=>(e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e)).then(e=>e.json()).then(e=>{this.sink.next(e)}).catch(e=>{if(401===e.status||403===e.status)window.location="/";else{var t={code:e.status,status:e.statusText,message:e.responseText||e.message};this.sink.error(t)}})}};var $=new class FileActions_FileActions{constructor(){this.getFileAndFolders={source:new L.Subject,sink:new L.Subject},this.getFileData={source:new L.Subject,sink:new L.Subject},this.setFileProperty={source:new L.Subject,sink:new L.Subject},this.uploadFile={source:new L.Subject,sink:new L.Subject},this.deleteFileOrFolder={source:new L.Subject,sink:new L.Subject},this.createFolder={source:new L.Subject,sink:new L.Subject},this.stageAction=new L.Subject,this.stageFile=new L.Subject,this.uploadProgress=new L.Subject,this.uploadCompleted=new L.Subject,this.uploadError=new L.Subject,this.getFilesAndFoldersService=new H(this.getFileAndFolders.source,this.getFileAndFolders.sink),this.getFileDataService=new K(this.getFileData.source,this.getFileData.sink),this.setFilePropertyService=new z(this.setFileProperty.source,this.setFileProperty.sink),this.uploadFileService=new G(this.uploadFile.source,this.uploadFile.sink),this.deleteFileOrFolderService=new V(this.deleteFileOrFolder.source,this.deleteFileOrFolder.sink),this.createFolderService=new Y(this.createFolder.source,this.createFolder.sink)}};var q=class FileScanner_FileScanner{constructor(){this.processFile=function(){var e=Object(j.a)(N.a.mark((function _callee(e,t,a){return N.a.wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:e.id||(e.id=R()()),e.progress=0,e.status="uploadReady",e.uploadPath=t,e.uploadProgress=30,a&&(e.relativePath=a),console.debug("FILE:"+e.uploadPath),$.stageFile.next(e);case 8:case"end":return s.stop()}}),_callee)})));return function(t,a,s){return e.apply(this,arguments)}}(),this.readDir=function(){var e=Object(j.a)(N.a.mark((function _callee4(e,t,a){var s;return N.a.wrap((function _callee4$(i){for(;;)switch(i.prev=i.next){case 0:s=this,e.createReader().readEntries(function(){var e=Object(j.a)(N.a.mark((function _callee3(e){var i,n,l;return N.a.wrap((function _callee3$(r){for(;;)switch(r.prev=r.next){case 0:i=N.a.mark((function _loop(i){var n;return N.a.wrap((function _loop$(r){for(;;)switch(r.prev=r.next){case 0:if(l=e[i],n=l.fullPath,!l.isFile){r.next=6;break}l.file(function(){var e=Object(j.a)(N.a.mark((function _callee2(e){return N.a.wrap((function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.processFile(e,a,n);case 2:case"end":return t.stop()}}),_callee2)})));return function(t){return e.apply(this,arguments)}}()),r.next=10;break;case 6:if(!l.isDirectory){r.next=10;break}return console.debug("DIR:"+l.fullPath),r.next=10,s.readDir(l,t,a);case 10:case"end":return r.stop()}}),_loop)})),n=0;case 2:if(!(n<e.length)){r.next=7;break}return r.delegateYield(i(n),"t0",4);case 4:n++,r.next=2;break;case 7:case"end":return r.stop()}}),_callee3)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return i.stop()}}),_callee4,this)})));return function(t,a,s){return e.apply(this,arguments)}}(),this.scanFiles=function(){var e=Object(j.a)(N.a.mark((function _callee5(e,t,a){var s,i,n,l,r,o,d,h,p,c;return N.a.wrap((function _callee5$(u){for(;;)switch(u.prev=u.next){case 0:if($.stageAction.next("open"),!e.dataTransfer){u.next=22;break}s=e.dataTransfer.items,i=0;case 4:if(!(i<s.length)){u.next=20;break}if(n=t,l=s[i],r=l.getAsFile(),!(o=l.webkitGetAsEntry()).isFile){u.next=14;break}return u.next=12,this.processFile(r,n);case 12:u.next=17;break;case 14:if(!o.isDirectory){u.next=17;break}return u.next=17,this.readDir(o,r,n);case 17:i++,u.next=4;break;case 20:u.next=23;break;case 22:if(a){d=t,h=Object(F.a)(a);try{for(h.s();!(p=h.n()).done;)c=p.value,this.processFile(c,d)}catch(g){h.e(g)}finally{h.f()}}case 23:case"end":return u.stop()}}),_callee5,this)})));return function(t,a,s){return e.apply(this,arguments)}}()}},J=a(716),X=a(783),Q=a(756),Z=a(717),ee=a(757),te=a(143),ae=a(214),se=a.n(ae);class Sidebar_Sidebar extends i.Component{constructor(e,t){super(e),this.handleNavClick=this.handleNavClick.bind(this)}shouldComponentUpdate(e,t){return e.open!==this.props.open||e.user!==this.props.user||e.apps!==this.props.apps||e.secondaryApps!==this.props.secondaryApps}handleNavClick(e){this.props.onNavClick&&this.props.onNavClick(e)}handleLogout(){window.localStorage.clear(),B.logout.source.next(!0),B.navigateTo.next("://")}findApp(e,t){if(t){var a,s=Object(F.a)(t);try{for(s.s();!(a=s.n()).done;){var i=a.value;if(i.slug===e)return i}}catch(n){s.e(n)}finally{s.f()}}return null}render(){var e=this.props.classes,t=this.findApp("usermanager",this.props.secondaryApps);return n.a.createElement(J.a,{className:this.props.open?e.sidebarOpen:e.sidebarClosed},n.a.createElement(J.a,{className:this.props.open?e.sidebarUserInfo:e.sidebarUserInfoClosed},n.a.createElement("div",{className:e.sidebarProfileIcon},n.a.createElement(se.a,{style:{width:60,height:60}})),n.a.createElement("div",{className:e.sidebarProfileName},n.a.createElement(te.a,{component:"div",type:"title"},this.props.user.firstName," ",this.props.user.lastName)),n.a.createElement("div",{className:e.sidebarButtons},n.a.createElement(E.a,{onClick:this.handleLogout},"Logout"),t&&n.a.createElement(E.a,{onClick:()=>B.navigateTo.next(t.path)},"Profile"))),n.a.createElement("div",{className:this.props.open?e.appListsOpen:e.appListsClosed},n.a.createElement("div",{style:{gridColumn:"1",gridRow:"1"}},n.a.createElement(te.a,{type:"title",className:this.props.open?e.openLabel:e.closedLabel,style:{paddingLeft:"16px",paddingTop:"16px",gridColumn:"1",gridRow:"1"}},"Apps")),n.a.createElement(Q.a,{style:{gridColumn:"1",gridRow:"2"}},this.props.apps&&this.props.apps.map(t=>n.a.createElement(Z.a,{button:!0,key:t.path,onClick:()=>this.handleNavClick(t.path)},n.a.createElement(X.a,{style:{marginRight:"8px"}},n.a.createElement(D.a,null)),n.a.createElement(ee.a,{secondary:t.label,className:this.props.open?e.openLabel:e.closedLabel})))),n.a.createElement(Q.a,{style:{gridColumn:"1",gridRow:"3"},className:this.props.open?e.closedLabel:e.openLabel},n.a.createElement(Z.a,{button:!0,onClick:()=>this.handleNavClick("://app-usermanager/index.html")},n.a.createElement(X.a,null,n.a.createElement(se.a,{style:{width:48,height:48}}))))))}}var ie=Object(o.c)(Object(y.a)(e=>({sidebarOpen:{width:"240px",height:"100vh",background:"#fff"},sidebarClosed:{width:"72px",height:"100vh",background:"#fff"},sidebarUserInfo:{width:"100%",padding:"8px",display:"grid",gridGap:"8px",gridTemplateRows:"auto",gridTemplateColumns:"60px auto"},sidebarUserInfoClosed:{display:"none"},sidebarProfileIcon:{gridColumn:"1",gridRow:"1"},sidebarProfileName:{gridColumn:"2",gridRow:"1",alignSelf:"center"},sidebarButtons:{gridColumn:"1/3",gridRow:"2",justifySelf:"center"},appListsOpen:{display:"grid",gridGap:"0px",gridTemplateRows:"24px auto",gridTemplateColumns:"auto",marginTop:"16px"},appListsClosed:{height:"90%",display:"grid",gridGap:"0px",gridTemplateRows:"0px auto 72px",gridTemplateColumns:"auto"},openLabel:{display:"inline"},closedLabel:{display:"none"}}))(Sidebar_Sidebar)),ne=a(760),le=a(762),re=a(283),oe=a(761),de=a(272),he=a.n(de),pe=a(271),ce=a.n(pe);class AppHeader_AppHeader extends i.Component{constructor(e,t){super(e),this.state={openMoreMenu:!1},this.handleToggle=this.handleToggle.bind(this),this.handleOpenMoreMenu=this.handleOpenMoreMenu.bind(this),this.handleLogout=this.handleLogout.bind(this)}shouldComponentUpdate(e,t){return e.onToggle!==this.props.onToggle||e.apps!==this.props.apps||t.openMoreMenu!==this.state.openMoreMenu}handleOpenMoreMenu(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}handleToggle(){this.props.onToggle&&this.props.onToggle()}handleNavClick(e){this.props.onNavClick&&this.props.onNavClick(e)}handleMenuClose(){this.setState({openMoreMenu:!1})}handleLogout(){window.localStorage.clear(),B.logout.source.next(!0),window.location="/"}render(){var e=this.props.classes;return n.a.createElement(C.a,{className:e.root,position:"static"},n.a.createElement(k.a,null,n.a.createElement(ne.a,{onClick:this.handleToggle,className:e.menuButton,color:"contrast","aria-label":"Menu"},n.a.createElement(ce.a,null)),n.a.createElement(te.a,{variant:"h5",color:"inherit",className:e.flex,onClick:()=>this.handleNavClick("://home/index.html")},"Family ",n.a.createElement("i",null,"D.A.M")),n.a.createElement(ne.a,{"aria-label":"More","aria-owns":this.state.open?"long-menu":null,"aria-haspopup":"true",onClick:this.handleOpenMoreMenu,className:e.moreButton},n.a.createElement(he.a,null)),n.a.createElement(re.a,{id:"long-menu",keepMounted:!0,anchorEl:this.state.openMoreMenuAnchorEl,open:this.state.openMoreMenu},n.a.createElement(oe.a,{onClick:()=>{this.handleLogout(),this.handleMenuClose()}},"Logout"),n.a.createElement(le.a,null),this.props.apps&&this.props.apps.map(e=>n.a.createElement(oe.a,{key:e.path,color:"contrast",onClick:()=>{this.handleNavClick(e.path),this.handleMenuClose()}},e.label)))))}}var ue=Object(o.c)(Object(y.a)(e=>({root:{width:"100%",height:"64px"},headerContainer:{display:"grid",gridTemplateRows:"auto",gridTemplateColumns:"48px auto 48px"},hamburgerMenu:{display:"block",gridRow:"1",gridColumn:"1"},mainSection:{gridRow:"1",gridColumn:"2"},rightSection:{gridRow:"2",gridColumn:"3",textAlign:"right"},flex:{flex:1},menuButton:{marginLeft:-12,marginRight:20,color:"#ffffff"},moreButton:{color:"#ffffff"}}))(AppHeader_AppHeader));class AppShell_AppShell extends i.Component{constructor(e,t){super(e);var a=window.localStorage.getItem("AppShell.isOpen");a||(a=void 0===e.open||e.open),this.state={isMounted:!0,isOpen:Boolean(a)},this.handleOpenCloseToggle=this.handleOpenCloseToggle.bind(this),this.handleOpenMoreMenu=this.handleOpenMoreMenu.bind(this)}shouldComponentUpdate(e,t){return e.open!==this.props.open||e.user!==this.props.user||e.children!==this.props.children||t.isOpen!==this.state.isOpen||t.primaryApps!==this.state.primaryApps||t.secondaryApps!==this.state.secondaryApps}componentWillMount(){this.setState({isMounted:!0}),B.navigateTo.takeWhile(()=>this.state.isMounted).subscribe(function(e){"://"!==e&&"://"===e.substring(0,3)?window.location.href=e.substring(2):this.props.history&&this.props.history.push(e)}.bind(this)),B.loadClientApps.sink.subscribe(e=>{e&&this.setState({primaryApps:e.primaryApps,secondaryApps:e.secondaryApps})}),B.loadClientApps.source.next(!0)}componentWillUnmount(){this.setState({isMounted:!1})}handleOpenMoreMenu(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}handleOpenCloseToggle(){var e=!this.state.isOpen;this.setState({isOpen:e}),window.localStorage.setItem("AppShell.isOpen",e)}handleLogout(){window.localStorage.clear(),B.logout.source.next(!0),B.navigateTo.next("://")}render(){var e=this.props.classes;return this.props.user?n.a.createElement("div",{className:this.state.isOpen?e.dashboardShellContainerOpen:e.dashboardShellContainerClosed},n.a.createElement("header",{className:e.header},n.a.createElement(ue,{apps:this.state.secondaryApps,onToggle:this.handleOpenCloseToggle,onNavClick:e=>B.navigateTo.next(e)})),n.a.createElement(ie,{user:this.props.user,apps:this.state.primaryApps,secondaryApps:this.state.secondaryApps,open:this.state.isOpen,onNavClick:e=>B.navigateTo.next(e)}),n.a.createElement("div",{className:e.main},this.props.children)):n.a.createElement("div",null)}}var ge=Object(o.c)(Object(w.f)(Object(y.a)(e=>({dashboardShellContainerOpen:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"240px auto"},dashboardShellContainerClosed:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"72px auto"},header:{gridColumn:"1/3",gridRow:"1",position:"inherit",height:"64px"},main:{fontSize:".5rem",background:"#eee"}}))(AppShell_AppShell)));class Breadcrumb_Breadcrumb extends i.Component{constructor(e,t){super(e),this.state={paths:[]}}componentDidMount(){this.parsePath(this.props.path)}componentWillUnmount(){this.currentPathSubscription&&this.currentPathSubscription.dispose()}componentWillReceiveProps(e){e.path&&this.parsePath(e.path)}shouldComponentUpdate(e,t){return e.path!==this.props.path}parsePath(e){for(var t=e.split("/"),a="",s=[],i=[],n=0;n<t.length;n++){var l=t[n];l.trim().length>0&&(a=a+"/"+l,i[n]=l,s.push({label:l,level:n,path:a,style:{color:n>2?"blue":"black",cursor:n>2?"pointer":"default"}}))}this.setState({paths:s})}render(){var e=this.props.classes;return n.a.createElement("div",null,n.a.createElement("ol",{className:e.breadcrumb},this.state.paths.map((function(t){return t.path?n.a.createElement("li",{className:e.li,key:t.path,style:t.style,onClick:()=>B.navigateTo.next(t.path)},t.label):n.a.createElement("li",{className:e.li,key:t.label},t.label)}))))}}var me=Object(y.a)(e=>({breadcrumb:{backgroundColor:"transparent",listStyle:"none",padding:"0px"},li:{float:"left",margin:"0 0 10px 5px",color:"blue",cursor:"pointer","&:before":{content:'"/ "',color:"black"},"&:after":{content:'" "',color:"black"}}}))(Breadcrumb_Breadcrumb),fe=a(127),be=a.n(fe),ve=a(767),we=a(768),ye=a(765),xe=a(764),Fe=a(273),Ce=a.n(Fe),Ee=a(142),ke=a.n(Ee),Se=a(141),De=a.n(Se),Ae=a(781),Oe=a(771),Te=a(770),Ne=a(769),je=a(763),Me=a(784);class FileListTableHead_FileListTableHead extends i.Component{constructor(...e){super(...e),this.createSortHandler=e=>t=>{this.props.onRequestSort(t,e)}}render(){var e=this.props,t=e.classes,a=e.order,s=e.orderBy;return n.a.createElement(je.a,{className:t.tableHead},n.a.createElement(xe.a,null,n.a.createElement(ye.a,{padding:"none",style:{width:"100%",padding:"16px 8px 16px 16px"}},n.a.createElement(Me.a,{active:"name"===s,direction:a,onClick:this.createSortHandler("name")},"Name")),n.a.createElement(ye.a,{padding:"none",style:{minWidth:"200px",padding:"16px 8px"}},n.a.createElement(Me.a,{active:"dam:date.created"===s,direction:a,onClick:this.createSortHandler("dam:date.created")},"Created")),n.a.createElement(ye.a,{padding:"none",style:{textAlign:"center",minWidth:"100px",padding:"16px 8px"}},"Actions")))}}var Re=Object(y.a)(e=>({tableHead:{backgroundColor:"#fff",fontSize:"16px"}}))(FileListTableHead_FileListTableHead);class LoadingButton_LoadingButton extends i.Component{constructor(e,t){e.style||(e.style={}),super(e),this.handleClick=this.handleClick.bind(this)}shouldComponentUpdate(e,t){return e.label!==this.props.label}handleClick(e){console.log("loading button click"),this.props.onClick?this.props.onClick(e):console.dir(this.props)}render(){var e=this.props.classes;return n.a.createElement(E.a,{color:"primary",variant:"contained",className:e.btn,style:this.props.style,onClick:this.handleClick},this.props.isLoading&&n.a.createElement(x.a,{className:e.progress,color:"#fff",size:25}),this.props.label)}}var Le=Object(o.c)(Object(y.a)(e=>({btn:{padding:"4px 12px"},progress:{marginRight:"8px"}}))(LoadingButton_LoadingButton));class FileList_FileList extends i.Component{constructor(e){super(e),this.isCntlPressed=!1,this.isSpacePressed=!1,this.handleClick=(e,t)=>{var a=this.state.selected,s=a.indexOf(t),i=[];this.isCntlPressed,-1===s?i.push(t):i=(i=[]).concat(a.slice(0,s),a.slice(s+1)),this.setState({selected:i}),this.props.onSelectionChange&&this.props.onSelectionChange(i)},this.handleRequestSort=(e,t)=>{var a=t,s="desc";this.state.orderBy===t&&"desc"===this.state.order&&(s="asc");var i="desc"===s?this.state.files.sort((e,t)=>t[a]<e[a]?-1:1):this.state.files.sort((e,t)=>e[a]<t[a]?-1:1);this.setState({data:i,order:s,orderBy:a})},this.state={files:[],rootPath:"/content",isMounted:!0,order:"asc",orderBy:"name",selected:[],showDeleteFileDialog:!1,showDeleteFolderDialog:!1},this.handleFileDelete=this.handleFileDelete.bind(this),this.handleFolderDelete=this.handleFolderDelete.bind(this),this.handleFolderDownload=this.handleFolderDownload.bind(this),this.handleCancelDialog=this.handleCancelDialog.bind(this),this.handleFileDeleteOk=this.handleFileDeleteOk.bind(this),this.handleFolderDeleteOk=this.handleFolderDeleteOk.bind(this)}componentDidMount(){this.setState({isMounted:!0}),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.handleClick=this.handleClick.bind(this),document.addEventListener("keydown",this.handleKeyDown,!1),document.addEventListener("keyup",this.handleKeyUp,!1),document.addEventListener("contextmenu",(function(e){e.preventDefault()}),!1),this.props.files&&this.setState({files:this.props.files}),$.getFileAndFolders.sink.takeWhile(()=>this.state.isMounted).subscribe(e=>{var t=this.state.orderBy,a=e.sort((e,a)=>e["jcr:primaryType"]&&a["jcr:primaryType"]&&e["jcr:primaryType"]!==a["jcr:primaryType"]?e["jcr:primaryType"]>a["jcr:primaryType"]?-1:1:e[t]&&a[t]?e[t].toString().toLowerCase()<a[t].toString().toLowerCase()?-1:1:0);this.setState({files:a})}),$.getFileAndFolders.source.next(this.props.path)}componentWillUnmount(){this.setState({isMounted:!1})}componentWillReceiveProps(e){this.props.path!==e.path&&(this.props=e,$.getFileAndFolders.source.next(this.props.path))}shouldComponentUpdate(e,t){return e.path!==this.props.path||t.files!==this.state.files||t.order!==this.state.order||t.orderBy!==this.state.orderBy||t.showDeleteFolderDialog!==this.state.showDeleteFolderDialog||t.showDeleteFileDialog!==this.state.showDeleteFileDialog}handleKeyDown(e){switch(e.keyCode){case 17:case 91:this.isCntlPressed=!0;break;case 16:this.isSpacePressed=!0}}handleKeyUp(e){switch(e.keyCode){case 17:case 91:this.isCntlPressed=!1;break;case 16:this.isSpacePressed=!1}}handleFileDelete(e){return this.setState({showDeleteFileDialog:!0,pendingFileToDelete:e}),!1}handleFolderDelete(e){return this.setState({showDeleteFolderDialog:!0,pendingFolderToDelete:e}),!1}handleFolderDownload(e){return!1}handleFileDeleteOk(){$.deleteFileOrFolder.source.next(this.state.pendingFileToDelete);var e=this.state.pendingFileToDelete;$.deleteFileOrFolder.sink.subscribe(()=>{this.props.onDelete&&this.props.onDelete(e)}),this.setState({showDeleteFileDialog:!1,pendingFileToDelete:null})}handleFolderDeleteOk(e){$.deleteFileOrFolder.source.next(this.state.pendingFolderToDelete),$.deleteFileOrFolder.sink.subscribe(()=>{this.props.onDelete&&this.props.onDelete(this.state.pendingFolderToDelete)}),this.setState({showDeleteFolderDialog:!1,pendingFolderToDelete:null})}handleCancelDialog(e){this.setState({showDeleteFileDialog:!1,showDeleteFolderDialog:!1,pendingFileToDelete:null})}render(){var e=this.props.classes,t=this.state,a=t.files,s=t.order,i=t.orderBy,l=t.selected,checkIsSelected=e=>-1!==this.state.selected.indexOf(e);return n.a.createElement(J.a,{className:e.root},n.a.createElement("div",{className:e.tableWrapper},n.a.createElement(ve.a,null,n.a.createElement(Re,{numSelected:l.length,order:s,orderBy:i,onRequestSort:this.handleRequestSort,rowCount:a.length}),n.a.createElement(we.a,null,this.state.files.filter(e=>!e.toString().startsWith(".")&&!e.toString().startsWith("jcr:")).map(e=>{var t=checkIsSelected(e.path);return"dam:folder"===e["jcr:primaryType"]||"nt:folder"===e["jcr:primaryType"]?n.a.createElement(FolderRow,{key:e.path,folder:e,isSelected:t,onDelete:this.handleFolderDelete,onDownload:this.handleFolderDownload,onNavigate:e=>B.navigateTo.next(e)}):n.a.createElement(FileRow,{key:e.path,file:e,isSelected:t,onDelete:()=>this.handleFileDelete(e.path),onDownload:this.props.handleFileDownload,onClick:(e,t)=>this.handleClick(e,t),onKeyDown:(e,t)=>this.handleClick(e,t),onNavigate:e=>B.navigateTo.next(e)})})))),n.a.createElement(Ae.a,{ignoreBackdropClick:!0,maxWidth:"sm",open:this.state.showDeleteFileDialog,style:{padding:"8px"}},n.a.createElement(Ne.a,null,"Delete Confirmation"),n.a.createElement(Te.a,null,n.a.createElement(te.a,null,"Are you sure you want to delete this file?")),n.a.createElement(Oe.a,null,n.a.createElement(E.a,{onClick:this.handleCancelDialog,color:"primary"},"Cancel"),n.a.createElement(Le,{isLoading:this.state.isLoading,label:"Delete",onKeyDown:e=>{13===e.keyCode&&this.handleFileDeleteOk()},onClick:this.handleFileDeleteOk}))),n.a.createElement(Ae.a,{ignoreBackdropClick:!0,maxWidth:"sm",open:this.state.showDeleteFolderDialog,style:{padding:"8px"}},n.a.createElement(Ne.a,null,"Delete Confirmation"),n.a.createElement(Te.a,null,n.a.createElement(te.a,null,"Are you sure you want to delete this folder and all of the files in it?")),n.a.createElement(Oe.a,null,n.a.createElement(E.a,{onClick:this.handleCancelDialog,color:"primary"},"Cancel"),n.a.createElement(Le,{isLoading:this.state.isLoading,label:"Delete",onKeyDown:e=>{13===e.keyCode&&this.handleFolderDeleteOk()},onClick:this.handleFolderDeleteOk}))))}}var FolderRow=(e,t)=>n.a.createElement(xe.a,{hover:!0,role:"checkbox",tabIndex:-1,selected:e.isSelected,"aria-checked":e.isSelected},n.a.createElement(ye.a,{padding:"default",style:{padding:"8px 8px 8px 16px"},onClick:()=>e.onNavigate(e.folder.path)},n.a.createElement(D.a,null),n.a.createElement(te.a,{component:"span",style:{display:"inline",paddingLeft:"16px"}},e.folder.name)),n.a.createElement(ye.a,{padding:"default"}),n.a.createElement(ye.a,{padding:"default",style:{padding:"8px",textAlign:"center"}},n.a.createElement(E.a,{onClick:()=>e.onDelete(e.folder.path),style:{minWidth:"24px",padding:"4px"}},n.a.createElement(De.a,null)),n.a.createElement(E.a,{onClick:()=>window.alert("Coming Soon"),style:{minWidth:"24px",padding:"4px"}},n.a.createElement(ke.a,null)))),FileRow=(e,t)=>n.a.createElement(xe.a,{hover:!0,role:"checkbox","aria-checked":e.isSelected,tabIndex:-1,selected:e.isSelected},n.a.createElement(ye.a,{padding:"default",style:{padding:"8px 8px 8px 16px"},onClick:t=>{e.onClick(t,e.file.path)}},e.file.path.toString().toLowerCase().endsWith(".jpg")||e.file.path.toString().toLowerCase().endsWith(".png")?n.a.createElement("img",{src:e.file.path+"?size=100",alt:"",style:{width:"25px"}}):n.a.createElement(Ce.a,null),n.a.createElement(te.a,{style:{display:"inline",paddingLeft:"16px"}},e.file.name)),n.a.createElement(ye.a,{padding:"default",style:{padding:"8px"}},be()(e.file["dam:date.created"]?e.file["dam:date.created"]:e.file["jcr:created"]).format("MMM Do YYYY, h:mm:ss a")),n.a.createElement(ye.a,{padding:"default",style:{padding:"8px",textAlign:"center"}},n.a.createElement(E.a,{onClick:()=>e.onDelete(e.file.path),style:{minWidth:"24px",padding:"4px"}},n.a.createElement(De.a,null)),e.file._links.download&&n.a.createElement(E.a,{onClick:()=>e.onDownload(e.file.name,e.file._links.download),style:{minWidth:"24px",padding:"4px"}},n.a.createElement(ke.a,null)))),_e=Object(w.f)(Object(y.a)(e=>({main:{width:"100%",height:"100%",backgroundColor:"#fff"},root:{gridRow:"1/4",gridColumn:"1/4"},tableWrapper:{overflowX:"auto"}}))(FileList_FileList)),Ue=a(9),Pe=a.n(Ue),We=a(135),Ie=a.n(We);class FileListTableToolbar_FileListTableToolbar extends i.Component{render(){var e=this.props,t=e.files,a=e.classes,s=t.length;return n.a.createElement(k.a,{className:Ie()(a.root,{[a.highlight]:s>0})},n.a.createElement("div",{className:a.title},t.length>1&&n.a.createElement(te.a,{type:"subheading"},s," selected"),1===t.length&&n.a.createElement(te.a,{type:"title"},t[0].substr(t[0].lastIndexOf("/")+1))),n.a.createElement("div",{className:a.spacer}),n.a.createElement("div",{className:a.actions,style:{width:"100px",marginRight:"8px"}},n.a.createElement(ne.a,{"aria-label":"Delete"},n.a.createElement(De.a,{onChange:(e,t)=>{alert("todo")}})),n.a.createElement(ne.a,{"aria-label":"Download"},n.a.createElement(ke.a,{onClixk:(e,a)=>{this.props.handleDownload(t[0].name,t[0].path)}}))))}}var Be=Object(y.a)(e=>({root:{paddingRight:2},highlight:"light"===e.palette.type?{color:e.palette.secondary.A700,backgroundColor:e.palette.secondary.A100}:{color:e.palette.secondary.A100,backgroundColor:e.palette.secondary.A700},spacer:{flex:"1 1 100%"},actions:{color:e.palette.text.secondary,display:"flex"},title:{flex:"0 0 auto",overflow:"hidden",maxWidth:"250px",overflowWrap:"break-word"}}))(FileListTableToolbar_FileListTableToolbar),He=a(782),Ke=a(785),Ge=a(778),Ve=a(779),Ye=a(772);class SingleImageView_SingleImageView extends i.Component{constructor(e,t){super(e,t),this.state={keyword:"",tabIndex:this.props.tabIndex?this.props.tabIndex:0},this.handleTabChange=this.handleTabChange.bind(this),this.handleAddKeywordChange=this.handleAddKeywordChange.bind(this),this.handleAddKeywordClick=this.handleAddKeywordClick.bind(this),this.handleKeywordDelete=this.handleKeywordDelete.bind(this)}handleAddKeywordChange(e){this.setState({keyword:e.target.value})}handleAddKeywordClick(e,t){var a,s=this.props.node["dam:tags"],i=this.state.keyword.split(","),n=Object(F.a)(i);try{for(n.s();!(a=n.n()).done;){var l=a.value;s.push(l)}}catch(r){n.e(r)}finally{n.f()}this.props.handleTagChange(s),this.setState({keyword:""})}handleKeywordDelete(e){for(var t=[],a=this.props.node["dam:tags"],s=0;s<a.length;s++)a[s]!==e&&t.push(a[s]);this.props.handleTagChange(t),this.props.node["dam:tags"]=t}handleTabChange(e,t){this.setState({tabIndex:t})}render(){var e=this.props.classes;return n.a.createElement("div",{className:e.gridListRoot},n.a.createElement("div",{className:e.itemPreview},n.a.createElement("div",{style:{height:"100%",maxWidth:"100%",textAlign:"center"}},n.a.createElement("img",{src:W.baseHost.getValue()+this.props.node.path,alt:this.props.node.path,style:{maxHeight:"100%",maxWidth:"100%",alignSelf:"center"}}))),n.a.createElement("div",{className:e.itemRating},n.a.createElement(He.a,{name:"img-ratings",value:this.props.node["dam:rating"],onChange:this.props.handleRatingChange,style:{float:"right"}})),n.a.createElement("div",{className:e.itemKeywords},n.a.createElement(te.a,{variant:"h6"},"Keywords:"),n.a.createElement("div",null,this.props.node["dam:tags"]&&this.props.node["dam:tags"].map(e=>n.a.createElement(Ke.a,{size:"small",label:e,onDelete:()=>this.handleKeywordDelete(e)}))),n.a.createElement("div",null,n.a.createElement(Ge.a,{id:"addKeyword",ref:"addKeywordField",label:"Add Keyword",margin:"normal",value:this.state.keyword,style:{width:"75%"},onChange:this.handleAddKeywordChange}),n.a.createElement(E.a,{color:"primary",style:{verticalAlign:"bottom"},disabled:0==this.state.keyword.length,onClick:this.handleAddKeywordClick},"Add"))),n.a.createElement("div",{className:e.itemInfo},n.a.createElement("hr",{style:{width:"100%"}}),n.a.createElement(Ve.a,{value:"Details",indicatorColor:"primary",textColor:"primary",variant:"fullWidth",onChange:this.props.handleTabChange},n.a.createElement(Ye.a,{label:"Details"}),n.a.createElement(Ye.a,{label:"Versions"})),0===this.state.tabIndex&&n.a.createElement("div",null,n.a.createElement(ve.a,null,n.a.createElement(we.a,null,n.a.createElement(xe.a,{style:{padding:"8px"}},n.a.createElement(ye.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Type"),n.a.createElement(ye.a,{align:"left"},this.props.node["jcr:content"]["jcr:mimeType"])),n.a.createElement(xe.a,null,n.a.createElement(ye.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Resolution"),n.a.createElement(ye.a,{align:"left"},this.props.node.width," x ",this.props.node.height)),n.a.createElement(xe.a,null,n.a.createElement(ye.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Created"),n.a.createElement(ye.a,{align:"left"},be()(this.props.node["dam:date.created"]).format("MMM Do YYYY, h:mm:ss a"))),n.a.createElement(xe.a,null,n.a.createElement(ye.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Modified"),n.a.createElement(ye.a,{align:"left"},be()(this.props.node["jcr:lastModified"]).format("MMM Do YYYY, h:mm:ss a")))))),1===this.state.tabIndex&&n.a.createElement("div",null,"Versions Panel")))}}var ze=Object(y.a)(e=>({gridListRoot:{margin:"24px",display:"grid",gridGap:"8px",gridTemplateRows:"175px 25px 50px 3fr",gridTemplateColumns:"16px auto 16px",background:e.palette.background.paper,justifyContent:"center"},itemPreview:{gridRow:"1",gridColumn:"2",justifyContent:"center"},itemRating:{gridRow:"2",gridColumn:"2"},itemKeywords:{gridRow:"3/5",gridColumn:"2"},itemInfo:{gridRow:"5",gridColumn:"2"}}))(SingleImageView_SingleImageView),$e=a(773),qe=a(774);class MultiImageView_MultiImageView extends i.Component{constructor(e,t){super(e,t),this.state={}}render(){var e=this.props.classes;return n.a.createElement("div",{className:e.gridListRoot},n.a.createElement("div",{className:e.itemPreview},n.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden"}},n.a.createElement($e.a,{cellHeight:160,style:{width:"100%",height:"100%"},cols:3},this.props.nodes.map(e=>n.a.createElement(qe.a,{key:e.path,cols:e.cols||1},n.a.createElement("img",{src:W.baseHost.getValue()+e.path,alt:e["jcr:path"],style:{height:"100%",maxWidth:"100%",alignSelf:"center"}})))))))}}var Je=Object(y.a)(e=>({gridListRoot:{margin:"24px",display:"grid",gridGap:"8px",gridTemplateRows:"175px 25px 50px 3fr",gridTemplateColumns:"16px auto 16px",background:e.palette.background.paper,justifyContent:"center"},itemPreview:{gridRow:"1",gridColumn:"2",justifyContent:"center"}}))(MultiImageView_MultiImageView);class FileInfoSidebar_FileInfoSidebar extends i.Component{constructor(e,t){super(e),this.state={fileNodes:[],isMounted:!0,tabIndex:0}}componentWillMount(){this.setState({isMounted:!0,fileActions:$}),this.handleRatingChange=this.handleRatingChange.bind(this),this.handleTagChange=this.handleTagChange.bind(this),this.props.fileNodes?this.setState({fileNodes:this.props.fileNodes}):($.getFileData.sink.takeWhile(()=>this.state.isMounted).subscribe(e=>{console.log(JSON.stringify(e)),this.setState({fileNodes:e})}),$.getFileData.source.next(this.props.files))}componentWillUnmount(){this.setState({isMounted:!1})}componentWillReceiveProps(e){this.props=e,$.getFileData.source.next(this.props.files)}handleRatingChange(e,t){var a=this.state.fileNodes;a[0]["dam:rating"]=t,this.setState({fileNodes:a});var s={path:this.props.files[0],"dam:rating":t};$.setFileProperty.source.next(s)}handleTagChange(e){var t=e;Array.isArray(e)||(t=e.split(","));var a=this.state.fileNodes;a[0]["dam:tags"]=t,this.setState({fileNodes:a});var s={path:this.props.files[0],"dam:tags":t};this.state.fileActions.setFileProperty.source.next(s)}render(){this.props.classes;return n.a.createElement(J.a,{style:this.props.style},n.a.createElement(Be,{onDownload:this.props.handleDownload,files:this.props.files}),1===this.state.fileNodes.length&&this.state.fileNodes[0]["jcr:mixinTypes"].indexOf("dam:image")>-1&&n.a.createElement(ze,{node:this.state.fileNodes[0],tabIndex:this.state.tabIndex,handleTabChange:this.handleTabChange,handleRatingChange:this.handleRatingChange,handleTagChange:this.handleTagChange}),this.state.fileNodes.length>1&&n.a.createElement(Je,{nodes:this.state.fileNodes}))}}FileList.propTypes={files:Pe.a.array.isRequired};var Xe=Object(w.f)(Object(y.a)(e=>({gridSingleItemInfo:{},title:{color:e.palette.primary[200]},titleBar:{background:"linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 70%, rgba(0,0,0,0) 100%)"}}))(FileInfoSidebar_FileInfoSidebar)),Qe=a(275),Ze=a.n(Qe),et=a(775),tt=a(776),at=a(276),st=a.n(at);function SlideTransition(e){return n.a.createElement(et.a,Object.assign({direction:"up"},e))}class UploadDialog_UploadDialog extends i.Component{constructor(e,t){super(e),this.state={isMounted:!0,isReceiverOpen:!1,files:[],filter:"all"},this.handleClose=this.handleClose.bind(this)}componentDidMount(){this.setState({isMounted:!0}),$.uploadProgress.subscribe(e=>{for(var t=[],a=0;a<this.props.files.length;a++){var s=this.props.files[a];e.id===s.id&&100!==e.progress&&(s.progress=e.progress),t.push(s)}this.setState({files:t})}),$.uploadError.subscribe(e=>{for(var t=[],a=0;a<this.props.files.length;a++){var s=this.props.files[a];e.id===s.id&&(s.error=e.error),t.push(s)}this.setState({files:t})}),setTimeout(()=>this.startFileUploads(this.props.files),500)}componentWillUnmount(){this.setState({isMounted:!1})}componentWillReceiveProps(e){this.props=e,setTimeout(()=>this.startFileUploads(this.props.files),1e3)}handleClose(){this.setState({files:[],filter:"all"}),this.props.onClose&&this.props.onClose()}startFileUploads(e){if(this.props.files.length>0){for(var t=0;t<Math.min(3,this.props.files.length);t++);var a,s=Object(F.a)(this.props.files);try{for(s.s();!(a=s.n()).done;){var i=a.value;"uploadReady"===i.status&&(i.status="uploading",$.uploadFile.source.next(i))}}catch(n){s.e(n)}finally{s.f()}}}render(){var e=this.props.classes,t=this.props.files.filter(e=>100===e.progress).length,a=t/this.props.files.length*100,s=this.props.files.filter(e=>"completed"===this.state.filter?100===e.progress:"uploading"===this.state.filter?e.progress>0&&e.progress<100:"waiting"!==this.state.filter||0===e.progress);return s.sort((e,t)=>e.progress<t.progress?1:e.progress>t.progress?-1:0),n.a.createElement(Ae.a,{maxWidth:"lg",fullWidth:!0,open:this.props.open,transition:SlideTransition,classes:{paper:e.dialogPaper}},n.a.createElement(C.a,{className:e.appBar},n.a.createElement(k.a,null,n.a.createElement(te.a,{type:"title",color:"inherit",className:e.flex},"Adding Files"),n.a.createElement(E.a,{onClick:this.handleClose,style:{color:"white"}},"close"))),this.props.files.length>0&&n.a.createElement("div",{style:{position:"absolute",top:"80px",right:"24px",left:"24px"}},n.a.createElement(te.a,{style:{display:"inline"}},t," / ",this.props.files.length),n.a.createElement(tt.a,{variant:"determinate",value:Math.min(a,100)}),n.a.createElement(te.a,null,"Files will be added to: ",n.a.createElement("strong",null,this.props.path))),this.props.files.length>0&&s.length>0&&n.a.createElement("div",{style:{height:"100%",overflow:"scroll",position:"absolute",top:"148px",bottom:"24px",left:"16px",right:"16px"}},n.a.createElement(ve.a,null,n.a.createElement(je.a,null,n.a.createElement(xe.a,null,n.a.createElement(ye.a,{style:{width:"32px",padding:"0 8px 0 8px"}}),n.a.createElement(ye.a,{style:{width:"100%",padding:"0 8px 0 8px"}},"Name"),n.a.createElement(ye.a,{style:{width:"50px",padding:"0 8px 0 8px"},numeric:!0},"Size"),n.a.createElement(ye.a,{style:{width:"50px",padding:"0 8px 0 8px"},numeric:!0},"Progress"))),n.a.createElement(we.a,null,s.map(e=>e.progress<100?n.a.createElement(xe.a,{key:e.id},n.a.createElement(ye.a,{style:{padding:"0 8px 0 8px"}},e.progress>0?n.a.createElement(x.a,{size:24}):n.a.createElement(st.a,{color:"primary"})),n.a.createElement(ye.a,{style:{padding:"0 8px 0 8px"}},n.a.createElement(te.a,null,e.name),n.a.createElement(te.a,{variant:"caption"},e.relativePath," ",e.error),n.a.createElement(tt.a,{variant:"determinate",value:e.progress,style:{height:"4px"}})),n.a.createElement(ye.a,{style:{padding:"0 8px 0 8px"},numeric:!0},Ze()(e.size,{base:10})),n.a.createElement(ye.a,{style:{padding:"0 8px 0 8px"},numeric:!0},Math.round(e.progress),"%")):"")))))}}var it=Object(y.a)(e=>({appBar:{position:"relative"},flex:{flex:1},dialogPaper:{minHeight:"90%"}}))(UploadDialog_UploadDialog);function NewFolderDialog_SlideTransition(e){return n.a.createElement(et.a,Object.assign({direction:"up"},e))}class NewFolderDialog_NewFolderDialog extends i.Component{constructor(e,t){super(e),this.state={folderName:""},this.handleSave=this.handleSave.bind(this)}componentDidMount(){this.setState({isMounted:!0})}componentWillUnmount(){this.setState({isMounted:!1})}handleSave(){$.createFolder.source.next({name:this.state.folderName,path:this.props.path}),$.createFolder.sink.subscribe(()=>{this.props.onClose&&this.props.onClose()})}render(){return n.a.createElement(Ae.a,{maxWidth:"md",fullScreen:!1,open:this.props.open,transition:NewFolderDialog_SlideTransition},n.a.createElement(Ne.a,null,"Create New Folder"),n.a.createElement(Te.a,null,n.a.createElement(Ge.a,{id:"newFolderName",label:"Folder Name",value:this.state.folderName,onChange:e=>this.setState({folderName:e.target.value}),margin:"dense"})),n.a.createElement(Oe.a,null,n.a.createElement(E.a,{onClick:this.props.onClose,color:"primary"},"Close"),n.a.createElement(E.a,{raised:!0,color:"primary",onClick:this.handleSave},"Save")),n.a.createElement("input",{type:"file",ref:"fileInputField",multiple:!0,style:{display:"none"},onChange:this.handleFileChange}),n.a.createElement("input",{type:"file",ref:"folderInputField",style:{display:"none"},onChange:this.handleFolderChange}))}}var nt=Object(y.a)(e=>({}))(NewFolderDialog_NewFolderDialog),lt=a(277);class FileReceiver_FileReceiver extends i.Component{constructor(e,t){super(e),this.state={isMounted:!0},this.handleOnDragEnter=this.handleOnDragEnter.bind(this),this.handleOnDragOver=this.handleOnDragOver.bind(this),this.handleOnDragLeave=this.handleOnDragLeave.bind(this),this.handleAddFile=this.handleAddFile.bind(this)}componentWillMount(){this.setState({isMounted:!0})}componentWillUnmount(){this.setState({isMounted:!1})}componentWillReceiveProps(e){this.props=e}handleOnDragEnter(e){this.setState({isReceiverOpen:!0})}handleOnDragOver(e){this.state.isReceiverOpen&&this.setState({isReceiverOpen:!0})}handleOnDragLeave(e){this.setState({isReceiverOpen:!1})}handleAddFile(e,t){(new q).scanFiles(e,this.props.path,t)}render(){return n.a.createElement(lt.Receiver,{onDragEnter:this.handleOnDragEnter,onDragOver:this.handleOnDragOver,onDragLeave:this.handleOnDragLeave,onFileDrop:this.handleAddFile})}}var rt=FileReceiver_FileReceiver;class FilesPage_FilesPage extends i.Component{constructor(e,t){super(e),this.state={isMounted:!1,isLoading:!1,canAddFile:!0,canAddFolder:!0,showAddFolderDialog:!1,showUploadSidebar:!1,showNewFolderDialog:!1,selectedFiles:[],uploadFiles:[],root:"/content",visibleRoot:"/content/files",path:"/content/files"},this.handleFileSelectionChange=this.handleFileSelectionChange.bind(this),this.handleUploadClosed=this.handleUploadClosed.bind(this),this.handleAfterOnDelete=this.handleAfterOnDelete.bind(this),this.handleFileSelect=this.handleFileSelect.bind(this),this.handleFileChange=this.handleFileChange.bind(this)}componentWillMount(){this.setState({isMounted:!0}),this.validatePath()}componentDidMount(){B.navigateTo.takeWhile(()=>this.state.isMounted).subscribe(e=>{console.log("{FilesPage} navigateTo="+e),"://"===e.substring(0,3)?window.location.href.substring(window.location.href.indexOf("#")+1)!==e.substring(2)&&(window.location.href=e.substring(2)):this.props.history.push(e)}),$.stageFile.bufferTime(5).subscribe(e=>{if(e.length>0){var t,a=this.state.uploadFiles,s=Object(F.a)(e);try{for(s.s();!(t=s.n()).done;){var i=t.value;a.push(i)}}catch(n){s.e(n)}finally{s.f()}console.log("stage file || files="+e.length+"/"+a.length),this.setState({showUploadDialog:!0,uploadFiles:a})}}),$.stageAction.subscribe(e=>{this.setState({showUploadDialog:!0})})}componentWillUnmount(){this.setState({isMounted:!1})}componentWillReceiveProps(e){this.props=e,this.validatePath()}shouldComponentUpdate(e,t){return e.path!==this.props.path||e.location!==this.props.location||e.user!==this.props.user||t.path!==this.state.path||t.root!==this.state.root||t.selectedFiles!==this.state.selectedFiles||t.showUploadDialog!==this.state.showUploadDialog||t.showNewFolderDialog!==this.state.showNewFolderDialog}validatePath(){var e=this.props.path;this.props.location.pathname&&this.props.location.pathname.toString().startsWith(this.state.visibleRoot)&&(e=this.props.location.pathname),e||(e=this.state.visibleRoot),e.toString().startsWith(this.state.visibleRoot)?this.setState({path:e}):console.log("Invalid Path: "+e)}handleFileSelect(){this.refs.fileInputField.click()}handleFileSelectionChange(e){this.setState({selectedFiles:e,showUploadSidebar:!1})}handleUploadClosed(){this.setState({showUploadDialog:!1,uploadFiles:[]}),$.getFileAndFolders.source.next(this.state.path)}handleAfterOnDelete(e){for(var t=[],a=0;a<this.state.selectedFiles.length;a++){var s=this.state.selectedFiles[a];s!==e&&t.push(s)}this.setState({selectedFiles:t}),$.getFileAndFolders.source.next(this.state.path)}handleFileChange(e,t){(new q).scanFiles(e,this.state.path,e.target.files)}handleFileDownload(e,t){var a=document.createElement("a");return document.body.appendChild(a),a.href=t,a.download=e,a.click(),!1}render(){var e=this.props.classes,t=this.state.showUploadSidebar||this.state.uploadFiles.length>0||this.state.selectedFiles.length>0;return this.state.isLoading?n.a.createElement(ge,{user:this.props.user},n.a.createElement(x.a,{className:e.progress,size:50})):n.a.createElement(ge,{user:this.props.user,open:!1},n.a.createElement("div",{className:e.fileGrid},n.a.createElement(C.a,{color:"default",position:"static",elevation:0,className:e.fileGridAppBar,style:{colorDefault:"#eeeeee"}},n.a.createElement(k.a,{className:e.toolbarContainer},n.a.createElement(ne.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu"},n.a.createElement(D.a,null)),n.a.createElement(te.a,{variant:"h6",className:e.title},n.a.createElement(me,{root:this.state.root,path:this.state.path})),n.a.createElement("div",null,n.a.createElement(E.a,{color:"primary",disabled:!this.state.canAddFile,onClick:this.handleFileSelect},n.a.createElement(D.a,null),"\xa0\xa0Add Files"),n.a.createElement(E.a,{label:"New Folder",color:"primary",disabled:!this.state.canAddFolder,onClick:()=>{this.setState({showNewFolderDialog:!0})}},n.a.createElement(O.a,null),"\xa0\xa0New Folder")))),n.a.createElement("div",{className:e.fileGridFileList,style:{gridColumn:t?"1/2":"1/3"}},n.a.createElement(rt,{path:this.state.path,onFileDrop:this.handleOnFileDrop}),n.a.createElement(_e,{path:this.state.path,onSelectionChange:this.handleFileSelectionChange,onDelete:this.handleAfterOnDelete,style:{gridRow:"1 / 4",gridColumn:"1 / 3"}})),n.a.createElement(Xe,{files:this.state.selectedFiles,className:e.fileGridSidebar,onDelete:this.handleAfterOnDelete,onDownload:this.handleFileDownload,style:{display:this.state.selectedFiles.length>0?"block":"none"}}),n.a.createElement(it,{onClose:this.handleUploadClosed,open:this.state.showUploadDialog,files:this.state.uploadFiles,path:this.state.path}),n.a.createElement(nt,{onClose:()=>{this.setState({showNewFolderDialog:!1})},open:this.state.showNewFolderDialog,path:this.state.path})),n.a.createElement("input",{type:"file",ref:"fileInputField",multiple:!0,style:{display:"none"},onChange:this.handleFileChange}))}}var ot=Object(o.c)(Object(w.f)(Object(y.a)(e=>({progress:{margin:"0 ".concat(2*e.spacing.unit,"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},toolbarContainer:{},fileGrid:{height:"100%",display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"4fr minmax(2px, 400px)"},fileGridAppBar:{gridRow:"1",gridColumn:"1/3"},fileGridFileList:{gridRow:"2",gridColumn:"1",margin:"24px"},fileGridSidebar:{gridRow:"2",gridColumn:"2",margin:"24px"},filePondSidebar:{gridRow:"2",gridColumn:"2",margin:"24px"},mainGrid:{height:"100%",overflow:"scroll",display:"grid",gridGap:"16px",gridTemplateRows:"1fr 1fr 1fr",gridTemplateColumns:"2fr 6fr"},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}))(FilesPage_FilesPage)));var dt=class GetUserService_GetUsersService{constructor(e,t){this.sink=void 0,this.sink=t,e.subscribe(this.getUser.bind(this))}getUser(e){var t=W.baseHost.getValue();fetch(t+"/api/v1/auth/user/me",{method:"GET"}).then(e=>(e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e)).then(e=>e.json()).then(e=>{e.firstName||(e.firstName=e.username),this.sink.next(e)}).catch(e=>{if(401===e.status||403===e.status)window.location="/";else{var t={code:e.status,status:e.statusText,message:e.responseText||e.message};this.sink.error(t)}})}};var ht=class GetAllUsersService_GetAllUsersService{constructor(e,t,a){this.sink=void 0,this.sink=t,e.subscribe(this.getUsers.bind(this))}getUsers(){var e=this;return Object(j.a)(N.a.mark((function _callee2(){var t,a,s,i;return N.a.wrap((function _callee2$(n){for(;;)switch(n.prev=n.next){case 0:return t=W.baseHost.getValue(),a=t+"/api/v1/auth/users",(s=new Headers).append("pragma","no-cache"),s.append("cache-control","no-cache"),n.next=7,fetch(a,{method:"GET",cache:"no-cache",headers:s}).then(function(){var e=Object(j.a)(N.a.mark((function _callee(e){return N.a.wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.json());case 1:case"end":return t.stop()}}),_callee)})));return function(t){return e.apply(this,arguments)}}()).then(e=>{for(var t=[],a=0;a<e.length;a++){var s=e[a];void 0===s.firstName&&(s.firstName=s.username),t.push(s)}return t.sort((function(e,t){return e.username>t.username?1:e.username<t.username?-1:0}))}).catch(e=>{if(401===e.status||403===e.status)window.location="/";else{var t={code:e.status,status:e.statusText,message:e.responseText||e.message};console.warn(t),setTimeout(()=>{pt.getAllUsers.source.next(!0)},500)}});case 7:(i=n.sent)&&e.sink.next(i);case 9:case"end":return n.stop()}}),_callee2)})))()}};var pt=new class UserActions_UserActions{constructor(){this.getUser={source:new L.Subject,sink:new L.Subject},this.getAllUsers={source:new L.Subject,sink:new L.Subject},this.getUserService=new dt(this.getUser.source,this.getUser.sink),this.getAllUsersService=new ht(this.getAllUsers.source,this.getAllUsers.sink)}};class App_App extends i.Component{constructor(e,t){super(e,t),this.state={context:t,locale:"en-EN",isAuthenticated:!1,isLoading:!0,isMounted:!1},window.location.href.indexOf(":3000")}componentWillMount(){this.setState({isMounted:!0})}componentDidMount(){pt.getUser.sink.takeWhile(()=>this.state.isMounted).subscribe(e=>{e&&this.setState({isAuthenticated:!0,isLoading:!1,user:e})}),pt.getUser.source.next(null)}componentWillUnmount(){this.setState({isMounted:!1})}render(){var e=this.props.classes;return this.state.isLoading?n.a.createElement("div",null,n.a.createElement(x.a,{className:e.progress,size:50})):n.a.createElement(o.a,{locale:"en-EN",key:"en-EN",messages:this.props.i18nMessages["en-EN"]},n.a.createElement(v.a,null,n.a.createElement(w.c,null,n.a.createElement(w.a,{path:"/",component:()=>n.a.createElement(ot,{user:this.state.user})}))))}}var ct=Object(y.a)(e=>({progress:{margin:"0 ".concat(2*e.spacing.unit,"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}))(App_App);Object(o.b)(a(712));var ut={"en-EN":a(713)},gt=Object(h.a)({palette:{type:"light",primary:u.a,secondary:Object(s.a)({},m.a),error:b.a}});!function renderApp(){r.a.render(n.a.createElement(p.a,{theme:gt},n.a.createElement(ct,{i18nMessages:ut})),document.getElementById("root"))}(),function register(){if("serviceWorker"in navigator){if(new URL("/files",window.location).origin!==window.location.origin)return;window.addEventListener("load",()=>{var e="".concat("/files","/service-worker.js");d?function checkValidServiceWorker(e){fetch(e).then(t=>{404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):registerValidSW(e)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(e):registerValidSW(e)})}}()}},[[305,1,2]]]);
//# sourceMappingURL=main.d7df5705.chunk.js.map