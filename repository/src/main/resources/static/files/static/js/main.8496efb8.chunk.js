(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{269:function(e,t){},293:function(e,t,n){e.exports=n(699)},305:function(e,t){},311:function(e,t){},315:function(e,t,n){},580:function(e,t){},581:function(e,t){},698:function(e){e.exports={}},699:function(e,t,n){"use strict";n.r(t);var a=n(177),i=n(0),r=n.n(i),s=n(27),l=n.n(s),o=n(50),c=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function d(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var u=n(282),p=n(768),h=n(279),f=n.n(h),m=n(280),g=n.n(m),b=n(281),v=n.n(b),y=(n(315),n(13)),k=n(15),w=n(25),x=n(24),O=n(26),E=n(106),j=n(92),C=n(8),F=n(753),S=n(19),D=n(745),N=n(741),T=n(746),M=n(88),A=n.n(M),R=n(278),P=n.n(R),L=n(41),W=n.n(L),U=n(94),I=n(270),B=n.n(I),H=n(20),G=n(66),Y=n.n(G),K=function(){function e(t,n){Object(y.a)(this,e),this.sink=void 0,this.sink=n,t.subscribe(this.loadApps.bind(this))}return Object(k.a)(e,[{key:"loadApps",value:function(e){var t=this;Y.a.get("/api/v1/core/clientapps").withCredentials().set("Accept","application/json").end(function(e,n){if(e)if(401===e.status)q.navigateTo.next("/");else if(403===e.status){var a={code:e.status,message:"Invalid Login (todo: show toast)"};t.sink.error(a)}else{console.dir(e);var i={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(i)}else t.sink.next({primaryApps:n.body.apps.primary,secondaryApps:n.body.apps.secondary})})}}]),e}(),V=new function e(){Object(y.a)(this,e),this.baseHost=new H.BehaviorSubject("http://localhost:9000"),this.basicUser=new H.BehaviorSubject(window.localStorage.getItem("u")),this.basicPwd=new H.BehaviorSubject(window.localStorage.getItem("p"))},z=function(){function e(t,n){Object(y.a)(this,e),this.sink=void 0,this.sink=n,t.subscribe(this.getUser.bind(this))}return Object(k.a)(e,[{key:"getUser",value:function(e){var t=this,n=V.baseHost.getValue();fetch(n+"/logout",{method:"GET"}).then(function(e){return e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e}).catch(function(e){if(401===e.status||403===e.status)window.location="/";else{var n={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(n)}})}}]),e}(),q=new function e(){Object(y.a)(this,e),this.navigateTo=new H.Subject,this.logout={source:new H.Subject,sink:new H.Subject},this.loadClientApps={source:new H.Subject,sink:new H.Subject},this.loadClientAppsService=new K(this.loadClientApps.source,this.loadClientApps.sink),this.logoutService=new z(this.logout.source,this.logout.sink)},J=function(){function e(t,n){Object(y.a)(this,e),this.sink=void 0,this.sink=n,t.subscribe(function(e){this.getFilesAndFolders(e)}.bind(this))}return Object(k.a)(e,[{key:"getFilesAndFolders",value:function(e){var t=this,n=V.baseHost.getValue();if(void 0!==e&&e.length>0){var a=n+e;Y.a.get(a).withCredentials().set("Accept","application/json").end(function(e,n){if(e)if(401===e.status)q.navigateTo.next("/");else if(403===e.status)q.alert.next("You do not have permission to access these files");else{var a={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(a)}else{var i=[];n.body&&(i=n.body.filter(function(e){return!e.name.toString().startsWith(".")})),t.sink.next(i)}})}}}]),e}(),Q=function(){function e(t,n){Object(y.a)(this,e),this.sink=void 0,this.sink=n,t.subscribe(function(e){this.getFiles(e)}.bind(this))}return Object(k.a)(e,[{key:"getFiles",value:function(e){var t=this,n=V.baseHost.getValue();if(void 0!==e&&e.length>0){for(var a=[],i=0;i<e.length;i++){var r=e[i],s=Y.a.get(n+r).withCredentials().set("Accept","application/json");a.push(s)}Promise.all(a).then(function(e){for(var n=[],a=0;a<e.length;a++){var i=e[a];n.push(i.body)}t.sink.next(n)}).catch(function(e){console.log(e)})}}}]),e}();n(558)(Y.a);var _=function(){function e(t,n){var a=this;Object(y.a)(this,e),this.sink=void 0,this.fileQueue=new H.Subject,this.sink=n,t.subscribe(function(e){a.fileQueue.next(e)});var i=V.baseHost.getValue();this.fileQueue.flatMap(function(e){if(!Array.isArray(e))return a.uploadNextFile(i,e);for(var t=0;t<e.length;t++){var n=e[t];return a.uploadNextFile(i,n)}},null,3).subscribe(function(e){})}return Object(k.a)(e,[{key:"uploadNextFile",value:function(e,t){var n=this;return t?H.Observable.of(t).flatMap(function(a){return new Promise(function(a,i){return n.uploadFile(e,t).then(function(e){return a(e)}).catch(function(e){var n=1;return t.retry&&(n=t.retry+1),t.progress=0,t.retry=n,t.error="Retrying request ("+n+"/3)",i(e)})})}).retry(2).catch(function(e){return t.error=e.status+": "+e.message,t.progress=0,H.Observable.of(e)}):null}},{key:"uploadFile",value:function(e,t){var n=t.uploadPath;t.webkitRelativePath?n+="/"+t.webkitRelativePath.substr(0,t.webkitRelativePath.lastIndexOf("/")):t.relativePath&&(n+=t.relativePath.substr(0,t.relativePath.lastIndexOf("/")));var a=new FormData;return a.append("name",t.name),a.append("path",n),a.append("destination",n),a.append("file",t),a.append("type",t.type),a.append("size",t.size),a.append("jcr:primaryType","nt:file"),a.append("dam:date.created",t.lastModified),a.append("dam:date.modified",t.lastModified),Y.a.post(e+n).withCredentials().charset("UTF-8").send(a).parse(function(e){var t=e.text;return 0===t.length?{}:JSON.parse(t)}).on("progress",function(e){t.progress=e.percent,Z.uploadProgress.next(t)})}}]),e}(),X=function(){function e(t,n){Object(y.a)(this,e),this.sink=void 0,this.sink=n,t.subscribe(function(e){this.deleteFileOrFolder(e)}.bind(this))}return Object(k.a)(e,[{key:"deleteFileOrFolder",value:function(e){var t=this,n=V.baseHost.getValue();if(void 0!==e&&e.length>0){var a=n+e;Y.a.delete(a).withCredentials().set("Accept","application/json").end(function(e,n){if(e)if(401===e.status)q.navigateTo.next("/");else if(403===e.status)q.alert.next("You do not have permission to access these files");else{var a={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(a)}else t.sink.next(!0)})}}}]),e}(),$=function(){function e(t,n){Object(y.a)(this,e),this.sink=void 0,this.sink=n,t.subscribe(this.createDirectory.bind(this))}return Object(k.a)(e,[{key:"createDirectory",value:function(e){var t=this,n=V.baseHost.getValue(),a=e.name,i=n+e.path+"/"+a,r=new FormData;r.append("name",e.username),r.append("jcr:primaryType","nt:folder"),fetch(i,{method:"POST",body:r}).then(function(e){console.info("CreateFolder success handler"),e.redirected&&(console.debug("redirect to: "+e.url),window.location=e.url),t.sink.next(!0)}).then(function(e){return e.json()}).then(function(e){e.firstName||(e.firstName=e.username),t.sink.next(e)}).catch(function(e){if(console.warn(e),401===e.status)q.navigateTo.next("/");else if(403===e.status)q.alert.next("You do not have permission to add a new user");else{console.error(e);var n={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(n)}})}}]),e}(),Z=new function e(){Object(y.a)(this,e),this.getFileAndFolders={source:new H.Subject,sink:new H.Subject},this.getFileData={source:new H.Subject,sink:new H.Subject},this.uploadFile={source:new H.Subject,sink:new H.Subject},this.deleteFileOrFolder={source:new H.Subject,sink:new H.Subject},this.createFolder={source:new H.Subject,sink:new H.Subject},this.stageAction=new H.Subject,this.stageFile=new H.Subject,this.uploadProgress=new H.Subject,this.uploadCompleted=new H.Subject,this.uploadError=new H.Subject,this.getFilesAndFoldersService=new J(this.getFileAndFolders.source,this.getFileAndFolders.sink),this.getFileDataService=new Q(this.getFileData.source,this.getFileData.sink),this.uploadFileService=new _(this.uploadFile.source,this.uploadFile.sink),this.deleteFileOrFolderService=new X(this.deleteFileOrFolder.source,this.deleteFileOrFolder.sink),this.createFolderService=new $(this.createFolder.source,this.createFolder.sink)},ee=function e(){Object(y.a)(this,e),this.processFile=function(){var e=Object(U.a)(W.a.mark(function e(t,n,a){return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.id||(t.id=B()()),t.progress=0,t.status="uploadReady",t.uploadPath=n,t.uploadProgress=30,a&&(t.relativePath=a),console.debug("FILE:"+t.uploadPath),Z.stageFile.next(t);case 8:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}(),this.readDir=function(){var e=Object(U.a)(W.a.mark(function e(t,n,a){var i;return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=this,t.createReader().readEntries(function(){var e=Object(U.a)(W.a.mark(function e(t){var r,s,l;return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=W.a.mark(function e(r){var s;return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l=t[r],s=l.fullPath,!l.isFile){e.next=6;break}l.file(function(){var e=Object(U.a)(W.a.mark(function e(t){return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.processFile(t,a,s);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),e.next=10;break;case 6:if(!l.isDirectory){e.next=10;break}return console.debug("DIR:"+l.fullPath),e.next=10,i.readDir(l,n,a);case 10:case"end":return e.stop()}},e)}),s=0;case 2:if(!(s<t.length)){e.next=7;break}return e.delegateYield(r(s),"t0",4);case 4:s++,e.next=2;break;case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}},e,this)}));return function(t,n,a){return e.apply(this,arguments)}}(),this.scanFiles=function(){var e=Object(U.a)(W.a.mark(function e(t,n,a){var i,r,s,l,o,c,d,u,p,h,f,m,g;return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Z.stageAction.next("open"),!t.dataTransfer){e.next=22;break}i=t.dataTransfer.items,r=0;case 4:if(!(r<i.length)){e.next=20;break}if(s=n,l=i[r],o=l.getAsFile(),!(c=l.webkitGetAsEntry()).isFile){e.next=14;break}return e.next=12,this.processFile(o,s);case 12:e.next=17;break;case 14:if(!c.isDirectory){e.next=17;break}return e.next=17,this.readDir(c,o,s);case 17:r++,e.next=4;break;case 20:e.next=43;break;case 22:if(!a){e.next=43;break}for(d=n,u=!0,p=!1,h=void 0,e.prev=27,f=a[Symbol.iterator]();!(u=(m=f.next()).done);u=!0)g=m.value,this.processFile(g,d);e.next=35;break;case 31:e.prev=31,e.t0=e.catch(27),p=!0,h=e.t0;case 35:e.prev=35,e.prev=36,u||null==f.return||f.return();case 38:if(e.prev=38,!p){e.next=41;break}throw h;case 41:return e.finish(38);case 42:return e.finish(35);case 43:case"end":return e.stop()}},e,this,[[27,31,35,43],[36,,38,42]])}));return function(t,n,a){return e.apply(this,arguments)}}()},te=n(701),ne=n(743),ae=n(742),ie=n(703),re=n(744),se=n(143),le=n(211),oe=n.n(le),ce=function(e){function t(e,n){var a;return Object(y.a)(this,t),(a=Object(w.a)(this,Object(x.a)(t).call(this,e))).handleNavClick=a.handleNavClick.bind(Object(S.a)(a)),a}return Object(O.a)(t,e),Object(k.a)(t,[{key:"handleNavClick",value:function(e){this.props.onNavClick&&this.props.onNavClick(e)}},{key:"handleLogout",value:function(){window.localStorage.clear(),q.logout.source.next(!0),q.navigateTo.next("://")}},{key:"findApp",value:function(e,t){if(t){var n=!0,a=!1,i=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var l=r.value;if(l.slug===e)return l}}catch(o){a=!0,i=o}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}}return null}},{key:"render",value:function(){var e=this,t=this.props.classes,n=this.findApp("usermanager",this.props.secondaryApps);return r.a.createElement(te.a,{className:this.props.open?t.sidebarOpen:t.sidebarClosed},r.a.createElement(te.a,{className:this.props.open?t.sidebarUserInfo:t.sidebarUserInfoClosed},r.a.createElement("div",{className:t.sidebarProfileIcon},r.a.createElement(oe.a,{style:{width:60,height:60}})),r.a.createElement("div",{className:t.sidebarProfileName},r.a.createElement(se.a,{component:"div",type:"title"},this.props.user.firstName," ",this.props.user.lastName)),r.a.createElement("div",{className:t.sidebarButtons},r.a.createElement(N.a,{onClick:this.handleLogout},"Logout"),n&&r.a.createElement(N.a,{onClick:function(){return q.navigateTo.next(n.path)}},"Profile"))),r.a.createElement("div",{className:this.props.open?t.appListsOpen:t.appListsClosed},r.a.createElement("div",{style:{gridColumn:"1",gridRow:"1"}},r.a.createElement(se.a,{type:"title",className:this.props.open?t.openLabel:t.closedLabel,style:{paddingLeft:"16px",paddingTop:"16px",gridColumn:"1",gridRow:"1"}},"Apps")),r.a.createElement(ae.a,{style:{gridColumn:"1",gridRow:"2"}},this.props.apps&&this.props.apps.map(function(n){return r.a.createElement(ie.a,{button:!0,key:n.path,onClick:function(){return e.handleNavClick(n.path)}},r.a.createElement(ne.a,{style:{marginRight:"8px"}},r.a.createElement(A.a,null)),r.a.createElement(re.a,{primary:n.label,secondary:"",className:e.props.open?t.openLabel:t.closedLabel}))})),r.a.createElement(ae.a,{style:{gridColumn:"1",gridRow:"3"},className:this.props.open?t.closedLabel:t.openLabel},r.a.createElement(ie.a,{button:!0,onClick:function(){return e.handleNavClick("://app-usermanager/index.html")}},r.a.createElement(ne.a,null,r.a.createElement(oe.a,{style:{width:48,height:48}}))))))}}]),t}(i.Component),de=Object(o.c)(Object(C.a)(function(e){return{sidebarOpen:{width:"240px",height:"100vh",background:"#fff"},sidebarClosed:{width:"72px",height:"100vh",background:"#fff"},sidebarUserInfo:{width:"100%",padding:"8px",display:"grid",gridGap:"8px",gridTemplateRows:"auto",gridTemplateColumns:"60px auto"},sidebarUserInfoClosed:{display:"none"},sidebarProfileIcon:{gridColumn:"1",gridRow:"1"},sidebarProfileName:{gridColumn:"2",gridRow:"1",alignSelf:"center"},sidebarButtons:{gridColumn:"1/3",gridRow:"2",justifySelf:"center"},appListsOpen:{display:"grid",gridGap:"0px",gridTemplateRows:"24px auto",gridTemplateColumns:"auto",marginTop:"16px"},appListsClosed:{height:"90%",display:"grid",gridGap:"0px",gridTemplateRows:"0px auto 72px",gridTemplateColumns:"auto"},openLabel:{display:"inline"},closedLabel:{display:"none"}}})(ce)),ue=n(747),pe=n(749),he=n(283),fe=n(748),me=n(272),ge=n.n(me),be=n(271),ve=n.n(be),ye=function(e){function t(e,n){var a;return Object(y.a)(this,t),(a=Object(w.a)(this,Object(x.a)(t).call(this,e))).state={openMoreMenu:!1},a.handleToggle=a.handleToggle.bind(Object(S.a)(a)),a.handleOpenMoreMenu=a.handleOpenMoreMenu.bind(Object(S.a)(a)),a.handleLogout=a.handleLogout.bind(Object(S.a)(a)),a}return Object(O.a)(t,e),Object(k.a)(t,[{key:"handleOpenMoreMenu",value:function(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}},{key:"handleToggle",value:function(){this.props.onToggle&&this.props.onToggle()}},{key:"handleNavClick",value:function(e){this.props.onNavClick&&this.props.onNavClick(e)}},{key:"handleMenuClose",value:function(){this.setState({openMoreMenu:!1})}},{key:"handleLogout",value:function(){window.localStorage.clear(),q.logout.source.next(!0),window.location="/"}},{key:"render2",value:function(){return r.a.createElement("div",null,"header")}},{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement(D.a,{className:t.root,position:"static"},r.a.createElement(T.a,null,r.a.createElement(ue.a,{onClick:this.handleToggle,className:t.menuButton,color:"contrast","aria-label":"Menu"},r.a.createElement(ve.a,null)),r.a.createElement(se.a,{variant:"h5",color:"inherit",className:t.flex,onClick:function(){return e.handleNavClick("://home/index.html")}},"Family ",r.a.createElement("i",null,"D.A.M")),r.a.createElement(ue.a,{"aria-label":"More","aria-owns":this.state.open?"long-menu":null,"aria-haspopup":"true",onClick:this.handleOpenMoreMenu,className:t.moreButton},r.a.createElement(ge.a,null)),r.a.createElement(he.a,{id:"long-menu",keepMounted:!0,anchorEl:this.state.openMoreMenuAnchorEl,open:this.state.openMoreMenu},r.a.createElement(fe.a,{onClick:function(){e.handleLogout(),e.handleMenuClose()}},"Logout"),r.a.createElement(pe.a,null),this.props.apps&&this.props.apps.map(function(t){return r.a.createElement(fe.a,{key:t.path,color:"contrast",onClick:function(){e.handleNavClick(t.path),e.handleMenuClose()}},t.label)}))))}}]),t}(i.Component),ke=Object(o.c)(Object(C.a)(function(e){return{root:{width:"100%",height:"64px"},headerContainer:{display:"grid",gridTemplateRows:"auto",gridTemplateColumns:"48px auto 48px"},hamburgerMenu:{display:"block",gridRow:"1",gridColumn:"1"},mainSection:{gridRow:"1",gridColumn:"2"},rightSection:{gridRow:"2",gridColumn:"3",textAlign:"right"},flex:{flex:1},menuButton:{marginLeft:-12,marginRight:20,color:"#ffffff"},moreButton:{color:"#ffffff"}}})(ye)),we=function(e){function t(e,n){var a;Object(y.a)(this,t),a=Object(w.a)(this,Object(x.a)(t).call(this,e));var i=window.localStorage.getItem("AppShell.isOpen");return i||(i=void 0===e.open||e.open),a.state={isMounted:!0,isOpen:Boolean(i)},a.handleOpenCloseToggle=a.handleOpenCloseToggle.bind(Object(S.a)(a)),a.handleOpenMoreMenu=a.handleOpenMoreMenu.bind(Object(S.a)(a)),a}return Object(O.a)(t,e),Object(k.a)(t,[{key:"componentWillMount",value:function(){var e=this;this.setState({isMounted:!0}),q.navigateTo.takeWhile(function(){return e.state.isMounted}).subscribe(function(e){"://"!==e&&"://"===e.substring(0,3)?window.location.href=e.substring(2):this.props.history&&this.props.history.push(e)}.bind(this)),q.loadClientApps.sink.subscribe(function(t){t&&e.setState({primaryApps:t.primaryApps,secondaryApps:t.secondaryApps})}),q.loadClientApps.source.next(!0)}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}},{key:"handleOpenMoreMenu",value:function(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}},{key:"handleOpenCloseToggle",value:function(){var e=!this.state.isOpen;this.setState({isOpen:e}),window.localStorage.setItem("AppShell.isOpen",e)}},{key:"handleLogout",value:function(){window.localStorage.clear(),q.logout.source.next(!0),q.navigateTo.next("://")}},{key:"render",value:function(){var e=this.props.classes;return this.props.user?r.a.createElement("div",{className:this.state.isOpen?e.dashboardShellContainerOpen:e.dashboardShellContainerClosed},r.a.createElement("header",{className:e.header},r.a.createElement(ke,{apps:this.state.secondaryApps,onToggle:this.handleOpenCloseToggle,onNavClick:function(e){return q.navigateTo.next(e)}})),r.a.createElement(de,{user:this.props.user,apps:this.state.primaryApps,secondaryApps:this.state.secondaryApps,open:this.state.isOpen,onNavClick:function(e){return q.navigateTo.next(e)}}),r.a.createElement("div",{className:e.main},this.props.children)):r.a.createElement("div",null)}}]),t}(i.Component),xe=Object(o.c)(Object(j.f)(Object(C.a)(function(e){return{dashboardShellContainerOpen:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"240px auto"},dashboardShellContainerClosed:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"72px auto"},header:{gridColumn:"1/3",gridRow:"1",position:"inherit",height:"64px"},main:{background:"#eee"}}})(we))),Oe=function(e){function t(e,n){var a;return Object(y.a)(this,t),(a=Object(w.a)(this,Object(x.a)(t).call(this,e))).state={paths:[]},a}return Object(O.a)(t,e),Object(k.a)(t,[{key:"componentDidMount",value:function(){this.parsePath(this.props.path)}},{key:"componentWillUnmount",value:function(){this.currentPathSubscription&&this.currentPathSubscription.dispose()}},{key:"componentWillReceiveProps",value:function(e){e.path&&this.parsePath(e.path)}},{key:"parsePath",value:function(e){for(var t=e.split("/"),n="",a=[],i=[],r=0;r<t.length;r++){var s=t[r];s.trim().length>0&&(n=n+"/"+s,i[r]=s,a.push({label:s,level:r,path:n,style:{color:r>2?"blue":"black",cursor:r>2?"pointer":"default"}}))}this.setState({paths:a})}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement("div",null,r.a.createElement("ol",{className:e.breadcrumb},this.state.paths.map(function(t){return t.path?r.a.createElement("li",{className:e.li,key:t.path,style:t.style,onClick:function(){return q.navigateTo.next(t.path)}},t.label):r.a.createElement("li",{className:e.li,key:t.label},t.label)})))}}]),t}(i.Component),Ee=Object(C.a)(function(e){return{breadcrumb:{backgroundColor:"transparent",listStyle:"none",padding:"0px"},li:{float:"left",margin:"0 0 10px 5px",color:"blue",cursor:"pointer","&:before":{content:'"/ "',color:"black"},"&:after":{content:'" "',color:"black"}}}})(Oe),je=n(140),Ce=n.n(je),Fe=n(754),Se=n(755),De=n(752),Ne=n(751),Te=n(274),Me=n.n(Te),Ae=n(142),Re=n.n(Ae),Pe=n(141),Le=n.n(Pe),We=n(767),Ue=n(758),Ie=n(757),Be=n(756),He=n(750),Ge=n(769),Ye=function(e){function t(){var e,n;Object(y.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(w.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(i)))).createSortHandler=function(e){return function(t){n.props.onRequestSort(t,e)}},n}return Object(O.a)(t,e),Object(k.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.order,a=e.orderBy;return r.a.createElement(He.a,{className:t.tableHead},r.a.createElement(Ne.a,null,r.a.createElement(De.a,{padding:"none",style:{width:"100%",padding:"16px 8px 16px 16px"}},r.a.createElement(Ge.a,{active:"name"===a,direction:n,onClick:this.createSortHandler("name")},"Name")),r.a.createElement(De.a,{padding:"none",style:{minWidth:"200px",padding:"16px 8px"}},r.a.createElement(Ge.a,{active:"dam:date.created"===a,direction:n,onClick:this.createSortHandler("dam:date.created")},"Created")),r.a.createElement(De.a,{padding:"none",style:{textAlign:"center",minWidth:"100px",padding:"16px 8px"}},"Actions")))}}]),t}(i.Component),Ke=Object(C.a)(function(e){return{tableHead:{backgroundColor:"#fff",fontSize:"16px"}}})(Ye),Ve=function(e){function t(e,n){var a;return Object(y.a)(this,t),e.style||(e.style={}),(a=Object(w.a)(this,Object(x.a)(t).call(this,e))).handleClick=a.handleClick.bind(Object(S.a)(a)),a}return Object(O.a)(t,e),Object(k.a)(t,[{key:"handleClick",value:function(e){console.log("loading button click"),this.props.onClick?this.props.onClick(e):console.dir(this.props)}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement(N.a,{color:"primary",variant:"contained",className:e.btn,style:this.props.style,onClick:this.handleClick},this.props.isLoading&&r.a.createElement(F.a,{className:e.progress,color:"#fff",size:25}),this.props.label)}}]),t}(i.Component),ze=Object(o.c)(Object(C.a)(function(e){return{btn:{padding:"4px 12px"},progress:{marginRight:"8px"}}})(Ve)),qe=function(e){function t(e){var n;return Object(y.a)(this,t),(n=Object(w.a)(this,Object(x.a)(t).call(this,e))).isCntlPressed=!1,n.isSpacePressed=!1,n.handleClick=function(e,t){var a=n.state.selected,i=a.indexOf(t),r=[];n.isCntlPressed,-1===i?r.push(t):r=(r=[]).concat(a.slice(0,i),a.slice(i+1)),n.setState({selected:r}),n.props.onSelectionChange&&n.props.onSelectionChange(r)},n.handleRequestSort=function(e,t){var a=t,i="desc";n.state.orderBy===t&&"desc"===n.state.order&&(i="asc");var r="desc"===i?n.state.files.sort(function(e,t){return t[a]<e[a]?-1:1}):n.state.files.sort(function(e,t){return e[a]<t[a]?-1:1});n.setState({data:r,order:i,orderBy:a})},n.state={files:[],rootPath:"/content",isMounted:!0,order:"asc",orderBy:"name",selected:[],showDeleteFileDialog:!1,showDeleteFolderDialog:!1},n.handleFileDelete=n.handleFileDelete.bind(Object(S.a)(n)),n.handleFolderDelete=n.handleFolderDelete.bind(Object(S.a)(n)),n.handleFileDownload=n.handleFileDownload.bind(Object(S.a)(n)),n.handleFolderDownload=n.handleFolderDownload.bind(Object(S.a)(n)),n.handleCancelDialog=n.handleCancelDialog.bind(Object(S.a)(n)),n.handleFileDeleteOk=n.handleFileDeleteOk.bind(Object(S.a)(n)),n.handleFolderDeleteOk=n.handleFolderDeleteOk.bind(Object(S.a)(n)),n}return Object(O.a)(t,e),Object(k.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({isMounted:!0}),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.handleClick=this.handleClick.bind(this),document.addEventListener("keydown",this.handleKeyDown,!1),document.addEventListener("keyup",this.handleKeyUp,!1),document.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.props.files&&this.setState({files:this.props.files}),Z.getFileAndFolders.sink.takeWhile(function(){return e.state.isMounted}).subscribe(function(t){var n=e.state.orderBy,a=t.sort(function(e,t){return e["jcr:primaryType"]&&t["jcr:primaryType"]&&e["jcr:primaryType"]!==t["jcr:primaryType"]?e["jcr:primaryType"]>t["jcr:primaryType"]?-1:1:e[n]&&t[n]?e[n].toString().toLowerCase()<t[n].toString().toLowerCase()?-1:1:0});e.setState({files:a})}),Z.getFileAndFolders.source.next(this.props.path)}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function(e){this.props.path!==e.path&&(this.props=e,Z.getFileAndFolders.source.next(this.props.path))}},{key:"handleKeyDown",value:function(e){switch(e.keyCode){case 17:case 91:this.isCntlPressed=!0;break;case 16:this.isSpacePressed=!0}}},{key:"handleKeyUp",value:function(e){switch(e.keyCode){case 17:case 91:this.isCntlPressed=!1;break;case 16:this.isSpacePressed=!1}}},{key:"handleFileDelete",value:function(e){return this.setState({showDeleteFileDialog:!0,pendingFileToDelete:e}),!1}},{key:"handleFolderDelete",value:function(e){return this.setState({showDeleteFolderDialog:!0,pendingFolderToDelete:e}),!1}},{key:"handleFileDownload",value:function(e,t){var n=document.createElement("a");return document.body.appendChild(n),n.href="http://localhost:9000"+t,n.download=e,n.click(),!1}},{key:"handleFolderDownload",value:function(e){return!1}},{key:"handleFileDeleteOk",value:function(){var e=this;Z.deleteFileOrFolder.source.next(this.state.pendingFileToDelete);var t=this.state.pendingFileToDelete;Z.deleteFileOrFolder.sink.subscribe(function(){e.props.onDelete&&e.props.onDelete(t)}),this.setState({showDeleteFileDialog:!1,pendingFileToDelete:null})}},{key:"handleFolderDeleteOk",value:function(e){var t=this;Z.deleteFileOrFolder.source.next(this.state.pendingFolderToDelete),Z.deleteFileOrFolder.sink.subscribe(function(){t.props.onDelete&&t.props.onDelete(t.state.pendingFolderToDelete)}),this.setState({showDeleteFolderDialog:!1,pendingFolderToDelete:null})}},{key:"handleCancelDialog",value:function(e){this.setState({showDeleteFileDialog:!1,showDeleteFolderDialog:!1,pendingFileToDelete:null})}},{key:"render",value:function(){var e=this,t=this.props.classes,n=this.state,a=n.files,i=n.order,s=n.orderBy,l=n.selected;return r.a.createElement(te.a,{className:t.root},r.a.createElement("div",{className:t.tableWrapper},r.a.createElement(Fe.a,null,r.a.createElement(Ke,{numSelected:l.length,order:i,orderBy:s,onRequestSort:this.handleRequestSort,rowCount:a.length}),r.a.createElement(Se.a,null,this.state.files.filter(function(e){return!e.toString().startsWith(".")&&!e.toString().startsWith("jcr:")}).map(function(t){var n,a=(n=t.path,-1!==e.state.selected.indexOf(n));return"dam:folder"===t["jcr:primaryType"]||"nt:folder"===t["jcr:primaryType"]?r.a.createElement(Je,{key:t.path,folder:t,isSelected:a,onDelete:e.handleFolderDelete,onDownload:e.handleFolderDownload,onNavigate:function(e){return q.navigateTo.next(e)}}):r.a.createElement(Qe,{key:t.path,file:t,isSelected:a,onDelete:function(){return e.handleFileDelete(t.path)},onDownload:e.handleFileDownload,onClick:function(t,n){return e.handleClick(t,n)},onKeyDown:function(t,n){return e.handleClick(t,n)},onNavigate:function(e){return q.navigateTo.next(e)}})})))),r.a.createElement(We.a,{ignoreBackdropClick:!0,maxWidth:"sm",open:this.state.showDeleteFileDialog,style:{padding:"8px"}},r.a.createElement(Be.a,null,"Delete Confirmation"),r.a.createElement(Ie.a,null,r.a.createElement(se.a,null,"Are you sure you want to delete this file?")),r.a.createElement(Ue.a,null,r.a.createElement(N.a,{onClick:this.handleCancelDialog,color:"primary"},"Cancel"),r.a.createElement(ze,{isLoading:this.state.isLoading,label:"Delete",onKeyDown:function(t){13===t.keyCode&&e.handleFileDeleteOk()},onClick:this.handleFileDeleteOk}))),r.a.createElement(We.a,{ignoreBackdropClick:!0,maxWidth:"sm",open:this.state.showDeleteFolderDialog,style:{padding:"8px"}},r.a.createElement(Be.a,null,"Delete Confirmation"),r.a.createElement(Ie.a,null,r.a.createElement(se.a,null,"Are you sure you want to delete this folder and all of the files in it?")),r.a.createElement(Ue.a,null,r.a.createElement(N.a,{onClick:this.handleCancelDialog,color:"primary"},"Cancel"),r.a.createElement(ze,{isLoading:this.state.isLoading,label:"Delete",onKeyDown:function(t){13===t.keyCode&&e.handleFolderDeleteOk()},onClick:this.handleFolderDeleteOk}))))}}]),t}(i.Component),Je=function(e,t){return r.a.createElement(Ne.a,{hover:!0,role:"checkbox",tabIndex:-1,selected:e.isSelected,"aria-checked":e.isSelected},r.a.createElement(De.a,{padding:"default",style:{padding:"8px 8px 8px 16px"},onClick:function(){return e.onNavigate(e.folder.path)}},r.a.createElement(A.a,null),r.a.createElement(se.a,{component:"span",style:{display:"inline",paddingLeft:"16px"}},e.folder.name)),r.a.createElement(De.a,{padding:"default"}),r.a.createElement(De.a,{padding:"default",style:{padding:"8px",textAlign:"center"}},r.a.createElement(N.a,{onClick:function(){return e.onDelete(e.folder.path)},style:{minWidth:"24px",padding:"4px"}},r.a.createElement(Le.a,null)),r.a.createElement(N.a,{onClick:function(){return window.alert("Coming Soon")},style:{minWidth:"24px",padding:"4px"}},r.a.createElement(Re.a,null))))},Qe=function(e,t){return r.a.createElement(Ne.a,{hover:!0,role:"checkbox","aria-checked":e.isSelected,tabIndex:-1,selected:e.isSelected},r.a.createElement(De.a,{padding:"default",style:{padding:"8px 8px 8px 16px"},onClick:function(t){e.onClick(t,e.file.path)}},e.file.path.toString().toLowerCase().endsWith(".jpg")||e.file.path.toString().toLowerCase().endsWith(".png")?r.a.createElement("img",{src:"http://localhost:9000"+e.file.path+"?size=100",alt:"",style:{width:"25px"}}):r.a.createElement(Me.a,null),r.a.createElement(se.a,{style:{display:"inline",paddingLeft:"16px"}},e.file.name)),r.a.createElement(De.a,{padding:"default",style:{padding:"8px"}},Ce()(e.file["dam:date.created"]?e.file["dam:date.created"]:e.file["jcr:created"]).format("MMM Do YYYY, h:mm:ss a")),r.a.createElement(De.a,{padding:"default",style:{padding:"8px",textAlign:"center"}},r.a.createElement(N.a,{onClick:function(){return e.onDelete(e.file.path)},style:{minWidth:"24px",padding:"4px"}},r.a.createElement(Le.a,null)),e.file._links.download&&r.a.createElement(N.a,{onClick:function(){return e.onDownload(e.file.name,e.file._links.download)},style:{minWidth:"24px",padding:"4px"}},r.a.createElement(Re.a,null))))},_e=Object(j.f)(Object(C.a)(function(e){return{main:{width:"100%",height:"100%",backgroundColor:"#fff"},root:{gridRow:"1/4",gridColumn:"1/4"},tableWrapper:{overflowX:"auto"}}})(qe)),Xe=n(9),$e=n.n(Xe),Ze=n(759),et=n(760),tt=n(137),nt=n.n(tt),at=function(e){function t(){return Object(y.a)(this,t),Object(w.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(k.a)(t,[{key:"render",value:function(){var e=this.props,t=e.files,n=e.classes,i=t.length;return r.a.createElement(T.a,{className:nt()(n.root,Object(a.a)({},n.highlight,i>0))},r.a.createElement("div",{className:n.title},t.length>1&&r.a.createElement(se.a,{type:"subheading"},i," selected"),1===t.length&&r.a.createElement(se.a,{type:"title"},t[0].substr(t[0].lastIndexOf("/")+1))),r.a.createElement("div",{className:n.spacer}),r.a.createElement("div",{className:n.actions,style:{width:"100px",marginRight:"8px"}},r.a.createElement(ue.a,{"aria-label":"Delete"},r.a.createElement(Le.a,null)),r.a.createElement(ue.a,{"aria-label":"Download"},r.a.createElement(Re.a,null))))}}]),t}(i.Component),it=Object(C.a)(function(e){return{root:{paddingRight:2},highlight:"light"===e.palette.type?{color:e.palette.secondary.A700,backgroundColor:e.palette.secondary.A100}:{color:e.palette.secondary.A100,backgroundColor:e.palette.secondary.A700},spacer:{flex:"1 1 100%"},actions:{color:e.palette.text.secondary,display:"flex"},title:{flex:"0 0 auto",overflow:"hidden",maxWidth:"250px",overflowWrap:"break-word"}}})(at),rt=n(765),st=n(761),lt=function(e){function t(e,n){var a;return Object(y.a)(this,t),(a=Object(w.a)(this,Object(x.a)(t).call(this,e))).state={fileNodes:[],isMounted:!0,tabIndex:0},a}return Object(O.a)(t,e),Object(k.a)(t,[{key:"componentWillMount",value:function(){var e=this;this.setState({isMounted:!0}),this.handleTabChange=this.handleTabChange.bind(this),this.props.fileNodes?this.setState({fileNodes:this.props.fileNodes}):(Z.getFileData.sink.takeWhile(function(){return e.state.isMounted}).subscribe(function(t){console.log(JSON.stringify(t)),e.setState({fileNodes:t})}),Z.getFileData.source.next(this.props.files))}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function(e){this.props=e,Z.getFileData.source.next(this.props.files)}},{key:"handleTabChange",value:function(e,t){this.setState({tabIndex:t})}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement(te.a,{style:this.props.style},r.a.createElement(it,{files:this.props.files}),1===this.props.files.length&&r.a.createElement(ot,{handleTabChange:this.handleTabChange,tabIndex:this.state.tabIndex,fileNodes:this.state.fileNodes,classes:e}))}}]),t}(i.Component),ot=function(e,t){return r.a.createElement("div",{className:e.classes.gridListRoot},r.a.createElement("div",{className:e.classes.itemPreview},1===e.fileNodes.length&&r.a.createElement("div",{style:{height:"100%",maxWidth:"100%",textAlign:"center"}},e.fileNodes.map(function(e){return r.a.createElement("img",{src:V.baseHost.getValue()+e.path,alt:e.path,style:{maxHeight:"100%",maxWidth:"100%",alignSelf:"center"}})})),e.fileNodes.length>1&&r.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden"}},r.a.createElement(Ze.a,{cellHeight:160,style:{width:"100%",height:"100%"},cols:3},e.fileNodes.map(function(e){return r.a.createElement(et.a,{key:e.path,cols:e.cols||1},r.a.createElement("img",{src:V.baseHost.getValue()+e.path,alt:e["jcr:path"],style:{height:"100%",maxWidth:"100%",alignSelf:"center"}}))})))),1===e.fileNodes.length&&r.a.createElement("div",{className:e.classes.itemRating},r.a.createElement(se.a,null,"TODO: ADD RATING")),1===e.fileNodes.length&&r.a.createElement("div",{className:e.classes.itemKeywords},r.a.createElement(se.a,null,"TODO: ADD Keywords")),1===e.fileNodes.length&&r.a.createElement("div",{className:e.classes.itemInfo},r.a.createElement(rt.a,{value:"Details",indicatorColor:"primary",textColor:"primary",variant:"fullWidth",onChange:e.handleTabChange},r.a.createElement(st.a,{label:"Details"}),r.a.createElement(st.a,{label:"Versions",disabled:!0})),0===e.tabIndex&&r.a.createElement("div",null,r.a.createElement(Fe.a,null,r.a.createElement(Se.a,null,r.a.createElement(Ne.a,{style:{padding:"8px"}},r.a.createElement(De.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Type"),r.a.createElement(De.a,{align:"left"},e.fileNodes[0]["jcr:content"]["jcr:mimeType"])),r.a.createElement(Ne.a,null,r.a.createElement(De.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Resolution"),r.a.createElement(De.a,{align:"left"},e.fileNodes[0].width," x ",e.fileNodes[0].height)),r.a.createElement(Ne.a,null,r.a.createElement(De.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Created"),r.a.createElement(De.a,{align:"left"},Ce()(e.fileNodes[0]["dam:date.created"]).format("MMM Do YYYY, h:mm:ss a"))),r.a.createElement(Ne.a,null,r.a.createElement(De.a,{component:"th",scope:"row",align:"right",style:{padding:"8px"}},"Modified"),r.a.createElement(De.a,{align:"left"},Ce()(e.fileNodes[0]["jcr:lastModified"]).format("MMM Do YYYY, h:mm:ss a")))))),1===e.tabIndex&&r.a.createElement("div",null,"Versions Panel")))};FileList.propTypes={files:$e.a.array.isRequired};var ct=Object(j.f)(Object(C.a)(function(e){return{gridListRoot:{margin:"24px",display:"grid",gridTemplateRows:"175px 25px 50px 3fr",gridTemplateColumns:"16px auto 16px",background:e.palette.background.paper,justifyContent:"center"},itemPreview:{gridRow:"1",gridColumn:"2",justifyContent:"center"},itemRating:{gridRow:"2",gridColumn:"2"},itemKeywords:{gridRow:"3",gridColumn:"2"},itemInfo:{gridRow:"4",gridColumn:"2"},gridSingleItemInfo:{},title:{color:e.palette.primary[200]},titleBar:{background:"linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 70%, rgba(0,0,0,0) 100%)"}}})(lt)),dt=n(275),ut=n.n(dt),pt=n(762),ht=n(763),ft=n(276),mt=n.n(ft);function gt(e){return r.a.createElement(pt.a,Object.assign({direction:"up"},e))}var bt=function(e){function t(e,n){var a;return Object(y.a)(this,t),(a=Object(w.a)(this,Object(x.a)(t).call(this,e))).state={isMounted:!0,isReceiverOpen:!1,files:[],filter:"all"},a.handleClose=a.handleClose.bind(Object(S.a)(a)),a}return Object(O.a)(t,e),Object(k.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({isMounted:!0}),Z.uploadProgress.subscribe(function(t){for(var n=[],a=0;a<e.props.files.length;a++){var i=e.props.files[a];t.id===i.id&&100!==t.progress&&(i.progress=t.progress),n.push(i)}e.setState({files:n})}),Z.uploadError.subscribe(function(t){for(var n=[],a=0;a<e.props.files.length;a++){var i=e.props.files[a];t.id===i.id&&(i.error=t.error),n.push(i)}e.setState({files:n})}),setTimeout(function(){return e.startFileUploads(e.props.files)},500)}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.props=e,setTimeout(function(){return t.startFileUploads(t.props.files)},1e3)}},{key:"handleClose",value:function(){this.setState({files:[],filter:"all"}),this.props.onClose&&this.props.onClose()}},{key:"startFileUploads",value:function(e){if(this.props.files.length>0){for(var t=0;t<Math.min(3,this.props.files.length);t++);var n=!0,a=!1,i=void 0;try{for(var r,s=this.props.files[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var l=r.value;"uploadReady"===l.status&&(l.status="uploading",Z.uploadFile.source.next(l))}}catch(o){a=!0,i=o}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}}}},{key:"render",value:function(){var e=this,t=this.props.classes,n=this.props.files.filter(function(e){return 100===e.progress}).length,a=n/this.props.files.length*100,i=this.props.files.filter(function(t){return"completed"===e.state.filter?100===t.progress:"uploading"===e.state.filter?t.progress>0&&t.progress<100:"waiting"!==e.state.filter||0===t.progress});return i.sort(function(e,t){return e.progress<t.progress?1:e.progress>t.progress?-1:0}),r.a.createElement(We.a,{maxWidth:"lg",fullWidth:!0,open:this.props.open,transition:gt,classes:{paper:t.dialogPaper}},r.a.createElement(D.a,{className:t.appBar},r.a.createElement(T.a,null,r.a.createElement(se.a,{type:"title",color:"inherit",className:t.flex},"Adding Files"),r.a.createElement(N.a,{onClick:this.handleClose,style:{color:"white"}},"close"))),this.props.files.length>0&&r.a.createElement("div",{style:{position:"absolute",top:"80px",right:"24px",left:"24px"}},r.a.createElement(se.a,{style:{display:"inline"}},n," / ",this.props.files.length),r.a.createElement(ht.a,{variant:"determinate",value:Math.min(a,100)}),r.a.createElement(se.a,null,"Files will be added to: ",r.a.createElement("strong",null,this.props.path))),this.props.files.length>0&&i.length>0&&r.a.createElement("div",{style:{height:"100%",overflow:"scroll",position:"absolute",top:"148px",bottom:"24px",left:"16px",right:"16px"}},r.a.createElement(Fe.a,null,r.a.createElement(He.a,null,r.a.createElement(Ne.a,null,r.a.createElement(De.a,{style:{width:"32px",padding:"0 8px 0 8px"}}),r.a.createElement(De.a,{style:{width:"100%",padding:"0 8px 0 8px"}},"Name"),r.a.createElement(De.a,{style:{width:"50px",padding:"0 8px 0 8px"},numeric:!0},"Size"),r.a.createElement(De.a,{style:{width:"50px",padding:"0 8px 0 8px"},numeric:!0},"Progress"))),r.a.createElement(Se.a,null,i.map(function(e){if(e.progress<100)return r.a.createElement(Ne.a,{key:e.id},r.a.createElement(De.a,{style:{padding:"0 8px 0 8px"}},e.progress<100?r.a.createElement(F.a,{size:24}):r.a.createElement(mt.a,{color:"primary"})),r.a.createElement(De.a,{style:{padding:"0 8px 0 8px"}},r.a.createElement(se.a,null,e.name),r.a.createElement(se.a,{variant:"caption"},e.relativePath," ",e.error),r.a.createElement(ht.a,{variant:"determinate",value:e.progress,style:{height:"4px"}})),r.a.createElement(De.a,{style:{padding:"0 8px 0 8px"},numeric:!0},ut()(e.size,{base:10})),r.a.createElement(De.a,{style:{padding:"0 8px 0 8px"},numeric:!0},Math.round(e.progress),"%"))})))))}}]),t}(i.Component),vt=Object(C.a)(function(e){return{appBar:{position:"relative"},flex:{flex:1},dialogPaper:{minHeight:"90%"}}})(bt),yt=n(764);function kt(e){return r.a.createElement(pt.a,Object.assign({direction:"up"},e))}var wt=function(e){function t(e,n){var a;return Object(y.a)(this,t),(a=Object(w.a)(this,Object(x.a)(t).call(this,e))).state={folderName:""},a.handleSave=a.handleSave.bind(Object(S.a)(a)),a}return Object(O.a)(t,e),Object(k.a)(t,[{key:"componentDidMount",value:function(){this.setState({isMounted:!0})}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}},{key:"handleSave",value:function(){var e=this;Z.createFolder.source.next({name:this.state.folderName,path:this.props.path}),Z.createFolder.sink.subscribe(function(){e.props.onClose&&e.props.onClose()})}},{key:"render",value:function(){var e=this;return r.a.createElement(We.a,{maxWidth:"md",fullScreen:!1,open:this.props.open,transition:kt},r.a.createElement(Be.a,null,"Create New Folder"),r.a.createElement(Ie.a,null,r.a.createElement(yt.a,{id:"newFolderName",label:"Folder Name",value:this.state.folderName,onChange:function(t){return e.setState({folderName:t.target.value})},margin:"dense"})),r.a.createElement(Ue.a,null,r.a.createElement(N.a,{onClick:this.props.onClose,color:"primary"},"Close"),r.a.createElement(N.a,{raised:!0,color:"primary",onClick:this.handleSave},"Save")),r.a.createElement("input",{type:"file",ref:"fileInputField",multiple:!0,style:{display:"none"},onChange:this.handleFileChange}),r.a.createElement("input",{type:"file",ref:"folderInputField",style:{display:"none"},onChange:this.handleFolderChange}))}}]),t}(i.Component),xt=Object(C.a)(function(e){return{}})(wt),Ot=n(277),Et=function(e){function t(e,n){var a;return Object(y.a)(this,t),(a=Object(w.a)(this,Object(x.a)(t).call(this,e))).state={isMounted:!0},a.handleOnDragEnter=a.handleOnDragEnter.bind(Object(S.a)(a)),a.handleOnDragOver=a.handleOnDragOver.bind(Object(S.a)(a)),a.handleOnDragLeave=a.handleOnDragLeave.bind(Object(S.a)(a)),a.handleAddFile=a.handleAddFile.bind(Object(S.a)(a)),a}return Object(O.a)(t,e),Object(k.a)(t,[{key:"componentWillMount",value:function(){this.setState({isMounted:!0})}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function(e){this.props=e}},{key:"handleOnDragEnter",value:function(e){this.setState({isReceiverOpen:!0})}},{key:"handleOnDragOver",value:function(e){this.state.isReceiverOpen&&this.setState({isReceiverOpen:!0})}},{key:"handleOnDragLeave",value:function(e){this.setState({isReceiverOpen:!1})}},{key:"handleAddFile",value:function(e,t){(new ee).scanFiles(e,this.props.path,t)}},{key:"render",value:function(){return r.a.createElement(Ot.Receiver,{onDragEnter:this.handleOnDragEnter,onDragOver:this.handleOnDragOver,onDragLeave:this.handleOnDragLeave,onFileDrop:this.handleAddFile})}}]),t}(i.Component),jt=function(e){function t(e,n){var a;return Object(y.a)(this,t),(a=Object(w.a)(this,Object(x.a)(t).call(this,e))).state={isMounted:!1,isLoading:!1,canAddFile:!0,canAddFolder:!0,showAddFolderDialog:!1,showUploadSidebar:!1,showNewFolderDialog:!1,selectedFiles:[],uploadFiles:[],root:"/content",visibleRoot:"/content/files",path:"/content/files"},a.handleFileSelectionChange=a.handleFileSelectionChange.bind(Object(S.a)(a)),a.handleUploadClosed=a.handleUploadClosed.bind(Object(S.a)(a)),a.handleAfterOnDelete=a.handleAfterOnDelete.bind(Object(S.a)(a)),a.handleFileSelect=a.handleFileSelect.bind(Object(S.a)(a)),a.handleFileChange=a.handleFileChange.bind(Object(S.a)(a)),a}return Object(O.a)(t,e),Object(k.a)(t,[{key:"componentWillMount",value:function(){this.setState({isMounted:!0}),this.validatePath()}},{key:"componentDidMount",value:function(){var e=this;q.navigateTo.takeWhile(function(){return e.state.isMounted}).subscribe(function(t){console.log("{FilesPage} navigateTo="+t),"://"===t.substring(0,3)?window.location.href.substring(window.location.href.indexOf("#")+1)!==t.substring(2)&&(window.location.href=t.substring(2)):e.props.history.push(t)}),Z.stageFile.bufferTime(5).subscribe(function(t){if(t.length>0){var n=e.state.uploadFiles,a=!0,i=!1,r=void 0;try{for(var s,l=t[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var o=s.value;n.push(o)}}catch(c){i=!0,r=c}finally{try{a||null==l.return||l.return()}finally{if(i)throw r}}console.log("stage file || files="+t.length+"/"+n.length),e.setState({showUploadDialog:!0,uploadFiles:n})}}),Z.stageAction.subscribe(function(t){e.setState({showUploadDialog:!0})})}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function(e){this.props=e,this.validatePath()}},{key:"validatePath",value:function(){var e=this.props.path;this.props.location.pathname&&this.props.location.pathname.toString().startsWith(this.state.visibleRoot)&&(e=this.props.location.pathname),e||(e=this.state.visibleRoot),e.toString().startsWith(this.state.visibleRoot)?this.setState({path:e}):console.log("Invalid Path: "+e)}},{key:"handleFileSelect",value:function(){this.refs.fileInputField.click()}},{key:"handleFileSelectionChange",value:function(e){this.setState({selectedFiles:e,showUploadSidebar:!1})}},{key:"handleUploadClosed",value:function(){this.setState({showUploadDialog:!1,uploadFiles:[]}),Z.getFileAndFolders.source.next(this.state.path)}},{key:"handleAfterOnDelete",value:function(e){for(var t=[],n=0;n<this.state.selectedFiles.length;n++){var a=this.state.selectedFiles[n];a!==e&&t.push(a)}this.setState({selectedFiles:t}),Z.getFileAndFolders.source.next(this.state.path)}},{key:"handleFileChange",value:function(e,t){(new ee).scanFiles(e,this.state.path,e.target.files)}},{key:"render",value:function(){var e=this,t=this.props.classes,n=this.state.showUploadSidebar||this.state.uploadFiles.length>0||this.state.selectedFiles.length>0;return this.state.isLoading?r.a.createElement(xe,{user:this.props.user},r.a.createElement(F.a,{className:t.progress,size:50})):r.a.createElement(xe,{user:this.props.user,open:!1},r.a.createElement("div",{className:t.fileGrid},r.a.createElement(D.a,{color:"default",position:"static",elevation:0,className:t.fileGridAppBar,style:{colorDefault:"#eeeeee"}},r.a.createElement(T.a,{className:t.toolbarContainer},r.a.createElement(ue.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu"},r.a.createElement(A.a,null)),r.a.createElement(se.a,{variant:"h6",className:t.title},r.a.createElement(Ee,{root:this.state.root,path:this.state.path})),r.a.createElement("div",null,r.a.createElement(N.a,{color:"primary",disabled:!this.state.canAddFile,onClick:this.handleFileSelect},r.a.createElement(A.a,null),"\xa0\xa0Add Files"),r.a.createElement(N.a,{label:"New Folder",color:"primary",disabled:!this.state.canAddFolder,onClick:function(){e.setState({showNewFolderDialog:!0})}},r.a.createElement(P.a,null),"\xa0\xa0New Folder")))),r.a.createElement("div",{className:t.fileGridFileList,style:{gridColumn:n?"1/2":"1/3"}},r.a.createElement(Et,{path:this.state.path,onFileDrop:this.handleOnFileDrop}),r.a.createElement(_e,{path:this.state.path,onSelectionChange:this.handleFileSelectionChange,onDelete:this.handleAfterOnDelete,style:{gridRow:"1 / 4",gridColumn:"1 / 3"}})),r.a.createElement(ct,{files:this.state.selectedFiles,className:t.fileGridSidebar,style:{display:this.state.selectedFiles.length>0?"block":"none"}}),r.a.createElement(vt,{onClose:this.handleUploadClosed,open:this.state.showUploadDialog,files:this.state.uploadFiles,path:this.state.path}),r.a.createElement(xt,{onClose:function(){e.setState({showNewFolderDialog:!1})},open:this.state.showNewFolderDialog,path:this.state.path})),r.a.createElement("input",{type:"file",ref:"fileInputField",multiple:!0,style:{display:"none"},onChange:this.handleFileChange}))}}]),t}(i.Component),Ct=Object(o.c)(Object(j.f)(Object(C.a)(function(e){return{progress:{margin:"0 ".concat(2*e.spacing.unit,"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},toolbarContainer:{},fileGrid:{height:"100%",display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"4fr minmax(2px, 400px)"},fileGridAppBar:{gridRow:"1",gridColumn:"1/3"},fileGridFileList:{gridRow:"2",gridColumn:"1",margin:"24px"},fileGridSidebar:{gridRow:"2",gridColumn:"2",margin:"24px"},filePondSidebar:{gridRow:"2",gridColumn:"2",margin:"24px"},mainGrid:{height:"100%",overflow:"scroll",display:"grid",gridGap:"16px",gridTemplateRows:"1fr 1fr 1fr",gridTemplateColumns:"2fr 6fr"},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}})(jt))),Ft=function(){function e(t,n){Object(y.a)(this,e),this.sink=void 0,this.sink=n,t.subscribe(this.getUser.bind(this))}return Object(k.a)(e,[{key:"getUser",value:function(e){var t=this,n=V.baseHost.getValue();fetch(n+"/api/v1/auth/user/me",{method:"GET"}).then(function(e){return e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e}).then(function(e){return e.json()}).then(function(e){e.firstName||(e.firstName=e.username),t.sink.next(e)}).catch(function(e){if(401===e.status||403===e.status)window.location="/";else{var n={code:e.status,status:e.statusText,message:e.responseText||e.message};t.sink.error(n)}})}}]),e}(),St=function(){function e(t,n,a){Object(y.a)(this,e),this.sink=void 0,this.sink=n,t.subscribe(this.getUsers.bind(this))}return Object(k.a)(e,[{key:"getUsers",value:function(){var e=Object(U.a)(W.a.mark(function e(){var t,n,a,i,r=this;return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=V.baseHost.getValue(),n=t+"/api/v1/auth/users",(a=new Headers).append("pragma","no-cache"),a.append("cache-control","no-cache"),e.next=7,fetch(n,{method:"GET",cache:"no-cache",headers:a}).then(function(e){return e.json()}).then(function(e){for(var t=[],n=0;n<e.length;n++){var a=e[n];void 0===a.firstName&&(a.firstName=a.username),t.push(a)}return t.sort(function(e,t){return e.username>t.username?1:e.username<t.username?-1:0})}).catch(function(e){if(401===e.status||403===e.status)window.location="/";else{var t={code:e.status,status:e.statusText,message:e.responseText||e.message};r.sink.error(t),Dt.getAllUsers.source.next(!0)}});case 7:(i=e.sent)&&this.sink.next(i);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),Dt=new function e(){Object(y.a)(this,e),this.getUser={source:new H.Subject,sink:new H.Subject},this.getAllUsers={source:new H.Subject,sink:new H.Subject},this.getUserService=new Ft(this.getUser.source,this.getUser.sink),this.getAllUsersService=new St(this.getAllUsers.source,this.getAllUsers.sink)},Nt=function(e){function t(e,n){var a;return Object(y.a)(this,t),(a=Object(w.a)(this,Object(x.a)(t).call(this,e,n))).state={context:n,locale:"en-EN",isAuthenticated:!1,isLoading:!0,isMounted:!1},window.location.href.indexOf(":3000"),a}return Object(O.a)(t,e),Object(k.a)(t,[{key:"componentWillMount",value:function(){this.setState({isMounted:!0})}},{key:"componentDidMount",value:function(){var e=this;Dt.getUser.sink.takeWhile(function(){return e.state.isMounted}).subscribe(function(t){t&&e.setState({isAuthenticated:!0,isLoading:!1,user:t})}),Dt.getUser.source.next(null)}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}},{key:"render",value:function(){var e=this,t=this.props.classes;return this.state.isLoading?r.a.createElement("div",null,r.a.createElement(F.a,{className:t.progress,size:50})):r.a.createElement(o.a,{locale:"en-EN",key:"en-EN",messages:this.props.i18nMessages["en-EN"]},r.a.createElement(E.a,null,r.a.createElement(j.c,null,r.a.createElement(j.a,{path:"/",component:function(){return r.a.createElement(Ct,{user:e.state.user})}}))))}}]),t}(i.Component),Tt=Object(C.a)(function(e){return{progress:{margin:"0 ".concat(2*e.spacing.unit,"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}})(Nt);function Mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}Object(o.b)(n(697));var At={"en-EN":n(698)},Rt=Object(u.a)({palette:{type:"light",primary:f.a,secondary:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mt(Object(n),!0).forEach(function(t){Object(a.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},g.a),error:v.a}});l.a.render(r.a.createElement(p.a,{theme:Rt},r.a.createElement(Tt,{i18nMessages:At})),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/files",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/files","/service-worker.js");c?function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):d(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e):d(e)}),window.addEventListener("message",function(e){console.log(e)})}}()}},[[293,1,2]]]);
//# sourceMappingURL=main.8496efb8.chunk.js.map