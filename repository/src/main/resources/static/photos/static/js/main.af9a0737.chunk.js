(this["webpackJsonpapp-photos"]=this["webpackJsonpapp-photos"]||[]).push([[0],{211:function(e,t){},238:function(e,t,n){e.exports=n(573)},252:function(e,t){},258:function(e,t){},262:function(e,t,n){},572:function(e){e.exports=JSON.parse("{}")},573:function(e,t,n){"use strict";n.r(t);var a=n(228),o=n(0),s=n.n(o),i=n(19),r=n.n(i),l=n(56),c=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function registerValidSW(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var u=n(227),p=n(612),d=n(226),h=n.n(d),m=n(177),g=n.n(m),f=n(178),b=n.n(f),v=(n(262),n(15)),y=n(18),k=n(40),w=n(39),S=n(41),C=n(104),x=n(86),E=n(13),O=n(70),j=n.n(O),T=n(27),M=n(611),A=n(29),I=n(212),N=n.n(I),U=function(){function LoginService(e,t){Object(v.a)(this,LoginService),this.sink=void 0,this.sink=t,e.subscribe(this.loadApps.bind(this))}return Object(y.a)(LoginService,[{key:"loadApps",value:function loadApps(e){var t=this;N.a.get("/api/v1/core/clientapps").withCredentials().set("Accept","application/json").end((function(e,n){if(e)if(401===e.status)R.navigateTo.next("/");else if(403===e.status){var a={code:e.status,message:"Invalid Login (todo: show toast)"};t.sink.error(a)}else{console.dir(e);var o={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(o)}else t.sink.next({primaryApps:n.body.apps.primary,secondaryApps:n.body.apps.secondary})}))}}]),LoginService}(),L=new function AppSettings(){Object(v.a)(this,AppSettings),this.baseHost=new A.BehaviorSubject(""),this.basicUser=new A.BehaviorSubject(window.localStorage.getItem("u")),this.basicPwd=new A.BehaviorSubject(window.localStorage.getItem("p"))},P=function(){function LogoutService(e,t){Object(v.a)(this,LogoutService),this.sink=void 0,this.sink=t,e.subscribe(this.getUser.bind(this))}return Object(y.a)(LogoutService,[{key:"getUser",value:function getUser(e){var t=this,n=L.baseHost.getValue();fetch(n+"/logout",{method:"GET"}).then((function(e){return e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e})).catch((function(e){if(401===e.status||403===e.status)window.location="/";else{var n={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(n)}}))}}]),LogoutService}(),R=new function AppActions(){Object(v.a)(this,AppActions),this.navigateTo=new A.Subject,this.logout={source:new A.Subject,sink:new A.Subject},this.loadClientApps={source:new A.Subject,sink:new A.Subject},this.loadClientAppsService=new U(this.loadClientApps.source,this.loadClientApps.sink),this.logoutService=new P(this.logout.source,this.logout.sink)},W=n(602),D=n(176),G=n(617),B=n(603),F=n(579),H=n(604),V=n(134),$=n(122),_=n.n($),z=n(179),J=n.n(z),Y=function(e){function Sidebar(e,t){var n;return Object(v.a)(this,Sidebar),(n=Object(k.a)(this,Object(w.a)(Sidebar).call(this,e))).handleNavClick=n.handleNavClick.bind(Object(T.a)(n)),n}return Object(S.a)(Sidebar,e),Object(y.a)(Sidebar,[{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.open!==this.props.open||e.user!==this.props.user||e.apps!==this.props.apps||e.secondaryApps!==this.props.secondaryApps}},{key:"handleNavClick",value:function handleNavClick(e){this.props.onNavClick&&this.props.onNavClick(e)}},{key:"handleLogout",value:function handleLogout(){window.localStorage.clear(),R.logout.source.next(!0),R.navigateTo.next("://")}},{key:"findApp",value:function findApp(e,t){if(t){var n=!0,a=!1,o=void 0;try{for(var s,i=t[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var r=s.value;if(r.slug===e)return r}}catch(l){a=!0,o=l}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}}return null}},{key:"render",value:function render(){var e=this,t=this.props.classes,n=this.findApp("usermanager",this.props.secondaryApps);return s.a.createElement(D.a,{className:this.props.open?t.sidebarOpen:t.sidebarClosed},s.a.createElement(D.a,{className:this.props.open?t.sidebarUserInfo:t.sidebarUserInfoClosed},s.a.createElement("div",{className:t.sidebarProfileIcon},s.a.createElement(J.a,{style:{width:60,height:60}})),s.a.createElement("div",{className:t.sidebarProfileName},s.a.createElement(V.a,{component:"div",type:"title"},this.props.user.firstName," ",this.props.user.lastName)),s.a.createElement("div",{className:t.sidebarButtons},s.a.createElement(W.a,{onClick:this.handleLogout},"Logout"),n&&s.a.createElement(W.a,{onClick:function onClick(){return R.navigateTo.next(n.path)}},"Profile"))),s.a.createElement("div",{className:this.props.open?t.appListsOpen:t.appListsClosed},s.a.createElement("div",{style:{gridColumn:"1",gridRow:"1"}},s.a.createElement(V.a,{type:"title",className:this.props.open?t.openLabel:t.closedLabel,style:{paddingLeft:"16px",paddingTop:"16px",gridColumn:"1",gridRow:"1"}},"Apps")),s.a.createElement(B.a,{style:{gridColumn:"1",gridRow:"2"}},this.props.apps&&this.props.apps.map((function(n){return s.a.createElement(F.a,{button:!0,key:n.path,onClick:function onClick(){return e.handleNavClick(n.path)}},s.a.createElement(G.a,{style:{marginRight:"8px"}},s.a.createElement(_.a,null)),s.a.createElement(H.a,{primary:n.label,secondary:"",className:e.props.open?t.openLabel:t.closedLabel}))}))),s.a.createElement(B.a,{style:{gridColumn:"1",gridRow:"3"},className:this.props.open?t.closedLabel:t.openLabel},s.a.createElement(F.a,{button:!0,onClick:function onClick(){return e.handleNavClick("://app-usermanager/index.html")}},s.a.createElement(G.a,null,s.a.createElement(J.a,{style:{width:48,height:48}}))))))}}]),Sidebar}(o.Component),q=Object(l.c)(Object(E.a)((function styleSheet(e){return{sidebarOpen:{width:"240px",height:"100vh",background:"#fff"},sidebarClosed:{width:"72px",height:"100vh",background:"#fff"},sidebarUserInfo:{width:"100%",padding:"8px",display:"grid",gridGap:"8px",gridTemplateRows:"auto",gridTemplateColumns:"60px auto"},sidebarUserInfoClosed:{display:"none"},sidebarProfileIcon:{gridColumn:"1",gridRow:"1"},sidebarProfileName:{gridColumn:"2",gridRow:"1",alignSelf:"center"},sidebarButtons:{gridColumn:"1/3",gridRow:"2",justifySelf:"center"},appListsOpen:{display:"grid",gridGap:"0px",gridTemplateRows:"24px auto",gridTemplateColumns:"auto",marginTop:"16px"},appListsClosed:{height:"90%",display:"grid",gridGap:"0px",gridTemplateRows:"0px auto 72px",gridTemplateColumns:"auto"},openLabel:{display:"inline"},closedLabel:{display:"none"}}}))(Y)),K=n(605),Q=n(606),X=n(607),Z=n(609),ee=n(614),te=n(608),ne=n(214),ae=n.n(ne),oe=n(213),se=n.n(oe),ie=function(e){function AppHeader(e,t){var n;return Object(v.a)(this,AppHeader),(n=Object(k.a)(this,Object(w.a)(AppHeader).call(this,e))).state={openMoreMenu:!1},n.handleToggle=n.handleToggle.bind(Object(T.a)(n)),n.handleOpenMoreMenu=n.handleOpenMoreMenu.bind(Object(T.a)(n)),n.handleLogout=n.handleLogout.bind(Object(T.a)(n)),n}return Object(S.a)(AppHeader,e),Object(y.a)(AppHeader,[{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.onToggle!==this.props.onToggle||e.apps!==this.props.apps||t.openMoreMenu!==this.state.openMoreMenu}},{key:"handleOpenMoreMenu",value:function handleOpenMoreMenu(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}},{key:"handleToggle",value:function handleToggle(){this.props.onToggle&&this.props.onToggle()}},{key:"handleNavClick",value:function handleNavClick(e){this.props.onNavClick&&this.props.onNavClick(e)}},{key:"handleMenuClose",value:function handleMenuClose(){this.setState({openMoreMenu:!1})}},{key:"handleLogout",value:function handleLogout(){window.localStorage.clear(),R.logout.source.next(!0),window.location="/"}},{key:"render",value:function render(){var e=this,t=this.props.classes;return s.a.createElement(K.a,{className:t.root,position:"static"},s.a.createElement(Q.a,null,s.a.createElement(X.a,{onClick:this.handleToggle,className:t.menuButton,color:"contrast","aria-label":"Menu"},s.a.createElement(se.a,null)),s.a.createElement(V.a,{variant:"h5",color:"inherit",className:t.flex,onClick:function onClick(){return e.handleNavClick("://home/index.html")}},"Family ",s.a.createElement("i",null,"D.A.M")),s.a.createElement(X.a,{"aria-label":"More","aria-owns":this.state.open?"long-menu":null,"aria-haspopup":"true",onClick:this.handleOpenMoreMenu,className:t.moreButton},s.a.createElement(ae.a,null)),s.a.createElement(ee.a,{id:"long-menu",keepMounted:!0,anchorEl:this.state.openMoreMenuAnchorEl,open:this.state.openMoreMenu},s.a.createElement(te.a,{onClick:function onClick(){e.handleLogout(),e.handleMenuClose()}},"Logout"),s.a.createElement(Z.a,null),this.props.apps&&this.props.apps.map((function(t){return s.a.createElement(te.a,{key:t.path,color:"contrast",onClick:function onClick(){e.handleNavClick(t.path),e.handleMenuClose()}},t.label)})))))}}]),AppHeader}(o.Component),re=Object(l.c)(Object(E.a)((function styleSheet(e){return{root:{width:"100%",height:"64px"},headerContainer:{display:"grid",gridTemplateRows:"auto",gridTemplateColumns:"48px auto 48px"},hamburgerMenu:{display:"block",gridRow:"1",gridColumn:"1"},mainSection:{gridRow:"1",gridColumn:"2"},rightSection:{gridRow:"2",gridColumn:"3",textAlign:"right"},flex:{flex:1},menuButton:{marginLeft:-12,marginRight:20,color:"#ffffff"},moreButton:{color:"#ffffff"}}}))(ie)),le=function(e){function AppShell(e,t){var n;Object(v.a)(this,AppShell),n=Object(k.a)(this,Object(w.a)(AppShell).call(this,e));var a=window.localStorage.getItem("AppShell.isOpen");return a||(a=void 0===e.open||e.open),n.state={isMounted:!0,isOpen:Boolean(a)},n.handleOpenCloseToggle=n.handleOpenCloseToggle.bind(Object(T.a)(n)),n.handleOpenMoreMenu=n.handleOpenMoreMenu.bind(Object(T.a)(n)),n}return Object(S.a)(AppShell,e),Object(y.a)(AppShell,[{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.open!==this.props.open||e.user!==this.props.user||e.children!==this.props.children||t.isOpen!==this.state.isOpen||t.primaryApps!==this.state.primaryApps||t.secondaryApps!==this.state.secondaryApps}},{key:"componentWillMount",value:function componentWillMount(){var e=this;this.setState({isMounted:!0}),R.navigateTo.takeWhile((function(){return e.state.isMounted})).subscribe(function(e){"://"!==e&&"://"===e.substring(0,3)?window.location.href=e.substring(2):this.props.history&&this.props.history.push(e)}.bind(this)),R.loadClientApps.sink.subscribe((function(t){t&&e.setState({primaryApps:t.primaryApps,secondaryApps:t.secondaryApps})})),R.loadClientApps.source.next(!0)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"handleOpenMoreMenu",value:function handleOpenMoreMenu(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}},{key:"handleOpenCloseToggle",value:function handleOpenCloseToggle(){var e=!this.state.isOpen;this.setState({isOpen:e}),window.localStorage.setItem("AppShell.isOpen",e)}},{key:"handleLogout",value:function handleLogout(){window.localStorage.clear(),R.logout.source.next(!0),R.navigateTo.next("://")}},{key:"render",value:function render(){var e=this.props.classes;return this.props.user?s.a.createElement("div",{className:this.state.isOpen?e.dashboardShellContainerOpen:e.dashboardShellContainerClosed},s.a.createElement("header",{className:e.header},s.a.createElement(re,{apps:this.state.secondaryApps,onToggle:this.handleOpenCloseToggle,onNavClick:function onNavClick(e){return R.navigateTo.next(e)}})),s.a.createElement(q,{user:this.props.user,apps:this.state.primaryApps,secondaryApps:this.state.secondaryApps,open:this.state.isOpen,onNavClick:function onNavClick(e){return R.navigateTo.next(e)}}),s.a.createElement("div",{className:e.main},this.props.children)):s.a.createElement("div",null)}}]),AppShell}(o.Component),ce=Object(l.c)(Object(x.f)(Object(E.a)((function styleSheet(e){return{dashboardShellContainerOpen:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"240px auto"},dashboardShellContainerClosed:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"72px auto"},header:{gridColumn:"1/3",gridRow:"1",position:"inherit",height:"64px"},main:{background:"#eee"}}}))(le))),ue=function(){function ListPhotosService(e,t){Object(v.a)(this,ListPhotosService),this.sink=void 0,this.sink=t,e.subscribe(this.listPhotos.bind(this))}return Object(y.a)(ListPhotosService,[{key:"listPhotos",value:function listPhotos(e){var t=this,n=e.path,a=e.groupBy||"date:day",o=L.baseHost.getValue()+"/search",s=new FormData;s.append("path",n),s.append("type","dam:image"),s.append("limit",1e3),s.append("offset",0),s.append("group",a),s.append("order.field","dam:date.created"),s.append("order.direction","desc"),fetch(o,{method:"post",body:s}).then((function(e){return console.log("Image Search Success handler"),console.dir(e),e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e})).then((function(e){return e.json()})).then((function(e){var n=!0,a=!1,o=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var r=s.value;r.src=r._links.self,r.isSelected=!1,r.thumbnail=r._links.thumb,r.thumbnailWidth=r.width,r.thumbnailHeight=r.height}}catch(l){a=!0,o=l}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}t.sink.next(e)})).catch((function(e){if(console.warn(e),401===e.status)R.navigateTo.next("/");else if(409===e.status)R.alert.next("User already exists");else if(403===e.status)R.alert.next("You do not have permission to add a new user");else{var n={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(n)}}))}}]),ListPhotosService}(),pe=function(){function ListFoldersService(e,t){Object(v.a)(this,ListFoldersService),this.sink=void 0,this.sink=t,e.subscribe(this.listResults.bind(this))}return Object(y.a)(ListFoldersService,[{key:"listResults",value:function listResults(e){var t=this,n=e.path,a=e.groupBy||"path",o=L.baseHost.getValue()+"/search",s=new FormData;s.append("path",n),s.append("type","nt:folder"),s.append("limit",1e4),s.append("offset",0),s.append("group",a),s.append("order.field","name"),s.append("order.direction","asc"),fetch(o,{method:"post",body:s}).then((function(e){return console.log("Folder Search Success handler"),console.dir(e),e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e})).then((function(e){return e.json()})).then((function(e){var a={};a[n]={},a[n].children=[],a[n].name="Family",a[n].path=n;var o=!0,s=!1,i=void 0;try{for(var r,l=e[Symbol.iterator]();!(o=(r=l.next()).done);o=!0){var c=r.value,u=c.path.substr(0,c.path.lastIndexOf("/"));a[c.path]=c,a[c.path].parent=u,a[u]&&(a[u].children||(a[u].children=[]),a[u].children.push(a[c.path]))}}catch(p){s=!0,i=p}finally{try{o||null==l.return||l.return()}finally{if(s)throw i}}a[n].children=a[n].children.sort((function(e,t){return e.name>t.name?1:e.name<t.name?-1:0})),t.sink.next([a[n]])})).catch((function(e){if(console.warn(e),401===e.status)R.navigateTo.next("/");else if(409===e.status)R.alert.next("User already exists");else if(403===e.status)R.alert.next("You do not have permission to add a new user");else{var n={code:e.status,status:e.statusText,message:e.responseText};t.sink.error(n)}}))}}]),ListFoldersService}(),de=new function PhotoActions(){Object(v.a)(this,PhotoActions),this.listFolders={source:new A.Subject,sink:new A.Subject},this.listPhotos={source:new A.Subject,sink:new A.Subject},this.listFoldersService=new pe(this.listFolders.source,this.listFolders.sink),this.listPhotosService=new ue(this.listPhotos.source,this.listPhotos.sink)},he=n(6),me=n.n(he),ge=n(216),fe=n.n(ge),be=n(616),ve=n(610),ye=n(219),ke=n.n(ye),we=n(217),Se=n.n(we),Ce=n(218),xe=n.n(Ce),Ee=n(220),Oe=n.n(Ee),je=function(e){function PhotoGroup(e,t){var n;return Object(v.a)(this,PhotoGroup),(n=Object(k.a)(this,Object(w.a)(PhotoGroup).call(this,e,t))).state={images:n.props.photos.children,showInfoModel:!1,showEditModel:!1,showDeleteModel:!1,selectedImage:null},n.onSelectImage=n.onSelectImage.bind(Object(T.a)(n)),n.handleInfoClose=n.handleInfoClose.bind(Object(T.a)(n)),n.handleEditClose=n.handleEditClose.bind(Object(T.a)(n)),n.handleDeleteClose=n.handleDeleteClose.bind(Object(T.a)(n)),n}return Object(S.a)(PhotoGroup,e),Object(y.a)(PhotoGroup,[{key:"componentDidMount",value:function componentDidMount(){this.setState({isMounted:!0})}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(e){this.props=e}},{key:"onSelectImage",value:function onSelectImage(e,t){var n=this.state.images.slice(),a=n[e];a.hasOwnProperty("isSelected")&&(a.isSelected=!a.isSelected),this.setState({images:n}),this.props.onImageSelect(a)}},{key:"handleInfo",value:function handleInfo(e,t){this.setState({showInfoModel:!0,selectedImage:e})}},{key:"handleInfoClose",value:function handleInfoClose(){this.setState({showInfoModel:!1})}},{key:"handleEdit",value:function handleEdit(e,t){this.setState({showEditModel:!0,selectedImage:e})}},{key:"handleEditClose",value:function handleEditClose(){this.setState({showEditModel:!1})}},{key:"handleDelete",value:function handleDelete(e,t){this.setState({showDeleteModel:!0,selectedImage:e})}},{key:"handleDeleteClose",value:function handleDeleteClose(){this.setState({showDeleteModel:!1})}},{key:"handleDownload",value:function handleDownload(e,t){console.dir("Download: "+e+"="+t);var n=document.createElement("a");return document.body.appendChild(n),n.href=t,n.download=e,n.click(),!1}},{key:"render",value:function render(){var e=this,t=this.props.classes,n=this.state.images.map((function(n){return n.thumbnailCaption=s.a.createElement("div",null,s.a.createElement(X.a,{"aria-label":"info",className:t.margin,onClick:function onClick(t){e.handleInfo(n.name,n.path)}},s.a.createElement(Se.a,{fontSize:"small"})),s.a.createElement(X.a,{"aria-label":"edit",className:t.margin,onClick:function onClick(t){e.handleEdit(n.name,n.path)}},s.a.createElement(xe.a,{fontSize:"small"})),s.a.createElement(X.a,{"aria-label":"delete",className:t.margin,onClick:function onClick(t){e.handleDelete(n.name,n.path)}},s.a.createElement(ke.a,{fontSize:"small"})),s.a.createElement(X.a,{"data-name":n.name,"data-image":n.path,"aria-label":"delete",className:t.margin,style:{float:"right"},onClick:function onClick(t){e.handleDownload(n.name,n.path)}},s.a.createElement(Oe.a,{fontSize:"small"}))),n}));return s.a.createElement("div",{className:t.imgGroup},s.a.createElement(V.a,null,this.props.photos.label),s.a.createElement(fe.a,{onSelectImage:this.onSelectImage,images:n,showLightboxThumbnails:!0,thumbnailWidth:"190px",margin:"4px"}),this.state.showInfoModel&&s.a.createElement(be.a,{onClose:this.handleInfoClose,"aria-labelledby":"simple-dialog-title",open:!0},s.a.createElement(ve.a,{id:"simple-dialog-title"},"Image Info: ",this.state.selectedImage)),this.state.showEditModel&&s.a.createElement(be.a,{onClose:this.handleEditClose,"aria-labelledby":"simple-dialog-title",open:!0},s.a.createElement(ve.a,{id:"simple-dialog-title"},"Image Edit: ",this.state.selectedImage)),this.state.showDeleteModel&&s.a.createElement(be.a,{onClose:this.handleDeleteClose,"aria-labelledby":"simple-dialog-title",open:!0},s.a.createElement(ve.a,{id:"simple-dialog-title"},"Image Delete: ",this.state.selectedImage)))}}]),PhotoGroup}(o.Component);FileList.propTypes={photos:me.a.object.isRequired};var Te=Object(x.f)(Object(E.a)((function styleSheet(e){return{margin:{margin:"8px",padding:"0px"},imgGroup:{display:"block",minHeight:"1px",width:"100%",border:"1px solid rgb(221, 221, 221)",overflow:"auto",padding:"24px"},captionStyle:{backgroundColor:"rgba(0, 0, 0, 0.8)",maxHeight:"240px",overflow:"hidden",position:"absolute",bottom:"0",width:"100%",color:"white",padding:"2px",fontSize:"90%"},thumbnailSmall:{border:"5px solid red"}}}))(je)),Me=n(229),Ae=n(221),Ie=n(613),Ne=n(618),Ue=n(222),Le=n.n(Ue),Pe=n(223),Re=n.n(Pe),We=n(224),De=n.n(We),Ge=function LocalTreeItem(e){var t=Object(Ae.useAsyncCallback)(e.onClick);return s.a.createElement(StyledTreeItem,{onClick:function onClick(){return t.execute(e.node)},nodeId:e.node.path,labelText:e.node.name,labelIcon:e.level<2?Le.a:_.a,classes:e.classes},e.node.children&&e.node.children.map((function(n){return s.a.createElement(LocalTreeItem,{onClick:t.execute,level:e.level+1,node:n,classes:e.classes})})))};function StyledTreeItem(e){var t=e.classes,n=e.labelText,a=e.labelIcon,o=e.labelInfo,i=e.color,r=e.bgColor,l=Object(Me.a)(e,["labelText","labelIcon","labelInfo","color","bgColor"]);return s.a.createElement(Ne.a,Object.assign({label:s.a.createElement("div",{className:t.labelRoot},s.a.createElement(a,{color:"inherit",className:t.labelIcon}),s.a.createElement(V.a,{variant:"body2",className:t.labelText},n),s.a.createElement(V.a,{variant:"caption",color:"inherit"},o)),style:{"--tree-view-color":i,"--tree-view-bg-color":r},classes:{root:t.root,content:t.content,expanded:t.expanded,group:t.group,label:t.label}},l))}var Be=function(e){function FolderTree(e,t){var n;return Object(v.a)(this,FolderTree),(n=Object(k.a)(this,Object(w.a)(FolderTree).call(this,e,t))).state={},n.handleTreeItemClick=n.handleTreeItemClick.bind(Object(T.a)(n)),n}return Object(S.a)(FolderTree,e),Object(y.a)(FolderTree,[{key:"componentDidMount",value:function componentDidMount(){this.setState({isMounted:!0})}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(e){this.props=e}},{key:"handleTreeItemClick",value:function handleTreeItemClick(e){console.log(e),this.props.onTreeClick(e)}},{key:"render",value:function render(){var e=this,t=this.props.classes;return s.a.createElement("div",null,s.a.createElement(Ie.a,{className:t.root,defaultExpanded:[this.props.root],defaultCollapseIcon:s.a.createElement(Re.a,null),defaultExpandIcon:s.a.createElement(De.a,null),defaultEndIcon:s.a.createElement("div",{style:{width:24}})},this.props.folders.map((function(n){return s.a.createElement(Ge,{onClick:function _callee(t){return j.a.async((function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,j.a.awrap(e.handleTreeItemClick(t));case 2:case"end":return n.stop()}}))},level:0,node:n,classes:t})}))))}}]),FolderTree}(o.Component);FileList.propTypes={photos:me.a.object.isRequired};var Fe=Object(x.f)(Object(E.a)((function styleSheet(e){return{root:{width:"100%",height:"auto",maxWidth:400,flexGrow:1},stylizedRoot:{color:e.palette.text.secondary,"&:focus > $content":{backgroundColor:"var(--tree-view-bg-color, ".concat(e.palette.grey[400],")"),color:"var(--tree-view-color)"}},content:{width:"auto",color:e.palette.text.secondary,borderTopRightRadius:e.spacing(2),borderBottomRightRadius:e.spacing(2),paddingRight:e.spacing(1),fontWeight:e.typography.fontWeightMedium,"$expanded > &":{fontWeight:e.typography.fontWeightRegular}},group:{marginLeft:"8px","& $content":{paddingLeft:e.spacing(2)}},expanded:{},label:{fontWeight:"inherit",color:"inherit"},labelRoot:{display:"flex",alignItems:"center",padding:e.spacing(.5,0)},labelIcon:{marginRight:e.spacing(1)},labelText:{fontWeight:"inherit",flexGrow:1}}}))(Be)),He=function(e){function Breadcrumb(e,t){var n;return Object(v.a)(this,Breadcrumb),(n=Object(k.a)(this,Object(w.a)(Breadcrumb).call(this,e))).state={paths:[]},n}return Object(S.a)(Breadcrumb,e),Object(y.a)(Breadcrumb,[{key:"componentDidMount",value:function componentDidMount(){this.parsePath(this.props.path)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.currentPathSubscription&&this.currentPathSubscription.dispose()}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(e){e.path&&this.parsePath(e.path)}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.path!==this.props.path}},{key:"parsePath",value:function parsePath(e){for(var t=e.split("/"),n="",a=[],o=[],s=0;s<t.length;s++){var i=t[s];i.trim().length>0&&(n=n+"/"+i,o[s]=i,a.push({label:i,level:s,path:n,style:{color:s>2?"blue":"black",cursor:s>2?"pointer":"default"}}))}this.setState({paths:a})}},{key:"render",value:function render(){var e=this.props.classes;return s.a.createElement("div",null,s.a.createElement("ol",{className:e.breadcrumb},this.state.paths.map((function(t){return t.path?s.a.createElement("li",{className:e.li,key:t.path,style:t.style,onClick:function onClick(){return R.navigateTo.next(t.path)}},t.label):s.a.createElement("li",{className:e.li,key:t.label},t.label)}))))}}]),Breadcrumb}(o.Component),Ve=Object(E.a)((function styleSheet(e){return{breadcrumb:{backgroundColor:"transparent",listStyle:"none",padding:"0px"},li:{float:"left",margin:"0 0 10px 5px",color:"blue",cursor:"pointer","&:before":{content:'"/ "',color:"black"},"&:after":{content:'" "',color:"black"}}}}))(He),$e=n(225),_e=n.n($e),ze=function(e){function HomePage(e,t){var n;return Object(v.a)(this,HomePage),(n=Object(k.a)(this,Object(w.a)(HomePage).call(this,e))).state={isMounted:!0,isLoading:!0,root:"/content/files",path:"/content/files",photos:[],folders:[],selectedImages:[]},n.handleTreeClick=n.handleTreeClick.bind(Object(T.a)(n)),n.handleSelectedImages=n.handleSelectedImages.bind(Object(T.a)(n)),n}return Object(S.a)(HomePage,e),Object(y.a)(HomePage,[{key:"componentWillMount",value:function componentWillMount(){var e=this;this.setState({isLoading:!0,isMounted:!0}),de.listFolders.sink.subscribe((function(t){e.setState({folders:t})})),de.listPhotos.source.subscribe((function(t){e.setState({photos:[]})})),de.listPhotos.sink.subscribe((function(t){var n={},a=t,o=!0,s=!1,i=void 0;try{for(var r,l=a[Symbol.iterator]();!(o=(r=l.next()).done);o=!0){var c=r.value;if(c["dam:date.created"])try{var u=c["dam:date.created"];if(!n[u=(u=new Date(Date.parse(u))).getYear()+1900+"-"+u.getMonth()+"-"+u.getDate()]){var p={};p.label=u,p.children=[],n[u]=p}n[u].children.push(c)}catch(m){}}}catch(m){s=!0,i=m}finally{try{o||null==l.return||l.return()}finally{if(s)throw i}}var d=[];for(var h in n)d.push(n[h]);d.sort((function(e,t){return e.label-t.label})),e.setState({isLoading:!1,photos:d})})),de.listFolders.source.next({path:this.state.root}),this.validatePath()}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(e){this.props=e,this.validatePath()}},{key:"validatePath",value:function validatePath(){var e=this.state.path;this.props.location.pathname&&this.props.location.pathname.startsWith(this.state.root)?(e=this.props.location.pathname,de.listPhotos.source.next({path:e})):de.listPhotos.source.next({path:this.state.root}),this.setState({path:e})}},{key:"handleTreeClick",value:function handleTreeClick(e){this.setState({path:e.path}),R.navigateTo.next(e.path)}},{key:"handleSelectedImages",value:function handleSelectedImages(e){if(e.isSelected){(t=this.state.selectedImages).push(e),this.setState({selectedImage:t})}else{var t=[],n=!0,a=!1,o=void 0;try{for(var s,i=this.state.selectedImages[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var r=s.value;r!==e&&t.push(r)}}catch(l){a=!0,o=l}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}this.setState({selectedImages:t})}}},{key:"render",value:function render(){var e=this,t=this.props.classes;return this.state.isLoading?s.a.createElement(ce,{user:this.props.user||{},open:!1},s.a.createElement(M.a,{className:t.progress,size:50})):s.a.createElement(ce,{user:this.props.user||{},open:!1},s.a.createElement(_e.a,{color:"default",position:"static",elevation:0,className:t.fileGridAppBar,style:{colorDefault:"#eeeeee"}},s.a.createElement(Q.a,{className:t.toolbarContainer},s.a.createElement(X.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu"},s.a.createElement(_.a,null)),s.a.createElement(V.a,{variant:"h6",className:t.title},s.a.createElement(Ve,{root:this.state.root,path:this.state.path})),s.a.createElement("div",null,s.a.createElement(W.a,{color:"inherit"},"Download"),s.a.createElement(W.a,{color:"inherit"},"Delete")))),s.a.createElement("div",{className:t.photoGrid},s.a.createElement("div",{className:t.photoSideBar},s.a.createElement(Fe,{root:this.state.root,folders:this.state.folders,onTreeClick:function _callee(t){return j.a.async((function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,j.a.awrap(e.handleTreeClick(t));case 2:case"end":return n.stop()}}))}})),s.a.createElement("div",{className:t.photoGroups},this.state.photos.map((function(t){return s.a.createElement(Te,{onImageSelect:e.handleSelectedImages,key:t.value,photos:t})})))))}}]),HomePage}(o.Component),Je=Object(l.c)(Object(x.f)(Object(E.a)((function styleSheet(e){return{progress:{margin:"0 ".concat(2*e.spacing.unit,"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},photoGrid:{display:"grid",gridTemplateColumns:"minmax(200px, 1fr) 4fr",gridTemplateRows:"auto"},photoSideBar:{backgroundColor:"#ffffff",gridColumn:"1/2",gridRows:"1/2",borderLeft:"1px solid #CCCCCC",margin:"16px"},photoGroups:{gridColumn:"2/3",gridRows:"1/2"},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}))(ze))),Ye=function(){function GetUsersService(e,t){Object(v.a)(this,GetUsersService),this.sink=void 0,this.sink=t,e.subscribe(this.getUser.bind(this))}return Object(y.a)(GetUsersService,[{key:"getUser",value:function getUser(e){var t=this,n=L.baseHost.getValue();fetch(n+"/api/v1/auth/user/me",{method:"GET"}).then((function(e){return e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e})).then((function(e){return e.json()})).then((function(e){e.firstName||(e.firstName=e.username),t.sink.next(e)})).catch((function(e){if(401===e.status||403===e.status)window.location="/";else{var n={code:e.status,status:e.statusText,message:e.responseText||e.message};t.sink.error(n)}}))}}]),GetUsersService}(),qe=function(){function GetAllUsersService(e,t,n){Object(v.a)(this,GetAllUsersService),this.sink=void 0,this.sink=t,e.subscribe(this.getUsers.bind(this))}return Object(y.a)(GetAllUsersService,[{key:"getUsers",value:function getUsers(){var e,t,n,a;return j.a.async((function getUsers$(o){for(;;)switch(o.prev=o.next){case 0:return e=L.baseHost.getValue(),t=e+"/api/v1/auth/users",(n=new Headers).append("pragma","no-cache"),n.append("cache-control","no-cache"),o.next=7,j.a.awrap(fetch(t,{method:"GET",cache:"no-cache",headers:n}).then((function _callee(e){return j.a.async((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.json());case 1:case"end":return t.stop()}}))})).then((function(e){for(var t=[],n=0;n<e.length;n++){var a=e[n];void 0===a.firstName&&(a.firstName=a.username),t.push(a)}return t.sort((function(e,t){return e.username>t.username?1:e.username<t.username?-1:0}))})).catch((function(e){if(401===e.status||403===e.status)window.location="/";else{var t={code:e.status,status:e.statusText,message:e.responseText||e.message};console.warn(t),setTimeout((function(){Ke.getAllUsers.source.next(!0)}),500)}})));case 7:(a=o.sent)&&this.sink.next(a);case 9:case"end":return o.stop()}}),null,this)}}]),GetAllUsersService}(),Ke=new function UserActions(){Object(v.a)(this,UserActions),this.getUser={source:new A.Subject,sink:new A.Subject},this.getAllUsers={source:new A.Subject,sink:new A.Subject},this.getUserService=new Ye(this.getUser.source,this.getUser.sink),this.getAllUsersService=new qe(this.getAllUsers.source,this.getAllUsers.sink)},Qe=function(e){function App(e,t){var n;return Object(v.a)(this,App),(n=Object(k.a)(this,Object(w.a)(App).call(this,e,t))).state={context:t,locale:"en-EN",isAuthenticated:!1,isLoading:!1,isMounted:!0},n}return Object(S.a)(App,e),Object(y.a)(App,[{key:"componentWillMount",value:function componentWillMount(){var e=this;this.setState({isMounted:!0}),Ke.getUser.sink.takeWhile((function(){return e.state.isMounted})).subscribe((function(t){t?e.setState({user:t}):window.location="/index.html"})),Ke.getUser.source.next(null)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"render",value:function render(){var e=this;return s.a.createElement(l.a,{locale:"en-EN",key:"en-EN",messages:this.props.i18nMessages["en-EN"]},s.a.createElement(C.a,null,s.a.createElement(x.c,null,s.a.createElement(x.a,{path:"/",component:function component(){return s.a.createElement(Je,{user:e.state.user})}}))))}}]),App}(o.Component),Xe=Object(E.a)((function styleSheet(e){return{progress:{margin:"0 ".concat(e.spacing(2),"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}}))(Qe);Object(l.b)(n(571));var Ze={"en-EN":n(572)},et=Object(u.a)({palette:{type:"light",primary:h.a,secondary:Object(a.a)({},g.a),error:b.a}});!function renderApp(){r.a.render(s.a.createElement(p.a,{theme:et},s.a.createElement(Xe,{i18nMessages:Ze})),document.getElementById("root"))}(),function register(){if("serviceWorker"in navigator){if(new URL("/photos",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/photos","/service-worker.js");c?function checkValidServiceWorker(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):registerValidSW(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e):registerValidSW(e)}))}}()}},[[238,1,2]]]);
//# sourceMappingURL=main.af9a0737.chunk.js.map