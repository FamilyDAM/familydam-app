(this.webpackJsonpusermanager=this.webpackJsonpusermanager||[]).push([[0],{335:function(e,t,n){},708:function(e){e.exports=JSON.parse("{}")},709:function(e,t,n){"use strict";n.r(t);var a=n(131),s=n(0),r=n.n(s),o=n(17),i=n.n(o),l=(n(334),n(311)),c=n(749),u=n(308),p=n.n(u),d=n(309),m=n.n(d),h=n(310),f=n.n(h),g=(n(335),n(36)),b=n(43),w=n(86),v=n(85),y=n(181),C=n(53),E=n(754),k=n(37),x=n(748),S=n(286),O=n(253),j=n(101),U=n(762),A=n(763),N=n(122),M=n(260),L=n(314),T=n(759),F=n(760),P=n(761),D=n(712),I=n(743),_=n(281),R=n.n(_),H=n(39),W=new function AppActions(){Object(g.a)(this,AppActions),this.navigateTo=new H.Subject,this.logout={source:new H.Subject,sink:new H.Subject}},B=function(e){Object(w.a)(Sidebar,e);var t=Object(v.a)(Sidebar);function Sidebar(){return Object(g.a)(this,Sidebar),t.apply(this,arguments)}return Object(b.a)(Sidebar,[{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.open!==this.props.open||e.user!==this.props.user||e.apps!==this.props.apps||e.secondaryApps!==this.props.secondaryApps}},{key:"handleLogout",value:function handleLogout(){window.localStorage.clear(),W.logout.source.next(!0),window.location="/index.html"}},{key:"findApp",value:function findApp(e,t){if(t){var n,a=Object(L.a)(t);try{for(a.s();!(n=a.n()).done;){var s=n.value;if(s.slug===e)return s}}catch(r){a.e(r)}finally{a.f()}}return null}},{key:"render",value:function render(){var e=this,t=this.props.classes,n=this.findApp("usermanager",this.props.secondaryApps);return r.a.createElement(D.a,{className:this.props.open?t.sidebarOpen:t.sidebarClosed},r.a.createElement(D.a,{className:this.props.open?t.sidebarUserInfo:t.sidebarUserInfoClosed},r.a.createElement("div",{className:t.sidebarProfileIcon},r.a.createElement(R.a,{style:{width:60,height:60}})),r.a.createElement("div",{className:t.sidebarProfileName},r.a.createElement(I.a,{component:"div",type:"title"},this.props.user.firstName," ",this.props.user.lastName)),r.a.createElement("div",{className:t.sidebarButtons},r.a.createElement(j.a,{type:"link",onClick:this.handleLogout},"Logout"),n&&r.a.createElement(j.a,{type:"link",onClick:function onClick(){return window.location.href=n.path+"#/u/"+e.props.user.name+"/account"}},"Profile"))),r.a.createElement("div",{className:this.props.open?t.appListsOpen:t.appListsClosed},r.a.createElement("div",{style:{gridColumn:"1",gridRow:"1"}},r.a.createElement("br",null)),r.a.createElement(O.a,{style:{gridColumn:"1",gridRow:"2"}},this.props.apps&&this.props.apps.map((function(n){return r.a.createElement(O.a.Item,{key:n.path,onClick:function onClick(){return window.location.href=n.path}},"home"===n.slug&&r.a.createElement(j.a,{size:"large",shape:"circle",icon:r.a.createElement(T.a,{style:{marginRight:"0px"}})}),"files"===n.slug&&r.a.createElement(j.a,{size:"large",shape:"circle",icon:r.a.createElement(F.a,{style:{marginRight:"0px"}})}),"photos"===n.slug&&r.a.createElement(j.a,{size:"large",shape:"circle",icon:r.a.createElement(P.a,{style:{marginRight:"0px"}})}),r.a.createElement("span",{className:e.props.open?t.openLabel:t.closedLabel},n.label))}))),r.a.createElement(O.a,{style:{gridColumn:"1",gridRow:"3"},className:this.props.open?t.closedLabel:t.openLabel},"`    ",r.a.createElement(j.a,{size:"large",shape:"circle",icon:r.a.createElement(U.a,{style:{marginLeft:"0px",marginRight:"0px"}}),onClick:function onClick(){return window.location.href="/usermanager/index.html"}}),"`")))}}]),Sidebar}(s.Component),G=Object(S.b)(Object(k.a)((function styleSheet(e){return{sidebarOpen:{width:"240px",minHeight:"100vh",height:"100%",background:"#fff"},sidebarClosed:{width:"72px",minHeight:"100vh",height:"100%",background:"#fff"},sidebarUserInfo:{width:"100%",padding:"8px",display:"grid",gridGap:"8px",gridTemplateRows:"auto",gridTemplateColumns:"60px auto"},sidebarUserInfoClosed:{display:"none"},sidebarProfileIcon:{gridColumn:"1",gridRow:"1"},sidebarProfileName:{gridColumn:"2",gridRow:"1",alignSelf:"center"},sidebarButtons:{gridColumn:"1/3",gridRow:"2",justifySelf:"center"},appListsOpen:{display:"grid",gridGap:"0px",gridTemplateRows:"24px auto",gridTemplateColumns:"auto",marginTop:"16px"},appListsClosed:{height:"90%",display:"grid",gridGap:"0px",gridTemplateRows:"0px auto 72px",gridTemplateColumns:"auto"},openLabel:{display:"inline",marginLeft:"10px",fontSize:"16px"},closedLabel:{display:"none"}}}))(B)),q=n(744),z=n(751),V=n(764),$=n(745),J=n(746),K=n(747),Y=n(289),Q=n.n(Y),X=n(288),Z=n.n(X),ee=function(e){Object(w.a)(AppHeader,e);var t=Object(v.a)(AppHeader);function AppHeader(e,n){var a;return Object(g.a)(this,AppHeader),(a=t.call(this,e)).handleButtonClick=function(e){},a.handleMenuClick=function(e){},a.state={openMoreMenu:!1},a.handleToggle=a.handleToggle.bind(Object(N.a)(a)),a.handleOpenMoreMenu=a.handleOpenMoreMenu.bind(Object(N.a)(a)),a.handleLogout=a.handleLogout.bind(Object(N.a)(a)),a}return Object(b.a)(AppHeader,[{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.onToggle!==this.props.onToggle||e.apps!==this.props.apps||t.openMoreMenu!==this.state.openMoreMenu}},{key:"handleOpenMoreMenu",value:function handleOpenMoreMenu(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}},{key:"handleToggle",value:function handleToggle(){this.props.onToggle&&this.props.onToggle()}},{key:"handleNavClick",value:function handleNavClick(e){this.props.onNavClick&&this.props.onNavClick(e)}},{key:"handleMenuClose",value:function handleMenuClose(){this.setState({openMoreMenu:!1})}},{key:"handleLogout",value:function handleLogout(){window.localStorage.clear(),W.logout.source.next(!0),window.location="/"}},{key:"render",value:function render(){var e=this,t=this.props.classes;return r.a.createElement(q.a,{className:t.root,position:"static"},r.a.createElement($.a,null,r.a.createElement(J.a,{onClick:this.handleToggle,className:t.menuButton,color:"secondary","aria-label":"Menu"},r.a.createElement(Z.a,null)),r.a.createElement(I.a,{variant:"h6",color:"inherit",className:t.flex,style:{fontWeight:"300"},onClick:function onClick(){return window.location="/home/index.html"}},"Family Data Manager"),r.a.createElement(J.a,{"aria-label":"More","aria-owns":this.state.open?"long-menu":null,"aria-haspopup":"true",onClick:this.handleOpenMoreMenu,className:t.moreButton},r.a.createElement(Q.a,null)),r.a.createElement(z.a,{id:"long-menu",keepMounted:!0,anchorEl:this.state.openMoreMenuAnchorEl,open:this.state.openMoreMenu},r.a.createElement(V.a,{onClick:function onClick(){e.handleLogout(),e.handleMenuClose()}},"Logout"),r.a.createElement(K.a,null),this.props.apps&&this.props.apps.map((function(t){return r.a.createElement(V.a,{key:t.path,color:"secondary",onClick:function onClick(){window.location=t.path,e.handleMenuClose()}},t.label)})))))}}]),AppHeader}(s.Component),te=Object(S.b)(Object(k.a)((function styleSheet(e){return{root:{width:"100%",height:"64px"},headerContainer:{display:"grid",gridTemplateRows:"auto",gridTemplateColumns:"48px auto 48px"},hamburgerMenu:{display:"block",gridRow:"1",gridColumn:"1"},mainSection:{gridRow:"1",gridColumn:"2"},rightSection:{gridRow:"2",gridColumn:"3",textAlign:"right"},flex:{flex:1},menuButton:{marginLeft:-12,marginRight:20,color:"#ffffff"},moreButton:{color:"#ffffff"}}}))(ee)),ne=n(72),ae=n.n(ne),se=n(100),re=new function AppSettings(){Object(g.a)(this,AppSettings),this.baseHost=new H.BehaviorSubject(null)},oe=new(function(){function LoadClientAppsService(){Object(g.a)(this,LoadClientAppsService),this.isLoading=new H.BehaviorSubject(!1),this.source=new H.Subject,this.sink=new H.Subject,this.source.subscribe(this.loadApps.bind(this))}return Object(b.a)(LoadClientAppsService,[{key:"loadApps",value:function(){var e=Object(se.a)(ae.a.mark((function _callee(e){var t,n,a,s,r,o,i,l,c;return ae.a.wrap((function _callee$(e){for(;;)switch(e.prev=e.next){case 0:return t=re.baseHost.getValue()||"",n=t+"/api/v1/apps/",(a=new Headers).append("Accept","application/hal+json"),this.isLoading.next(!0),e.next=7,fetch(n,{method:"GET",cache:"no-cache",headers:a,credentials:"include"});case 7:return s=e.sent,e.next=10,s.json();case 10:r=e.sent,200==s.status&&r._embedded&&r._embedded.apps&&(o=[],i=[],r._embedded.apps.forEach((function(e){e.primary?o.push(e):i.push(e)})),l=o.sort((function(e,t){return e.order-t.order})),c=i.sort((function(e,t){return e.order-t.order})),this.sink.next({primaryApps:l,secondaryApps:c}));case 12:case"end":return e.stop()}}),_callee,this)})));return function loadApps(t){return e.apply(this,arguments)}}()}]),LoadClientAppsService}()),ie=function(e){Object(w.a)(AppShell,e);var t=Object(v.a)(AppShell);function AppShell(e,n){var a;Object(g.a)(this,AppShell),a=t.call(this,e);var s=window.localStorage.getItem("AppShell.isOpen");return s||(s=void 0===e.open||e.open),a.state={isMounted:!0,isOpen:Boolean(s)},a.handleOpenCloseToggle=a.handleOpenCloseToggle.bind(Object(N.a)(a)),a.handleOpenMoreMenu=a.handleOpenMoreMenu.bind(Object(N.a)(a)),a}return Object(b.a)(AppShell,[{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.open!==this.props.open||e.user!==this.props.user||e.children!==this.props.children||t.isOpen!==this.state.isOpen||t.primaryApps!==this.state.primaryApps||t.secondaryApps!==this.state.secondaryApps}},{key:"componentDidMount",value:function componentDidMount(){var e=this;this.setState({isMounted:!0}),W.navigateTo.pipe(Object(M.a)((function(){return e.state.isMounted}))).subscribe(function(e){"://"!==e&&"://"===e.substring(0,3)?window.location.href=e.substring(2):this.props.history&&this.props.history.push(e)}.bind(this)),oe.sink.pipe(Object(M.a)((function(){return e.state.isMounted}))).subscribe((function(t){t&&e.setState({primaryApps:t.primaryApps||[],secondaryApps:t.secondaryApps||[]})})),oe.source.next(!0)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"handleOpenMoreMenu",value:function handleOpenMoreMenu(e){this.setState({openMoreMenu:!0,openMoreMenuAnchorEl:e.currentTarget})}},{key:"handleOpenCloseToggle",value:function handleOpenCloseToggle(){var e=!this.state.isOpen;this.setState({isOpen:e}),window.localStorage.setItem("AppShell.isOpen",e)}},{key:"handleLogout",value:function handleLogout(){window.localStorage.clear(),W.logout.source.next(!0),W.navigateTo.next("://")}},{key:"render",value:function render(){var e=this.props.classes;return this.props.user?r.a.createElement("div",{className:this.state.isOpen?e.dashboardShellContainerOpen:e.dashboardShellContainerClosed},r.a.createElement("header",{className:e.header},r.a.createElement(te,{apps:this.state.secondaryApps,onToggle:this.handleOpenCloseToggle,onNavClick:function onNavClick(e){return window.location=e}})),r.a.createElement(G,{user:this.props.user,apps:this.state.primaryApps,secondaryApps:this.state.secondaryApps,open:this.state.isOpen,onNavClick:function onNavClick(e){return window.location=e}}),r.a.createElement("div",{className:e.main},this.props.children)):r.a.createElement("div",null)}}]),AppShell}(s.Component),le=Object(S.b)(Object(C.f)(Object(k.a)((function styleSheet(e){return{dashboardShellContainerOpen:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"240px auto"},dashboardShellContainerClosed:{display:"grid",gridTemplateRows:"64px auto",gridTemplateColumns:"72px auto"},header:{gridColumn:"1/3",gridRow:"1",position:"inherit",height:"64px"},main:{fontSize:".5rem",background:"#eee"}}}))(ie))),ce=new(function(){function GetAllUsersService(){Object(g.a)(this,GetAllUsersService),this.isLoading=new H.BehaviorSubject(!0),this.source=new H.Subject,this.sink=new H.Subject,this.source.subscribe(this.getUsers.bind(this))}return Object(b.a)(GetAllUsersService,[{key:"getUsers",value:function(){var e=Object(se.a)(ae.a.mark((function _callee2(){var e,t,n,a,s=this;return ae.a.wrap((function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:return e=re.baseHost.getValue()||"",t=e+"/api/v1/auth/users",(n=new Headers).append("pragma","no-cache"),n.append("cache-control","no-cache"),this.isLoading.next(!0),r.next=8,fetch(t,{method:"GET",cache:"no-cache",headers:n,credentials:"include"}).then(function(){var e=Object(se.a)(ae.a.mark((function _callee(e){return ae.a.wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.json());case 1:case"end":return t.stop()}}),_callee)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){var t=[];if(e&&e._embedded)for(var n=0;n<e._embedded.users.length;n++){var a=e._embedded.users[n];t.push(a)}return t.sort((function(e,t){return e.name>t.name?1:e.name<t.name?-1:0}))})).then((function(e){return s.isLoading.next(!1),e})).catch((function(e){if(401===e.status||403===e.status)window.location="/";else{var t={code:e.status,status:e.statusText,message:e.responseText||e.message};console.warn(t),setTimeout((function(){s.source.next(!0)}),500)}}));case 8:(a=r.sent)&&this.sink.next(a);case 10:case"end":return r.stop()}}),_callee2,this)})));return function getUsers(){return e.apply(this,arguments)}}()}]),GetAllUsersService}()),ue=n(753),pe=n(318),de=n(752),me=n(750),he=n(756),fe=n(757),ge=(ue.a.Text,function(e){Object(w.a)(NewUserForm,e);var t=Object(v.a)(NewUserForm);function NewUserForm(){return Object(g.a)(this,NewUserForm),t.apply(this,arguments)}return Object(b.a)(NewUserForm,[{key:"handleOnFinish",value:function handleOnFinish(e){e.password===e.passwordConfirm?this.props.onSave?this.props.onSave(e):console.error("Missing onSave Property"):pe.b.info("Passwords don't match")}},{key:"onAdminChange",value:function onAdminChange(e,t,n){console.log(e)}},{key:"render",value:function render(){var e=this.props.classes,t={labelCol:{span:4},wrapperCol:{span:12}};return r.a.createElement(D.a,{className:e.outerContainer},r.a.createElement(de.a,{className:"site-page-header",title:"Add New User"},r.a.createElement(me.a,Object.assign({},t,{name:"user-form",autoComplete:"off",onFinish:this.handleOnFinish.bind(this)}),r.a.createElement(me.a.Item,{name:"firstName",label:"First Name",rules:[{required:!0,message:"First Name is required"}]},r.a.createElement(he.a,{name:"firstName",autoComplete:"off"})),r.a.createElement(me.a.Item,{name:"lastName",label:"Last Name",rules:[{required:!0,message:"First Name is required"}]},r.a.createElement(he.a,{name:"lastName",autoComplete:"off"})),r.a.createElement(me.a.Item,{name:"isFamilyAdmin",label:"Is Parent",valuePropName:"checked"},r.a.createElement(fe.a,{name:"isFamilyAdmin",checked:!0},"(Parents have full access to all data)")),r.a.createElement(me.a.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Password is required"}]},r.a.createElement(he.a.Password,{name:"password",type:"password",autoComplete:"off"})),r.a.createElement(me.a.Item,{name:"passwordConfirm",label:"Confirm Password",rules:[{required:!0,message:"Password Confirm is required"}]},r.a.createElement(he.a.Password,{name:"passwordConfirm",type:"password",autoComplete:"off"})),r.a.createElement(me.a.Item,{wrapperCol:Object(a.a)(Object(a.a)({},t.wrapperCol),{},{offset:8})},r.a.createElement(j.a,{type:"primary",htmlType:"submit"},"Submit")))))}}]),NewUserForm}(s.Component)),be=Object(k.a)((function styleSheet(e){return{outerContainer:{maxWidth:"100%",backgroundColor:"#ffffff",padding:"16px"}}}))(ge),we=n(259),ve=n(758),ye=n(755),Ce=new(function(){function DeleteUserService(e,t){Object(g.a)(this,DeleteUserService),this.sink=new H.Subject,this.source=new H.Subject,this.isLoading=new H.BehaviorSubject,this.source.subscribe(function(e){this.execute(e)}.bind(this))}return Object(b.a)(DeleteUserService,[{key:"execute",value:function(){var e=Object(se.a)(ae.a.mark((function _callee(e){var t,n,a;return ae.a.wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:return t=re.baseHost.getValue()||"",e.name,n=t+"/api/v1/auth/user/"+e.name,s.prev=3,s.next=6,fetch(n,{method:"DELETE",credentials:"include"});case 6:200==(a=s.sent).status?(this.sink.next(!0),this.isLoading.next(!1)):this.sink.error("(".concat(a.status,") Error deleting user")),s.next=14;break;case 10:s.prev=10,s.t0=s.catch(3),this.sink.error("Unknown error deleting user"),this.isLoading.next(!1);case 14:case"end":return s.stop()}}),_callee,this,[[3,10]])})));return function execute(t){return e.apply(this,arguments)}}()}]),DeleteUserService}()),Ee=n(54),ke=function(e){Object(w.a)(UserAccountForm,e);var t=Object(v.a)(UserAccountForm);function UserAccountForm(e,n){var a;return Object(g.a)(this,UserAccountForm),(a=t.call(this,e,n)).state={user:a.props.user,selectedUser:a.props.selectedUser,showDeleteUserDialog:!1},a.handleOnFinish=function(e){var t=!0;e.newPassword&&e.newPasswordConfirm&&e.newPassword.length>0&&e.newPassword===e.newPasswordConfirm?(e.password=e.newPassword,e.passwordConfirm=e.passwordConfirm):e.newPassword!==e.newPasswordConfirm&&(t=!1,pe.b.warn("Passwords don't match")),t&&a.props.onSave&&a.props.onSave(e)},a.handleDeleteUserConfirmation=function(){Ce.source.next(a.state.selectedUser)},a.deleteConfim=function(e){return alert("TODO: are you sure"),!1},Ce.sink.pipe(Object(M.a)((function(){return a.state.isMounted})),Object(we.a)((function(e){return pe.b.error("Error Deleting User | ".concat(e)),Ee.a}))).subscribe((function(e){window.location.href="/usermanager/",a.setState({showDeleteUserDialog:!1})})),a}return Object(b.a)(UserAccountForm,[{key:"componentDidMount",value:function componentDidMount(){this.setState({isMounted:!0})}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"render",value:function render(){var e=this,t=this.props.classes,n={labelCol:{span:4},wrapperCol:{span:12}},s="";return this.state.selectedUser&&this.state.selectedUser.firstName&&(s=this.state.selectedUser.firstName),this.state.selectedUser&&this.state.selectedUser.lastName&&(s+=" ",s+=this.state.selectedUser.lastName),r.a.createElement(D.a,{className:t.outerContainer},r.a.createElement(de.a,{className:"site-page-header",title:s},r.a.createElement(me.a,Object.assign({},n,{name:"user-edit-form",autoComplete:"off",initialValues:this.state.selectedUser,onFinish:this.handleOnFinish}),r.a.createElement(me.a.Item,{name:"name",hidden:!0},r.a.createElement(he.a,{name:"name"})),r.a.createElement(me.a.Item,{name:"firstName",label:"First Name",rules:[{required:!0,message:"First Name is required"}]},r.a.createElement(he.a,{name:"firstName",autoComplete:"off"})),r.a.createElement(me.a.Item,{name:"lastName",label:"Last Name",rules:[{required:!0,message:"First Name is required"}]},r.a.createElement(he.a,{name:"lastName",autoComplete:"off"})),this.state.user&&this.props.user.isFamilyAdmin&&r.a.createElement(me.a.Item,{name:"isFamilyAdmin",label:"Is Parent",valuePropName:"checked"},r.a.createElement(fe.a,{name:"isFamilyAdmin",disabled:this.state.selectedUser&&this.state.selectedUser.isSystemAdmin||!1,checked:this.state.selectedUser&&this.state.selectedUser.isFamilyAdmin||!1},"(Parents have full access to all data)")),r.a.createElement("fieldset",null,r.a.createElement("legend",null,"Change Password"),r.a.createElement(me.a.Item,{name:"newPassword",label:"New Password"},r.a.createElement(he.a.Password,{name:"password",type:"password",autoComplete:"off"})),r.a.createElement(me.a.Item,{name:"newPasswordConfirm",label:"Confirm New Password"},r.a.createElement(he.a.Password,{name:"passwordConfirm",type:"password",autoComplete:"off"}))),r.a.createElement(me.a.Item,{wrapperCol:Object(a.a)(Object(a.a)({},n.wrapperCol),{},{offset:8})},r.a.createElement(ve.b,null,this.state.user&&this.state.user.isFamilyAdmin&&r.a.createElement(j.a,{type:"secondary",htmlType:"button",onClick:function onClick(){return e.setState({showDeleteUserDialog:!0})}},"Delete"),this.state.selectedUser&&this.state.user&&(this.props.user.isFamilyAdmin||this.state.selectedUser.name===this.props.user.name)&&r.a.createElement(j.a,{type:"primary",htmlType:"submit"},"Submit"))))),r.a.createElement(ye.a,{okText:"Yes",cancelText:"No",title:"Are you sure?",visible:this.state.showDeleteUserDialog,onCancel:function onCancel(){e.setState({showDeleteUserDialog:!1})},onOk:this.handleDeleteUserConfirmation},r.a.createElement("p",null,"Do you want to delete this user?"),r.a.createElement("p",null,"This will delete all files, properties, and settings")))}}]),UserAccountForm}(s.Component),xe=Object(k.a)((function styleSheet(e){return{outerContainer:{maxWidth:"100%",backgroundColor:"#ffffff",padding:"16px"}}}))(ke),Se=new(function(){function CreateUserService(e,t){Object(g.a)(this,CreateUserService),this.sink=new H.Subject,this.source=new H.Subject,this.isLoading=new H.BehaviorSubject,this.source.subscribe(function(e){this.execute(e)}.bind(this))}return Object(b.a)(CreateUserService,[{key:"execute",value:function(){var e=Object(se.a)(ae.a.mark((function _callee(e){var t,n,a,s,r,o;return ae.a.wrap((function _callee$(i){for(;;)switch(i.prev=i.next){case 0:return t=re.baseHost.getValue()||"",e.name,n=t+"/api/v1/auth/user",(a=new FormData).append(":name",e.firstName),a.append("firstName",e.firstName),a.append("lastName",e.lastName),a.append("isFamilyAdmin",e.isFamilyAdmin),a.append("password",e.password),a.append("jcr:primaryType","nt:folder"),i.prev=10,i.next=13,fetch(n,{method:"POST",body:a,credentials:"include"});case 13:if(200!=(s=i.sent).status){i.next=22;break}return i.next=17,s.json();case 17:r=i.sent,this.sink.next(r),this.isLoading.next(!1),i.next=23;break;case 22:throw new Error("Unexpected Code: '"+s.status+"'");case 23:i.next=31;break;case 25:i.prev=25,i.t0=i.catch(10),console.dir(i.t0),o={code:i.t0.status,status:i.t0.statusText,message:i.t0.responseText},this.sink.error(o),this.isLoading.next(!1);case 31:case"end":return i.stop()}}),_callee,this,[[10,25]])})));return function execute(t){return e.apply(this,arguments)}}()}]),CreateUserService}()),Oe=new(function(){function UpdateUserService(e,t){Object(g.a)(this,UpdateUserService),this.sink=new H.Subject,this.source=new H.Subject,this.isLoading=new H.BehaviorSubject,this.source.subscribe(function(e){this.execute(e)}.bind(this))}return Object(b.a)(UpdateUserService,[{key:"execute",value:function(){var e=Object(se.a)(ae.a.mark((function _callee(e){var t,n,a,s,r,o;return ae.a.wrap((function _callee$(i){for(;;)switch(i.prev=i.next){case 0:return t=re.baseHost.getValue()||"",e.name,n=t+"/api/v1/auth/user/"+e.name,(a=new FormData).append(":name",e.name),a.append("firstName",e.firstName),a.append("lastName",e.lastName),a.append("isFamilyAdmin",e.isFamilyAdmin),e.password&&a.append("password",e.password),e.passwordConfirm&&a.append("passwordConfirm",e.passwordConfirm),e.newPassword&&a.append("password",e.newPassword),e.newPasswordConfirm&&a.append("passwordConfirm",e.newPasswordConfirm),i.prev=12,i.next=15,fetch(n,{method:"POST",body:a,credentials:"include"});case 15:if(200!=(s=i.sent).status){i.next=24;break}return i.next=19,s.json();case 19:r=i.sent,this.sink.next(r),this.isLoading.next(!1),i.next=25;break;case 24:throw new Error("Unexpected Code: '"+s.status+"'");case 25:i.next=33;break;case 27:i.prev=27,i.t0=i.catch(12),console.dir(i.t0),o={code:i.t0.status,status:i.t0.statusText,message:i.t0.responseText},this.sink.error(o),this.isLoading.next(!1);case 33:case"end":return i.stop()}}),_callee,this,[[12,27]])})));return function execute(t){return e.apply(this,arguments)}}()}]),UpdateUserService}()),je=O.a.SubMenu,Ue=function(e){Object(w.a)(UserList,e);var t=Object(v.a)(UserList);function UserList(e,n){var a;return Object(g.a)(this,UserList),(a=t.call(this,e)).state={isMounted:!0,isLoading:!1,anchorEl:null,users:[],selectedUser:{name:""}},ce.sink.takeWhile((function(){return a.state.isMounted})).subscribe({next:function next(e){e&&a.setState({isLoading:!1,users:e,selectedUser:e[0]})},error:function error(e){console.error(e)}}),Se.sink.takeWhile((function(){return a.state.isMounted})).subscribe({next:function next(e){ce.source.next(!0),window.location.href="/usermanager/"},error:function error(e){console.error(e)}}),a}return Object(b.a)(UserList,[{key:"componentDidMount",value:function componentDidMount(){this.setState({isMounted:!0,isLoading:!0}),ce.source.next(!0)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"handleCreateNewUser",value:function handleCreateNewUser(e){Se.source.next(e)}},{key:"handleSaveNewUser",value:function handleSaveNewUser(e){Oe.source.next(e)}},{key:"handleSubMenuSelect",value:function handleSubMenuSelect(e){this.props.history.push(e.key)}},{key:"handleMenuOpen",value:function handleMenuOpen(e){this.props.history.push(e[1]+"/account")}},{key:"render",value:function render(){var e=this,t=this.props.classes,n=this.props.location.pathname.trim().split("/"),a=n[2],s="/u/"+a,o=s+"/account";return 4==n.length&&(o="/u/"+n[2]+"/"+n[3]),this.state.isLoading?r.a.createElement(le,{user:this.props.user},r.a.createElement(x.a,{className:t.progress,size:50})):r.a.createElement(le,{user:this.props.user},r.a.createElement("div",{className:t.container},r.a.createElement("div",{className:t.userlist},r.a.createElement("div",{className:t.userlistpart,style:{minHeight:"100%"}},r.a.createElement(O.a,{mode:"inline",openKeys:[s],defaultSelectedKeys:[o],onOpenChange:this.handleMenuOpen.bind(this),onSelect:this.handleSubMenuSelect.bind(this),style:{width:"100%"}},this.state.users.map((function(t){if(e.props.user.isFamilyAdmin||t.name===e.props.user.name)return r.a.createElement(je,{key:"/u/"+t.name,icon:r.a.createElement(U.a,null),title:t.firstName},r.a.createElement(O.a.Item,{key:"/u/"+t.name+"/account"},"Account"))})))),this.props.user&&this.props.user.isFamilyAdmin&&r.a.createElement("div",{className:t.userlistlink},r.a.createElement(j.a,{type:"link",size:"large",icon:r.a.createElement(A.a,null),onClick:function onClick(){return e.props.history.push("/new")}},"Add Family Member"))),r.a.createElement("div",{className:t.userforms},r.a.createElement(y.a,null,r.a.createElement(C.c,null,r.a.createElement(C.a,{exact:!0,path:"/u/:user/account",component:function component(t){return r.a.createElement(xe,{user:e.props.user,selectedUser:e.state.users.filter((function(e){return e.name===a})).pop(),onSave:e.handleSaveNewUser})}}),r.a.createElement(C.a,{exact:!0,path:"/u/:user/permissions",component:function component(e){return r.a.createElement("div",null,"Permissions")}}),r.a.createElement(C.a,{exact:!0,path:"/u/:user/web",component:function component(e){return r.a.createElement("div",null,"Web")}}),r.a.createElement(C.a,{exact:!0,path:"/u/:user/friends",component:function component(e){return r.a.createElement("div",null,"Friends")}}),r.a.createElement(C.a,{exact:!0,path:"/u/:user",component:function component(e){return r.a.createElement(xe,null)}}),this.props.user&&this.props.user.isFamilyAdmin&&r.a.createElement(C.a,{path:"/new",exact:!0,component:function component(t){return r.a.createElement(be,{onSave:e.handleCreateNewUser})}}))))))}}]),UserList}(s.Component),Ae=Object(S.b)(Object(C.f)(Object(k.a)((function styleSheet(e){return{progress:{margin:"0 ".concat(e.spacing(2),"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},container:{margin:"48px",display:"grid",gridTemplateColumns:"250px 3fr",gridAutoRows:"1fr 64px",gridGap:"16px"},userlist:{backgroundColor:"#ffffff",minHeight:"300px",gridColumn:1},userforms:{gridColumn:2},userlistpart:{textAlign:"center"},userlistlink:{textAlign:"center"}}}))(Ue))),Ne=new(function(){function GetUsersService(){Object(g.a)(this,GetUsersService),this.isLoading=new H.BehaviorSubject(!1),this.source=new H.Subject,this.sink=new H.Subject,this.source.subscribe(this.getUser.bind(this))}return Object(b.a)(GetUsersService,[{key:"getUser",value:function getUser(e){var t=this,n=(re.baseHost.getValue()||"")+"/api/v1/auth/user/me",a=new Headers;a.append("pragma","no-cache"),a.append("cache-control","no-cache"),a.append("accept","application/json"),this.isLoading.next(!0),fetch(n,{method:"GET",mode:"cors",headers:a,credentials:"include"}).then((function(e){return e.redirected&&(console.log("redirect to: "+e.url),window.location=e.url),e})).then((function(e){return e.json()})).then((function(e){t.sink.next(e)})).catch((function(e){if(401===e.status||403===e.status)window.location="/";else{console.error(e.statusText);var n={code:e.status,status:e.statusText,message:e.responseText||e.message};t.sink.error(n)}}))}}]),GetUsersService}()),Me=function(e){Object(w.a)(App,e);var t=Object(v.a)(App);function App(e,n){var a;return Object(g.a)(this,App),(a=t.call(this,e,n)).state={context:n,locale:"en-EN",isAuthenticated:!1,isLoading:!0,isMounted:!0},window.location.href.indexOf(":3000")>-1&&re.baseHost.next("http://localhost:9000"),a}return Object(b.a)(App,[{key:"componentWillMount",value:function componentWillMount(){var e=this;this.setState({isMounted:!0}),Ne.sink.takeWhile((function(){return e.state.isMounted})).subscribe((function(t){t&&e.setState({isAuthenticated:!0,isLoading:!1,user:t})})),Ne.source.next(null)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.setState({isMounted:!1})}},{key:"render",value:function render(){var e=this,t=this.props.classes,n="en-EN";return this.state.isLoading?r.a.createElement("div",null,r.a.createElement(x.a,{className:t.progress,size:50})):r.a.createElement(E.a,{locale:n,key:n,messages:this.props.i18nMessages[n]},r.a.createElement(y.a,null,r.a.createElement(C.c,null,r.a.createElement(C.a,{path:"/",component:function component(){return r.a.createElement(Ae,{user:e.state.user})}}))))}}]),App}(s.Component),Le=Object(k.a)((function styleSheet(e){return{progress:{margin:"0 ".concat(e.spacing(2),"px"),width:"100px",height:"100px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}}))(Me),Te={"en-EN":n(708)},Fe=Object(l.a)({palette:{type:"light",primary:p.a,secondary:Object(a.a)({},m.a),error:f.a}});!function renderApp(){i.a.render(r.a.createElement(c.a,{theme:Fe},r.a.createElement(Le,{i18nMessages:Te})),document.getElementById("root"))}()}},[[709,1,2]]]);
//# sourceMappingURL=main.d7bb0016.chunk.js.map